<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Class 7 14 10 2020 | Notes for Ecological Modelling</title>
  <meta name="description" content="This is based on Yihui Xie’s a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Class 7 14 10 2020 | Notes for Ecological Modelling" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is based on Yihui Xie’s a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Class 7 14 10 2020 | Notes for Ecological Modelling" />
  
  <meta name="twitter:description" content="This is based on Yihui Xie’s a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Tiago A. Marques" />


<meta name="date" content="2020-11-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="aula6.html"/>
<link rel="next" href="aula8.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="mainintro.html"><a href="mainintro.html"><i class="fa fa-check"></i><b>2</b> Preamble</a></li>
<li class="chapter" data-level="3" data-path="aknowledgments.html"><a href="aknowledgments.html"><i class="fa fa-check"></i><b>3</b> Aknowledgments</a></li>
<li class="chapter" data-level="4" data-path="usingRintro.html"><a href="usingRintro.html"><i class="fa fa-check"></i><b>4</b> Using R</a></li>
<li class="chapter" data-level="5" data-path="prelim.html"><a href="prelim.html"><i class="fa fa-check"></i><b>5</b> Preliminaries</a></li>
<li class="chapter" data-level="6" data-path="about-regression.html"><a href="about-regression.html"><i class="fa fa-check"></i><b>6</b> About regression</a><ul>
<li class="chapter" data-level="6.1" data-path="about-regression.html"><a href="about-regression.html#what-is-a-regression"><i class="fa fa-check"></i><b>6.1</b> What is a regression?</a></li>
<li class="chapter" data-level="6.2" data-path="about-regression.html"><a href="about-regression.html#the-general-linear-model"><i class="fa fa-check"></i><b>6.2</b> The general linear model</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="handson.html"><a href="handson.html"><i class="fa fa-check"></i><b>7</b> Hands On Regression</a><ul>
<li class="chapter" data-level="7.1" data-path="handson.html"><a href="handson.html#the-assumptions-are-on-the-residuals-not-the-data"><i class="fa fa-check"></i><b>7.1</b> The assumptions are on the residuals, not the data</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="aula6.html"><a href="aula6.html"><i class="fa fa-check"></i><b>8</b> Class 6 13 10 2020</a><ul>
<li class="chapter" data-level="8.1" data-path="aula6.html"><a href="aula6.html#implementing-a-regression"><i class="fa fa-check"></i><b>8.1</b> Implementing a regression</a></li>
<li class="chapter" data-level="8.2" data-path="aula6.html"><a href="aula6.html#simulating-regression-data"><i class="fa fa-check"></i><b>8.2</b> Simulating regression data</a><ul>
<li class="chapter" data-level="8.2.1" data-path="aula6.html"><a href="aula6.html#what-is-the-effect-of-increasing-the-error-a-simulation-experiment"><i class="fa fa-check"></i><b>8.2.1</b> What is the effect of increasing the error: a simulation experiment</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="aula7.html"><a href="aula7.html"><i class="fa fa-check"></i><b>9</b> Class 7 14 10 2020</a><ul>
<li class="chapter" data-level="9.1" data-path="aula7.html"><a href="aula7.html#task-1"><i class="fa fa-check"></i><b>9.1</b> Task 1</a></li>
<li class="chapter" data-level="9.2" data-path="aula7.html"><a href="aula7.html#task-2"><i class="fa fa-check"></i><b>9.2</b> Task 2</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="aula8.html"><a href="aula8.html"><i class="fa fa-check"></i><b>10</b> Class 8 20 10 2020 - t-test and ANOVA are just linear models</a><ul>
<li class="chapter" data-level="10.1" data-path="aula8.html"><a href="aula8.html#the-t-test"><i class="fa fa-check"></i><b>10.1</b> The t-test</a></li>
<li class="chapter" data-level="10.2" data-path="aula8.html"><a href="aula8.html#anova"><i class="fa fa-check"></i><b>10.2</b> ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="aula9.html"><a href="aula9.html"><i class="fa fa-check"></i><b>11</b> Class 9: 21 10 2020 - ANCOVA is (also) just a linear model</a><ul>
<li class="chapter" data-level="11.1" data-path="aula9.html"><a href="aula9.html#common-slope-different-intercepts-per-treatment"><i class="fa fa-check"></i><b>11.1</b> Common slope, different intercepts per treatment</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="aula10.html"><a href="aula10.html"><i class="fa fa-check"></i><b>12</b> Class 10: 27 10 2020</a><ul>
<li class="chapter" data-level="12.1" data-path="aula10.html"><a href="aula10.html#same-story-another-spin"><i class="fa fa-check"></i><b>12.1</b> Same story, another spin</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="aula11.html"><a href="aula11.html"><i class="fa fa-check"></i><b>13</b> Class 11: 03 11 2020 ANCOVA with different slopes: interactions</a><ul>
<li class="chapter" data-level="13.1" data-path="aula11.html"><a href="aula11.html#about-interactions"><i class="fa fa-check"></i><b>13.1</b> About interactions</a></li>
<li class="chapter" data-level="13.2" data-path="aula11.html"><a href="aula11.html#task-1-implementing-the-ancova-with-different-slopes"><i class="fa fa-check"></i><b>13.2</b> Task 1 Implementing the ANCOVA with different slopes</a></li>
<li class="chapter" data-level="13.3" data-path="aula11.html"><a href="aula11.html#task-2-modeling-a-data-set"><i class="fa fa-check"></i><b>13.3</b> Task 2 Modeling a data set</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="aula13.html"><a href="aula13.html"><i class="fa fa-check"></i><b>14</b> Class 12: 04 11 2020 Interactions between continous covariates</a><ul>
<li class="chapter" data-level="14.1" data-path="aula13.html"><a href="aula13.html#larger-order-interactions"><i class="fa fa-check"></i><b>14.1</b> Larger order interactions</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="conlusion-on-linear-regression.html"><a href="conlusion-on-linear-regression.html"><i class="fa fa-check"></i><b>15</b> Conlusion on linear regression</a><ul>
<li class="chapter" data-level="15.1" data-path="conlusion-on-linear-regression.html"><a href="conlusion-on-linear-regression.html#conclusion"><i class="fa fa-check"></i><b>15.1</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="aula12.html"><a href="aula12.html"><i class="fa fa-check"></i><b>16</b> Class 13: 10 11 2020 Maximum likelihood and all that</a><ul>
<li class="chapter" data-level="16.1" data-path="aula12.html"><a href="aula12.html#maximizing-a-likelihood-algebraically"><i class="fa fa-check"></i><b>16.1</b> Maximizing a likelihood algebraically</a></li>
<li class="chapter" data-level="16.2" data-path="aula12.html"><a href="aula12.html#numerically-maximizing-a-likelihood"><i class="fa fa-check"></i><b>16.2</b> Numerically Maximizing a likelihood</a></li>
<li class="chapter" data-level="16.3" data-path="aula12.html"><a href="aula12.html#the-case-of-a-gaussian"><i class="fa fa-check"></i><b>16.3</b> The case of a Gaussian</a></li>
<li class="chapter" data-level="16.4" data-path="aula12.html"><a href="aula12.html#the-case-of-a-linear-model"><i class="fa fa-check"></i><b>16.4</b> The case of a linear model</a></li>
<li class="chapter" data-level="16.5" data-path="aula12.html"><a href="aula12.html#the-really-interesting-case"><i class="fa fa-check"></i><b>16.5</b> The really interesting case</a></li>
<li class="chapter" data-level="16.6" data-path="aula12.html"><a href="aula12.html#likelihood-above-and-beyond"><i class="fa fa-check"></i><b>16.6</b> Likelihood, above and beyond</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="aula14.html"><a href="aula14.html"><i class="fa fa-check"></i><b>17</b> Class 14: 11 11 2020 GLMs</a><ul>
<li class="chapter" data-level="17.1" data-path="aula14.html"><a href="aula14.html#what-are-glms"><i class="fa fa-check"></i><b>17.1</b> What are GLMs</a></li>
<li class="chapter" data-level="17.2" data-path="aula14.html"><a href="aula14.html#the-link-function"><i class="fa fa-check"></i><b>17.2</b> The link function</a></li>
<li class="chapter" data-level="17.3" data-path="aula14.html"><a href="aula14.html#most-useful-glm-families"><i class="fa fa-check"></i><b>17.3</b> Most useful GLM Families</a></li>
<li class="chapter" data-level="17.4" data-path="aula14.html"><a href="aula14.html#an-example-analysis"><i class="fa fa-check"></i><b>17.4</b> An example analysis</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="aula15.html"><a href="aula15.html"><i class="fa fa-check"></i><b>18</b> Class 15: 17 11 2020</a></li>
<li class="chapter" data-level="19" data-path="example-1-deviance.html"><a href="example-1-deviance.html"><i class="fa fa-check"></i><b>19</b> Example 1 - deviance</a></li>
<li class="chapter" data-level="20" data-path="example-2-lagartyos-glm.html"><a href="example-2-lagartyos-glm.html"><i class="fa fa-check"></i><b>20</b> Example 2 - lagartyos GLM</a><ul>
<li class="chapter" data-level="20.1" data-path="example-2-lagartyos-glm.html"><a href="example-2-lagartyos-glm.html#example-2"><i class="fa fa-check"></i><b>20.1</b> Example 2</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="aula16.html"><a href="aula16.html"><i class="fa fa-check"></i><b>21</b> Class 16: 18 11 2020</a><ul>
<li class="chapter" data-level="21.1" data-path="aula16.html"><a href="aula16.html#a-logistic-regression-example"><i class="fa fa-check"></i><b>21.1</b> A logistic regression example</a></li>
<li class="chapter" data-level="21.2" data-path="aula16.html"><a href="aula16.html#about-multicollinearity"><i class="fa fa-check"></i><b>21.2</b> About multicollinearity</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="aula17.html"><a href="aula17.html"><i class="fa fa-check"></i><b>22</b> Class 17: 24 11 2020</a></li>
<li class="chapter" data-level="23" data-path="aula18.html"><a href="aula18.html"><i class="fa fa-check"></i><b>23</b> Class 18: 25 11 2020</a><ul>
<li class="chapter" data-level="23.1" data-path="aula18.html"><a href="aula18.html#presence-of-bats"><i class="fa fa-check"></i><b>23.1</b> Presence of bats</a></li>
<li class="chapter" data-level="23.2" data-path="aula18.html"><a href="aula18.html#sponges"><i class="fa fa-check"></i><b>23.2</b> Sponges</a><ul>
<li class="chapter" data-level="23.2.1" data-path="aula18.html"><a href="aula18.html#reading-data-in"><i class="fa fa-check"></i><b>23.2.1</b> Reading data in</a></li>
<li class="chapter" data-level="23.2.2" data-path="aula18.html"><a href="aula18.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>23.2.2</b> Exploratory Data Analysis</a></li>
<li class="chapter" data-level="23.2.3" data-path="aula18.html"><a href="aula18.html#modelling"><i class="fa fa-check"></i><b>23.2.3</b> Modelling</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="aula18.html"><a href="aula18.html#extra-glm-stuff"><i class="fa fa-check"></i><b>23.3</b> Extra GLM stuff</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="aula19.html"><a href="aula19.html"><i class="fa fa-check"></i><b>24</b> Class 19: 02 12 2020</a></li>
<li class="chapter" data-level="25" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>25</b> Final Words</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes for Ecological Modelling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="aula7" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> Class 7 14 10 2020</h1>
<p>In this class we continue exploring regression models, but we are going to increase their complexity. No longer just <code>a+bx</code>, but we add more explanatory variables. In particular, we will also add a factor covariate. And then we look under the hood to what that means.</p>
<div id="task-1" class="section level2">
<h2><span class="header-section-number">9.1</span> Task 1</h2>
<p>The first task the students were faced was to use some code to explore, by simulation, the impact of having variables in the model that are not relevant to explain the response. In particular, we wanted to identify when there would be no errors, or when there would be type I (a variable not relevant to explain the response is found relevant) and type II (a relevant variable to explain the response is not considered relevant) errors. For the sake of this example we consider a significance level of 5%, but remember there is nothing sacred about it.</p>
<p>The guidelines provided were: “Using the code below, and while changing the <code>seed</code> (<code>******</code> to begin with, so the code does not run as is!), explore how changing the parameters and the error leads to different amounts of type I and type II errors.”</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1"><span class="co"># xs1 and xs2 wrong - type II error, xs3 and xs4 ok</span></a>
<a class="sourceLine" id="cb76-2" title="2">seed&lt;-<span class="er">******</span></a>
<a class="sourceLine" id="cb76-3" title="3"><span class="kw">set.seed</span>(seed)</a>
<a class="sourceLine" id="cb76-4" title="4"><span class="co">#define parameters</span></a>
<a class="sourceLine" id="cb76-5" title="5">n&lt;-<span class="dv">50</span>;b0&lt;-<span class="dv">5</span>;b1&lt;-<span class="dv">3</span>;b2&lt;-<span class="op">-</span><span class="dv">2</span>;error &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb76-6" title="6"><span class="co">#simulate potential explanatory variables</span></a>
<a class="sourceLine" id="cb76-7" title="7">xs1=<span class="kw">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb76-8" title="8">xs2=<span class="kw">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb76-9" title="9">xs3=<span class="kw">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb76-10" title="10">xs4=<span class="kw">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb76-11" title="11"><span class="co">#simulate response</span></a>
<a class="sourceLine" id="cb76-12" title="12">ys=b0<span class="op">+</span>b1<span class="op">*</span>xs1<span class="op">-</span>b2<span class="op">*</span>xs2<span class="op">+</span><span class="kw">rnorm</span>(n,<span class="dt">sd=</span>error)</a>
<a class="sourceLine" id="cb76-13" title="13"><span class="co">#plot data</span></a>
<a class="sourceLine" id="cb76-14" title="14"><span class="kw">plot</span>(xs1,ys)</a>
<a class="sourceLine" id="cb76-15" title="15"><span class="co">#a model missing a variable, xs2</span></a>
<a class="sourceLine" id="cb76-16" title="16"><span class="co">#summary(lm(ys~xs1))</span></a>
<a class="sourceLine" id="cb76-17" title="17"><span class="co">#the true model</span></a>
<a class="sourceLine" id="cb76-18" title="18"><span class="co">#summary(lm(ys~xs1+xs2))</span></a>
<a class="sourceLine" id="cb76-19" title="19"><span class="co">#a model including irrelevant variables</span></a>
<a class="sourceLine" id="cb76-20" title="20"><span class="kw">summary</span>(<span class="kw">lm</span>(ys<span class="op">~</span>xs1<span class="op">+</span>xs2<span class="op">+</span>xs3<span class="op">+</span>xs4))</a></code></pre></div>
<p>The first thing to notice is that the model we simulate from only includes <code>xs1</code> and <code>xs2</code>. So, <code>xs3</code> and <code>xs4</code> do not have any impact on the response <code>y</code></p>
<p>So we try different values for the seed and check what happens, Try <code>seed&lt;-1</code></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1">seed&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb77-2" title="2"><span class="kw">set.seed</span>(seed)</a>
<a class="sourceLine" id="cb77-3" title="3"><span class="co">#define parameters</span></a>
<a class="sourceLine" id="cb77-4" title="4">n&lt;-<span class="dv">50</span>;b0&lt;-<span class="dv">5</span>;b1&lt;-<span class="dv">3</span>;b2&lt;-<span class="op">-</span><span class="dv">2</span>;error &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb77-5" title="5"><span class="co">#simulate potential explanatory variables</span></a>
<a class="sourceLine" id="cb77-6" title="6">xs1=<span class="kw">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb77-7" title="7">xs2=<span class="kw">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb77-8" title="8">xs3=<span class="kw">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb77-9" title="9">xs4=<span class="kw">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb77-10" title="10"><span class="co">#simulate response</span></a>
<a class="sourceLine" id="cb77-11" title="11">ys=b0<span class="op">+</span>b1<span class="op">*</span>xs1<span class="op">-</span>b2<span class="op">*</span>xs2<span class="op">+</span><span class="kw">rnorm</span>(n,<span class="dt">sd=</span>error)</a>
<a class="sourceLine" id="cb77-12" title="12"><span class="co">#plot data</span></a>
<a class="sourceLine" id="cb77-13" title="13"><span class="kw">plot</span>(xs1,ys)</a>
<a class="sourceLine" id="cb77-14" title="14"><span class="co">#look at model summary</span></a>
<a class="sourceLine" id="cb77-15" title="15"><span class="kw">summary</span>(<span class="kw">lm</span>(ys<span class="op">~</span>xs1<span class="op">+</span>xs2<span class="op">+</span>xs3<span class="op">+</span>xs4))</a></code></pre></div>
<p>All good, no errors. That is, <code>xs1</code> and <code>xs2</code> are considered statistically significant at th 5% level and <code>xs3</code> and <code>xs4</code> are not found relevant to explain the response. Now, we keep changing <code>seed</code></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1">seed&lt;-<span class="dv">4</span></a>
<a class="sourceLine" id="cb78-2" title="2"><span class="kw">set.seed</span>(seed)</a>
<a class="sourceLine" id="cb78-3" title="3"><span class="co">#define parameters</span></a>
<a class="sourceLine" id="cb78-4" title="4">n&lt;-<span class="dv">50</span>;b0&lt;-<span class="dv">5</span>;b1&lt;-<span class="dv">3</span>;b2&lt;-<span class="op">-</span><span class="dv">2</span>;error &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb78-5" title="5"><span class="co">#simulate potential explanatory variables</span></a>
<a class="sourceLine" id="cb78-6" title="6">xs1=<span class="kw">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb78-7" title="7">xs2=<span class="kw">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb78-8" title="8">xs3=<span class="kw">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb78-9" title="9">xs4=<span class="kw">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb78-10" title="10"><span class="co">#simulate response</span></a>
<a class="sourceLine" id="cb78-11" title="11">ys=b0<span class="op">+</span>b1<span class="op">*</span>xs1<span class="op">-</span>b2<span class="op">*</span>xs2<span class="op">+</span><span class="kw">rnorm</span>(n,<span class="dt">sd=</span>error)</a>
<a class="sourceLine" id="cb78-12" title="12"><span class="co">#plot data</span></a>
<a class="sourceLine" id="cb78-13" title="13"><span class="kw">plot</span>(xs1,ys)</a>
<a class="sourceLine" id="cb78-14" title="14"><span class="co">#look at model summary</span></a>
<a class="sourceLine" id="cb78-15" title="15"><span class="kw">summary</span>(<span class="kw">lm</span>(ys<span class="op">~</span>xs1<span class="op">+</span>xs2<span class="op">+</span>xs3<span class="op">+</span>xs4))</a></code></pre></div>
<p>We find our first type I error, <code>xs4</code> is found statistically significant, but we know it has no effect on the response. The same happens with <code>seed</code> being e.g. 9, 10. When we try <code>seed &lt;- 11</code> we get another type I error, this time on <code>xs4</code></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1">seed&lt;-<span class="dv">11</span></a>
<a class="sourceLine" id="cb79-2" title="2"><span class="kw">set.seed</span>(seed)</a>
<a class="sourceLine" id="cb79-3" title="3"><span class="co">#define parameters</span></a>
<a class="sourceLine" id="cb79-4" title="4">n&lt;-<span class="dv">50</span>;b0&lt;-<span class="dv">5</span>;b1&lt;-<span class="dv">3</span>;b2&lt;-<span class="op">-</span><span class="dv">2</span>;error &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb79-5" title="5"><span class="co">#simulate potential explanatory variables</span></a>
<a class="sourceLine" id="cb79-6" title="6">xs1=<span class="kw">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb79-7" title="7">xs2=<span class="kw">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb79-8" title="8">xs3=<span class="kw">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb79-9" title="9">xs4=<span class="kw">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb79-10" title="10"><span class="co">#simulate response</span></a>
<a class="sourceLine" id="cb79-11" title="11">ys=b0<span class="op">+</span>b1<span class="op">*</span>xs1<span class="op">-</span>b2<span class="op">*</span>xs2<span class="op">+</span><span class="kw">rnorm</span>(n,<span class="dt">sd=</span>error)</a>
<a class="sourceLine" id="cb79-12" title="12"><span class="co">#plot data</span></a>
<a class="sourceLine" id="cb79-13" title="13"><span class="kw">plot</span>(xs1,ys)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a7.4-1.png" width="672" /></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="co">#look at model summary</span></a>
<a class="sourceLine" id="cb80-2" title="2"><span class="kw">summary</span>(<span class="kw">lm</span>(ys<span class="op">~</span>xs1<span class="op">+</span>xs2<span class="op">+</span>xs3<span class="op">+</span>xs4))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ys ~ xs1 + xs2 + xs3 + xs4)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.3076  -2.7316   0.3072   2.2102   7.9088 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 16.44303    7.42710   2.214   0.0319 *  
## xs1          2.87327    0.21665  13.262  &lt; 2e-16 ***
## xs2          1.93313    0.25274   7.649 1.12e-09 ***
## xs3         -0.47689    0.22325  -2.136   0.0381 *  
## xs4         -0.08922    0.20937  -0.426   0.6720    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.074 on 45 degrees of freedom
## Multiple R-squared:  0.8484,	Adjusted R-squared:  0.8349 
## F-statistic: 62.94 on 4 and 45 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>However, even after several runs, we never make a type II error. That must mean this setting has a large power, i.e. the ability to detect a true effect when one exists. Well, there are many ways to decrease power, like having a smaller sample size, increase the error or lower the true effect. Let’s try to increase the error, instead of the 4 used above, let’s pump it up10 fold to 40</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1">seed&lt;-<span class="dv">100</span></a>
<a class="sourceLine" id="cb82-2" title="2"><span class="kw">set.seed</span>(seed)</a>
<a class="sourceLine" id="cb82-3" title="3"><span class="co">#define parameters</span></a>
<a class="sourceLine" id="cb82-4" title="4">n&lt;-<span class="dv">50</span>;b0&lt;-<span class="dv">5</span>;b1&lt;-<span class="dv">3</span>;b2&lt;-<span class="op">-</span><span class="dv">2</span>;error &lt;-<span class="st"> </span><span class="dv">40</span></a>
<a class="sourceLine" id="cb82-5" title="5"><span class="co">#simulate potential explanatory variables</span></a>
<a class="sourceLine" id="cb82-6" title="6">xs1=<span class="kw">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb82-7" title="7">xs2=<span class="kw">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb82-8" title="8">xs3=<span class="kw">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb82-9" title="9">xs4=<span class="kw">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb82-10" title="10"><span class="co">#simulate response</span></a>
<a class="sourceLine" id="cb82-11" title="11">ys=b0<span class="op">+</span>b1<span class="op">*</span>xs1<span class="op">-</span>b2<span class="op">*</span>xs2<span class="op">+</span><span class="kw">rnorm</span>(n,<span class="dt">sd=</span>error)</a>
<a class="sourceLine" id="cb82-12" title="12"><span class="co">#plot data</span></a>
<a class="sourceLine" id="cb82-13" title="13"><span class="kw">plot</span>(xs1,ys)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a7.5-1.png" width="672" /></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1"><span class="co">#look at model summary</span></a>
<a class="sourceLine" id="cb83-2" title="2"><span class="kw">summary</span>(<span class="kw">lm</span>(ys<span class="op">~</span>xs1<span class="op">+</span>xs2<span class="op">+</span>xs3<span class="op">+</span>xs4))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ys ~ xs1 + xs2 + xs3 + xs4)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -73.25 -17.86  -6.76  21.25  68.42 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)  22.8661    41.3133   0.553    0.583
## xs1           1.6034     1.8564   0.864    0.392
## xs2           0.9163     1.8092   0.506    0.615
## xs3           1.9650     1.6038   1.225    0.227
## xs4          -0.8544     1.7449  -0.490    0.627
## 
## Residual standard error: 32.4 on 45 degrees of freedom
## Multiple R-squared:  0.06896,	Adjusted R-squared:  -0.0138 
## F-statistic: 0.8333 on 4 and 45 DF,  p-value: 0.5112</code></pre>
<p>That was an overkill, now there is so much noise must seeds we use do not allow us to find an effect, let’s cut that in half to 20</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1">seed&lt;-<span class="dv">100</span></a>
<a class="sourceLine" id="cb85-2" title="2"><span class="kw">set.seed</span>(seed)</a>
<a class="sourceLine" id="cb85-3" title="3"><span class="co">#define parameters</span></a>
<a class="sourceLine" id="cb85-4" title="4">n&lt;-<span class="dv">50</span>;b0&lt;-<span class="dv">5</span>;b1&lt;-<span class="dv">3</span>;b2&lt;-<span class="op">-</span><span class="dv">2</span>;error &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb85-5" title="5"><span class="co">#simulate potential explanatory variables</span></a>
<a class="sourceLine" id="cb85-6" title="6">xs1=<span class="kw">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb85-7" title="7">xs2=<span class="kw">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb85-8" title="8">xs3=<span class="kw">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb85-9" title="9">xs4=<span class="kw">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb85-10" title="10"><span class="co">#simulate response</span></a>
<a class="sourceLine" id="cb85-11" title="11">ys=b0<span class="op">+</span>b1<span class="op">*</span>xs1<span class="op">-</span>b2<span class="op">*</span>xs2<span class="op">+</span><span class="kw">rnorm</span>(n,<span class="dt">sd=</span>error)</a>
<a class="sourceLine" id="cb85-12" title="12"><span class="co">#plot data</span></a>
<a class="sourceLine" id="cb85-13" title="13"><span class="kw">plot</span>(xs1,ys)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a7.6-1.png" width="672" /></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="co">#look at model summary</span></a>
<a class="sourceLine" id="cb86-2" title="2"><span class="kw">summary</span>(<span class="kw">lm</span>(ys<span class="op">~</span>xs1<span class="op">+</span>xs2<span class="op">+</span>xs3<span class="op">+</span>xs4))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ys ~ xs1 + xs2 + xs3 + xs4)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -36.624  -8.927  -3.380  10.623  34.211 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  13.9330    20.6566   0.675    0.503  
## xs1           2.3017     0.9282   2.480    0.017 *
## xs2           1.4582     0.9046   1.612    0.114  
## xs3           0.9825     0.8019   1.225    0.227  
## xs4          -0.4272     0.8724  -0.490    0.627  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 16.2 on 45 degrees of freedom
## Multiple R-squared:  0.2262,	Adjusted R-squared:  0.1574 
## F-statistic: 3.288 on 4 and 45 DF,  p-value: 0.01901</code></pre>
<p>back to all correct. Now, let’s change seed again</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1">seed&lt;-<span class="dv">103</span></a>
<a class="sourceLine" id="cb88-2" title="2"><span class="kw">set.seed</span>(seed)</a>
<a class="sourceLine" id="cb88-3" title="3"><span class="co">#define parameters</span></a>
<a class="sourceLine" id="cb88-4" title="4">n&lt;-<span class="dv">50</span>;b0&lt;-<span class="dv">5</span>;b1&lt;-<span class="dv">3</span>;b2&lt;-<span class="op">-</span><span class="dv">2</span>;error &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb88-5" title="5"><span class="co">#simulate potential explanatory variables</span></a>
<a class="sourceLine" id="cb88-6" title="6">xs1=<span class="kw">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb88-7" title="7">xs2=<span class="kw">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb88-8" title="8">xs3=<span class="kw">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb88-9" title="9">xs4=<span class="kw">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb88-10" title="10"><span class="co">#simulate response</span></a>
<a class="sourceLine" id="cb88-11" title="11">ys=b0<span class="op">+</span>b1<span class="op">*</span>xs1<span class="op">-</span>b2<span class="op">*</span>xs2<span class="op">+</span><span class="kw">rnorm</span>(n,<span class="dt">sd=</span>error)</a>
<a class="sourceLine" id="cb88-12" title="12"><span class="co">#plot data</span></a>
<a class="sourceLine" id="cb88-13" title="13"><span class="kw">plot</span>(xs1,ys)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a7.7-1.png" width="672" /></p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1"><span class="co">#look at model summary</span></a>
<a class="sourceLine" id="cb89-2" title="2"><span class="kw">summary</span>(<span class="kw">lm</span>(ys<span class="op">~</span>xs1<span class="op">+</span>xs2<span class="op">+</span>xs3<span class="op">+</span>xs4))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ys ~ xs1 + xs2 + xs3 + xs4)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -36.079 -10.686  -0.148  16.413  33.845 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  9.70575   33.83339   0.287   0.7755  
## xs1          2.32559    0.93980   2.475   0.0172 *
## xs2          1.97688    1.20464   1.641   0.1078  
## xs3          0.69013    1.02110   0.676   0.5026  
## xs4          0.08031    0.97427   0.082   0.9347  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 19.6 on 45 degrees of freedom
## Multiple R-squared:  0.1524,	Adjusted R-squared:  0.07706 
## F-statistic: 2.023 on 4 and 45 DF,  p-value: 0.1073</code></pre>
<p>Bang on, a type II error, as <code>xs2</code> is no longer considered statistically significant. I am sure you can now play with the relevant model parameters, <code>b1</code>, <code>b2</code>, to incleare and decreese the actual effect, and with sample size <code>n</code> or as above with the <code>error</code> and explore the consequences of changing the balance in effect size, error and sample size on the ability of incurring in errors when doing regression. But remmeber the key, the reason we are able to see if an error is made or not is because we simulated reality. In this case, as it is never the case in an ecological dataset, we know the true model, which was</p>
<p><span class="math display">\[y=\beta_0+\beta_1 xs_1+\beta_2 xs2\]</span></p>
<p>That is the luxury of simulation, allowing you to test scenarios where “reality” is known, hence evaluating methods performance.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1">folder&lt;-<span class="st">&quot;extfiles/&quot;</span></a>
<a class="sourceLine" id="cb91-2" title="2"><span class="co">#folder&lt;-&quot;../Aula7 14 10 2020/&quot;</span></a>
<a class="sourceLine" id="cb91-3" title="3">d4l &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file=</span><span class="kw">paste0</span>(folder,<span class="st">&quot;data4lines.csv&quot;</span>))</a>
<a class="sourceLine" id="cb91-4" title="4">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(d4l)</a></code></pre></div>
</div>
<div id="task-2" class="section level2">
<h2><span class="header-section-number">9.2</span> Task 2</h2>
<p>The second task the students were faced was to create some regression data and the explore fitting models to it.</p>
<p><img src="extfiles/Aula7Task7.JPG" /></p>
<p>The data was simulated via this website: <a href="https://drawdata.xyz/" class="uri">https://drawdata.xyz/</a> and was named <code>data4lines.csv</code>. Each student had its own dataset, here I work with my example.</p>
<p>We begin by reading the data in and plot it</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1"><span class="co">#read the data</span></a>
<a class="sourceLine" id="cb92-2" title="2"><span class="co">#folder&lt;-&quot;../Aula7 14 10 2020/&quot;</span></a>
<a class="sourceLine" id="cb92-3" title="3">folder&lt;-<span class="st">&quot;extfiles/&quot;</span></a>
<a class="sourceLine" id="cb92-4" title="4">data4lines &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file=</span><span class="kw">paste0</span>(folder,<span class="st">&quot;data4lines.csv&quot;</span>))</a>
<a class="sourceLine" id="cb92-5" title="5"><span class="co">#plot all the data</span></a>
<a class="sourceLine" id="cb92-6" title="6"><span class="kw">plot</span>(y<span class="op">~</span>x,<span class="dt">data=</span>data4lines)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a7.9-1.png" width="672" /></p>
<p>Now, to turn this a bit more interesting, we come up with a narrative.</p>
<p>These correspond to observations from weights and lenghts of a sample of animals, fish from the species <em>Fishus inventadicus</em>. We could fit a regression line to this data and see if we can predict weight from length</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1"><span class="co">#plot all the data</span></a>
<a class="sourceLine" id="cb93-2" title="2"><span class="kw">plot</span>(y<span class="op">~</span>x,<span class="dt">data=</span>data4lines)</a>
<a class="sourceLine" id="cb93-3" title="3"><span class="co">#fit model to pooled data</span></a>
<a class="sourceLine" id="cb93-4" title="4">lmlinesG&lt;-<span class="kw">lm</span>(y<span class="op">~</span>x,<span class="dt">data=</span>data4lines)</a>
<a class="sourceLine" id="cb93-5" title="5"><span class="kw">abline</span>(lmlinesG,<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">lty=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a7.10-1.png" width="672" /></p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1"><span class="kw">summary</span>(lmlinesG)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x, data = data4lines)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -134.304  -44.188   -1.995   29.432  148.202 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 107.17590   14.03069   7.639 3.51e-12 ***
## x             0.35513    0.03553   9.995  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 61.78 on 136 degrees of freedom
## Multiple R-squared:  0.4235,	Adjusted R-squared:  0.4193 
## F-statistic: 99.91 on 1 and 136 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>and it looks like we can indeed predict the weight of the species from its length. The length is higly statistically significant. Not surprisingly, the longer the fish the heavier it is.</p>
<p>Now, the plot thickens. These animals actually came from 4 different museums, and are assumed to be the same species. However, a scientis decides to look at wether there are differences in the data from the 4 museums. So he colours the data by museum</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1"><span class="co">#plot all the data</span></a>
<a class="sourceLine" id="cb96-2" title="2"><span class="kw">plot</span>(y<span class="op">~</span>x,<span class="dt">col=</span><span class="kw">as.numeric</span>(<span class="kw">as.factor</span>(z)),<span class="dt">data=</span>data4lines,<span class="dt">pch=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb96-3" title="3"><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="dt">inset=</span><span class="fl">0.05</span>,<span class="dt">legend=</span>letters[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>],<span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dt">pch=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a7.11-1.png" width="672" /></p>
<p>We see a patter in the data, the data from the different museums tend to cluster. He decides to investigate. Note folks providing names to museum in this country are a bit borring, and the museums are called “a”, “b”, “c” and “d”.</p>
<p>Our smart researcher says: “well, it seems like the relationship might be different in each museum”. Then, maybe I should fit a model that includes museum as a covariate <code>weight~length+museum</code>.</p>
<p><span class="math display">\[y=\beta_0+\beta_1 \times length +\beta_2 \times museum\]</span></p>
<p>And so he does and plots it</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1"><span class="co">#fit model per group</span></a>
<a class="sourceLine" id="cb97-2" title="2">lmlines&lt;-<span class="kw">lm</span>(y<span class="op">~</span>x<span class="op">+</span>z,<span class="dt">data=</span>data4lines)</a>
<a class="sourceLine" id="cb97-3" title="3"><span class="kw">summary</span>(lmlines)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + z, data = data4lines)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -90.01 -35.01   2.54  35.51 108.10 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  45.51813   13.83069   3.291  0.00128 ** 
## x             0.39657    0.02516  15.763  &lt; 2e-16 ***
## zb           54.92376   12.11597   4.533 1.28e-05 ***
## zc          128.20339   11.72572  10.934  &lt; 2e-16 ***
## zd           22.82412   10.26509   2.223  0.02787 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 42.5 on 133 degrees of freedom
## Multiple R-squared:  0.7332,	Adjusted R-squared:  0.7252 
## F-statistic: 91.38 on 4 and 133 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The output shows that the length is relevant, but the museum is relevant too. The relationship might be different per museum! In the output we see the <code>x</code>, the length, but not the <code>z</code>, it has been transformed into <code>zb</code>, <code>zc</code> and <code>zd</code>. Why is that? That is a mistery that we shall unfold now!</p>
<p>While the model we are fitting might be represented by <code>weight~length+museum</code>, th edesign matrix being fitted replaces the <code>museum</code> (a factor with 4 levels) with 3 dummy variables (a factor with k levels required k-1 dummy variables). So the real model being fitted is really</p>
<p><span class="math display">\[y=\beta_0+\beta_1 \times length + \beta_{2b} \times zb + \beta_{2c} \times zc + \beta_{2d} \times zd\]</span></p>
<p>Wait, but where is the level <code>a</code>? It is in the intercept, and if I had an euro for each time that confused a student, I would not be here but in a beach in the Bahamas having a piña colada :)</p>
<p>But let’s unfold the mistery, shall we? By default, R takes 1 level of (each/a) factor and uses it as the intercept. Here it used <code>a</code> (the choice is in this case by alphabetical ored, but one can change that, which might be useful if e.g. you want to have as the intercept a control level, say; look e.g. into function <code>factor</code> help to see how you can change the baseline <code>level</code> of a factor).</p>
<p>Hence, the intercept for museum <code>a</code> is 45.5181335. What about the intercep of the othe rmuseums? They are always reported with <code>a</code> as the reference. Look at the equation above, what happens when say zc is 1 and zd and zb are 0, it becomes</p>
<p><span class="math display">\[y=\beta_0+\beta_1 \times length + \beta_{2c} \times zc \]</span>
<span class="math display">\[y=(\beta_0+\beta_{2c})+\beta_1 \times length = intercep + slope \times length\]</span></p>
<p>and so, from the above output, that equates to <code>y=lmlines$coefficients[1]+lmlines$coefficients[4],lmlines$coefficients[2]</code> or 173.7215247+0.3965715 <span class="math inline">\(\times\)</span> <code>length</code>.</p>
<p>So now we can add all these estimated regression lines to the plot</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1"><span class="co">#plot all</span></a>
<a class="sourceLine" id="cb99-2" title="2"><span class="kw">plot</span>(y<span class="op">~</span>x,<span class="dt">col=</span>z,<span class="dt">data=</span>data4lines)</a>
<a class="sourceLine" id="cb99-3" title="3"><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="dt">inset=</span><span class="fl">0.05</span>,<span class="dt">legend=</span><span class="kw">c</span>(LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>],<span class="st">&quot;all&quot;</span>),<span class="dt">col=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dv">1</span>),<span class="dt">lty=</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">4</span>),<span class="dv">2</span>),<span class="dt">lwd=</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">4</span>),<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb99-4" title="4"><span class="co">#these are the wrong lines... why?</span></a>
<a class="sourceLine" id="cb99-5" title="5"><span class="kw">abline</span>(lmlinesG,<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb99-6" title="6"><span class="kw">abline</span>(lmlines<span class="op">$</span>coefficients[<span class="dv">1</span>],lmlines<span class="op">$</span>coefficients[<span class="dv">2</span>],<span class="dt">col=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb99-7" title="7"><span class="kw">abline</span>(lmlines<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lmlines<span class="op">$</span>coefficients[<span class="dv">3</span>],lmlines<span class="op">$</span>coefficients[<span class="dv">2</span>],<span class="dt">col=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb99-8" title="8"><span class="kw">abline</span>(lmlines<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lmlines<span class="op">$</span>coefficients[<span class="dv">4</span>],lmlines<span class="op">$</span>coefficients[<span class="dv">2</span>],<span class="dt">col=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb99-9" title="9"><span class="kw">abline</span>(lmlines<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lmlines<span class="op">$</span>coefficients[<span class="dv">5</span>],lmlines<span class="op">$</span>coefficients[<span class="dv">2</span>],<span class="dt">col=</span><span class="dv">4</span>)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a7.13-1.png" width="672" /></p>
<p>note that, not surprisingly, all these lines have the same slope. Or in other words, the model we considered assumes that the slope of the model is the same across museums (which, remember, we know if not true!). We can easily check that the intercepts (i.e. where the lines cross when length=x=0) of all lines are indeed easy to get from the model’s output</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1"><span class="co">#plot all</span></a>
<a class="sourceLine" id="cb100-2" title="2"><span class="kw">plot</span>(y<span class="op">~</span>x,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>,<span class="dv">700</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">450</span>),<span class="dt">col=</span>z,<span class="dt">data=</span>data4lines)</a>
<a class="sourceLine" id="cb100-3" title="3"><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="dt">inset=</span><span class="fl">0.05</span>,<span class="dt">legend=</span><span class="kw">c</span>(LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>],<span class="st">&quot;all&quot;</span>),<span class="dt">col=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dv">1</span>),<span class="dt">lty=</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">4</span>),<span class="dv">2</span>),<span class="dt">lwd=</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">4</span>),<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb100-4" title="4"><span class="co">#these are the wrong lines... why?</span></a>
<a class="sourceLine" id="cb100-5" title="5"><span class="kw">abline</span>(lmlinesG,<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb100-6" title="6"><span class="kw">abline</span>(lmlines<span class="op">$</span>coefficients[<span class="dv">1</span>],lmlines<span class="op">$</span>coefficients[<span class="dv">2</span>],<span class="dt">col=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb100-7" title="7"><span class="kw">abline</span>(lmlines<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lmlines<span class="op">$</span>coefficients[<span class="dv">3</span>],lmlines<span class="op">$</span>coefficients[<span class="dv">2</span>],<span class="dt">col=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb100-8" title="8"><span class="kw">abline</span>(lmlines<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lmlines<span class="op">$</span>coefficients[<span class="dv">4</span>],lmlines<span class="op">$</span>coefficients[<span class="dv">2</span>],<span class="dt">col=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb100-9" title="9"><span class="kw">abline</span>(lmlines<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lmlines<span class="op">$</span>coefficients[<span class="dv">5</span>],lmlines<span class="op">$</span>coefficients[<span class="dv">2</span>],<span class="dt">col=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb100-10" title="10"></a>
<a class="sourceLine" id="cb100-11" title="11"></a>
<a class="sourceLine" id="cb100-12" title="12"><span class="kw">abline</span>(<span class="dt">v=</span><span class="dv">0</span>,<span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb100-13" title="13"><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">45.51813</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb100-14" title="14"><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">45.51813+54.92376</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb100-15" title="15"><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">45.51813+128.20339</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb100-16" title="16"><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">45.51813+22.82412</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">4</span>)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a7.14-1.png" width="672" /></p>
<p>Now, the smart biologist then says that he could also fit a separate line to each museum’s data. And so he does, and that looks like this:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1"><span class="co">#plot all the data</span></a>
<a class="sourceLine" id="cb101-2" title="2"><span class="kw">plot</span>(y<span class="op">~</span>x,<span class="dt">col=</span><span class="kw">as.numeric</span>(<span class="kw">as.factor</span>(z)),<span class="dt">data=</span>data4lines,<span class="dt">pch=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb101-3" title="3"><span class="co">#completely independet regression lines</span></a>
<a class="sourceLine" id="cb101-4" title="4"><span class="kw">abline</span>(<span class="kw">lm</span>(y<span class="op">~</span>x,<span class="dt">data=</span>data4lines[data4lines<span class="op">$</span>z<span class="op">==</span><span class="st">&quot;a&quot;</span>,]),<span class="dt">col=</span><span class="dv">1</span>,<span class="dt">lty=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb101-5" title="5"><span class="kw">abline</span>(<span class="kw">lm</span>(y<span class="op">~</span>x,<span class="dt">data=</span>data4lines[data4lines<span class="op">$</span>z<span class="op">==</span><span class="st">&quot;b&quot;</span>,]),<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb101-6" title="6"><span class="kw">abline</span>(<span class="kw">lm</span>(y<span class="op">~</span>x,<span class="dt">data=</span>data4lines[data4lines<span class="op">$</span>z<span class="op">==</span><span class="st">&quot;c&quot;</span>,]),<span class="dt">col=</span><span class="dv">3</span>,<span class="dt">lty=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb101-7" title="7"><span class="kw">abline</span>(<span class="kw">lm</span>(y<span class="op">~</span>x,<span class="dt">data=</span>data4lines[data4lines<span class="op">$</span>z<span class="op">==</span><span class="st">&quot;d&quot;</span>,]),<span class="dt">col=</span><span class="dv">4</span>,<span class="dt">lty=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb101-8" title="8"><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="dt">inset=</span><span class="fl">0.05</span>,<span class="dt">legend=</span>letters[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>],<span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dt">pch=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a7.15-1.png" width="672" /></p>
<p>Naturally, now the lines do not have the same slope, and we can compare all these in a single plot. This plot is really messy, as it includes the pooled regression (the thick black line), the regressions fitted to independent data sets, one for each museum (the solid lines), and the regressions resulting from the model with museum as a factor covariate (dotted-dashed lines).</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1"><span class="co">#plot all the data</span></a>
<a class="sourceLine" id="cb102-2" title="2"><span class="kw">plot</span>(y<span class="op">~</span>x,<span class="dt">col=</span><span class="kw">as.numeric</span>(<span class="kw">as.factor</span>(z)),<span class="dt">data=</span>data4lines,<span class="dt">pch=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb102-3" title="3"><span class="co">#completely independet regression lines</span></a>
<a class="sourceLine" id="cb102-4" title="4"><span class="kw">abline</span>(<span class="kw">lm</span>(y<span class="op">~</span>x,<span class="dt">data=</span>data4lines[data4lines<span class="op">$</span>z<span class="op">==</span><span class="st">&quot;a&quot;</span>,]),<span class="dt">col=</span><span class="dv">1</span>,<span class="dt">lty=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb102-5" title="5"><span class="kw">abline</span>(<span class="kw">lm</span>(y<span class="op">~</span>x,<span class="dt">data=</span>data4lines[data4lines<span class="op">$</span>z<span class="op">==</span><span class="st">&quot;b&quot;</span>,]),<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb102-6" title="6"><span class="kw">abline</span>(<span class="kw">lm</span>(y<span class="op">~</span>x,<span class="dt">data=</span>data4lines[data4lines<span class="op">$</span>z<span class="op">==</span><span class="st">&quot;c&quot;</span>,]),<span class="dt">col=</span><span class="dv">3</span>,<span class="dt">lty=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb102-7" title="7"><span class="kw">abline</span>(<span class="kw">lm</span>(y<span class="op">~</span>x,<span class="dt">data=</span>data4lines[data4lines<span class="op">$</span>z<span class="op">==</span><span class="st">&quot;d&quot;</span>,]),<span class="dt">col=</span><span class="dv">4</span>,<span class="dt">lty=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb102-8" title="8"><span class="co">#these are the wrong lines... why?</span></a>
<a class="sourceLine" id="cb102-9" title="9"><span class="kw">abline</span>(lmlinesG,<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb102-10" title="10"><span class="kw">abline</span>(lmlines<span class="op">$</span>coefficients[<span class="dv">1</span>],lmlines<span class="op">$</span>coefficients[<span class="dv">2</span>],<span class="dt">col=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb102-11" title="11"><span class="kw">abline</span>(lmlines<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lmlines<span class="op">$</span>coefficients[<span class="dv">3</span>],lmlines<span class="op">$</span>coefficients[<span class="dv">2</span>],<span class="dt">col=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb102-12" title="12"><span class="kw">abline</span>(lmlines<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lmlines<span class="op">$</span>coefficients[<span class="dv">4</span>],lmlines<span class="op">$</span>coefficients[<span class="dv">2</span>],<span class="dt">col=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb102-13" title="13"><span class="kw">abline</span>(lmlines<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lmlines<span class="op">$</span>coefficients[<span class="dv">5</span>],lmlines<span class="op">$</span>coefficients[<span class="dv">2</span>],<span class="dt">col=</span><span class="dv">4</span>)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a7.16-1.png" width="672" /></p>
<p>But what is the best model to describe the data? That is a mistery that will remain to unfold. For that we will need and additional complication in a regression model: interactions.</p>
<p>But note 1 thing to begin with. The pooled model uses just 2 parameters, one slope and one intercept. The independent lines use 8 parameters, 4 slopes and 4 intercepts, one line for each museum. And the single model with <code>lenght</code> and <code>museum</code> uses 5 parameters, the intercept, the slope for <code>length</code>, and 3 parameters associated with the <span class="math inline">\(k-1=3\)</span> levels of <code>museum</code> (remember, one level of each factor is absorbed by the regression intercept).</p>
<p>So the choice of what is best might be not straightforward. While we created the data by hand, we do not know the true model! Choosing the best model requires choosing between models with different complexity, i.e. different number of parameters. We will need a parsimonious model, one that describes the data well, but with a number of parameters that is not too high for the available data. That will also require selection criteria.</p>
<p>Stay tuned for the next episodes on our regression saga!</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="aula6.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="aula8.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ECOMODbook.pdf", "ECOMODbook.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
