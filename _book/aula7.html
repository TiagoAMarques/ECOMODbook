<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Two tasks to further understand regression | Notes for Ecological Modelling</title>
  <meta name="description" content="This is based on Yihui Xie’s a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Two tasks to further understand regression | Notes for Ecological Modelling" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is based on Yihui Xie’s a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Two tasks to further understand regression | Notes for Ecological Modelling" />
  
  <meta name="twitter:description" content="This is based on Yihui Xie’s a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Tiago A. Marques" />


<meta name="date" content="2023-11-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="RIO.html"/>
<link rel="next" href="aula8.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="mainintro.html"><a href="mainintro.html"><i class="fa fa-check"></i><b>2</b> Preamble</a></li>
<li class="chapter" data-level="3" data-path="aknowledgments.html"><a href="aknowledgments.html"><i class="fa fa-check"></i><b>3</b> Aknowledgments</a></li>
<li class="chapter" data-level="4" data-path="usingRintro.html"><a href="usingRintro.html"><i class="fa fa-check"></i><b>4</b> Using R</a></li>
<li class="chapter" data-level="5" data-path="prelim.html"><a href="prelim.html"><i class="fa fa-check"></i><b>5</b> Preliminaries</a>
<ul>
<li class="chapter" data-level="5.1" data-path="prelim.html"><a href="prelim.html#lbtb"><i class="fa fa-check"></i><b>5.1</b> Learning by the book</a></li>
<li class="chapter" data-level="5.2" data-path="prelim.html"><a href="prelim.html#ftpt"><i class="fa fa-check"></i><b>5.2</b> Following the paper trail</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="about-regression.html"><a href="about-regression.html"><i class="fa fa-check"></i><b>6</b> About regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="about-regression.html"><a href="about-regression.html#what-is-a-regression"><i class="fa fa-check"></i><b>6.1</b> What is a regression?</a></li>
<li class="chapter" data-level="6.2" data-path="about-regression.html"><a href="about-regression.html#the-general-linear-model"><i class="fa fa-check"></i><b>6.2</b> The general linear model</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="handson.html"><a href="handson.html"><i class="fa fa-check"></i><b>7</b> Hands On Regression</a>
<ul>
<li class="chapter" data-level="7.1" data-path="handson.html"><a href="handson.html#the-assumptions-are-on-the-residuals-not-the-data"><i class="fa fa-check"></i><b>7.1</b> The assumptions are on the residuals, not the data</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="RIO.html"><a href="RIO.html"><i class="fa fa-check"></i><b>8</b> Regression inside out</a>
<ul>
<li class="chapter" data-level="8.1" data-path="RIO.html"><a href="RIO.html#implementing-a-regression"><i class="fa fa-check"></i><b>8.1</b> Implementing a regression</a></li>
<li class="chapter" data-level="8.2" data-path="RIO.html"><a href="RIO.html#simulating-regression-data"><i class="fa fa-check"></i><b>8.2</b> Simulating regression data</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="RIO.html"><a href="RIO.html#what-is-the-effect-of-increasing-the-error-a-simulation-experiment"><i class="fa fa-check"></i><b>8.2.1</b> What is the effect of increasing the error: a simulation experiment</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="aula7.html"><a href="aula7.html"><i class="fa fa-check"></i><b>9</b> Two tasks to further understand regression</a>
<ul>
<li class="chapter" data-level="9.1" data-path="aula7.html"><a href="aula7.html#task-1"><i class="fa fa-check"></i><b>9.1</b> Task 1</a></li>
<li class="chapter" data-level="9.2" data-path="aula7.html"><a href="aula7.html#task-2"><i class="fa fa-check"></i><b>9.2</b> Task 2</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="aula8.html"><a href="aula8.html"><i class="fa fa-check"></i><b>10</b> t-tests and ANOVAs are just linear models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="aula8.html"><a href="aula8.html#a-one-sample-t-test-is-the-simplest-possible-linear-model"><i class="fa fa-check"></i><b>10.1</b> A one sample t-test is the simplest possible linear model</a></li>
<li class="chapter" data-level="10.2" data-path="aula8.html"><a href="aula8.html#the-t-test"><i class="fa fa-check"></i><b>10.2</b> The t-test</a></li>
<li class="chapter" data-level="10.3" data-path="aula8.html"><a href="aula8.html#anova"><i class="fa fa-check"></i><b>10.3</b> ANOVA</a></li>
<li class="chapter" data-level="10.4" data-path="aula8.html"><a href="aula8.html#a-two-way-anova-and-beyhond-ex-task-do-it-yourself"><i class="fa fa-check"></i><b>10.4</b> A two way ANOVA, and beyhond (ex Task: do it yourself!)</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="aula9.html"><a href="aula9.html"><i class="fa fa-check"></i><b>11</b> Class 9: 21 10 2020 - ANCOVA is (also) just a linear model</a>
<ul>
<li class="chapter" data-level="11.1" data-path="aula9.html"><a href="aula9.html#common-slope-different-intercepts-per-treatment"><i class="fa fa-check"></i><b>11.1</b> Common slope, different intercepts per treatment</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="aula10.html"><a href="aula10.html"><i class="fa fa-check"></i><b>12</b> Class 10: 27 10 2020</a>
<ul>
<li class="chapter" data-level="12.1" data-path="aula10.html"><a href="aula10.html#same-story-another-spin"><i class="fa fa-check"></i><b>12.1</b> Same story, another spin</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="aula11.html"><a href="aula11.html"><i class="fa fa-check"></i><b>13</b> Class 11: 03 11 2020 ANCOVA with different slopes: interactions</a>
<ul>
<li class="chapter" data-level="13.1" data-path="aula11.html"><a href="aula11.html#about-interactions"><i class="fa fa-check"></i><b>13.1</b> About interactions</a></li>
<li class="chapter" data-level="13.2" data-path="aula11.html"><a href="aula11.html#task-1-implementing-the-ancova-with-different-slopes"><i class="fa fa-check"></i><b>13.2</b> Task 1 Implementing the ANCOVA with different slopes</a></li>
<li class="chapter" data-level="13.3" data-path="aula11.html"><a href="aula11.html#task-2-modeling-a-data-set"><i class="fa fa-check"></i><b>13.3</b> Task 2 Modeling a data set</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="aula13.html"><a href="aula13.html"><i class="fa fa-check"></i><b>14</b> Class 12: 04 11 2020 Interactions between continous covariates</a>
<ul>
<li class="chapter" data-level="14.1" data-path="aula13.html"><a href="aula13.html#larger-order-interactions"><i class="fa fa-check"></i><b>14.1</b> Larger order interactions</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="conclusion-on-linear-regression.html"><a href="conclusion-on-linear-regression.html"><i class="fa fa-check"></i><b>15</b> Conclusion on linear regression</a>
<ul>
<li class="chapter" data-level="15.1" data-path="conclusion-on-linear-regression.html"><a href="conclusion-on-linear-regression.html#conclusion"><i class="fa fa-check"></i><b>15.1</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="aula12.html"><a href="aula12.html"><i class="fa fa-check"></i><b>16</b> Class 13: 10 11 2020 Maximum likelihood and all that</a>
<ul>
<li class="chapter" data-level="16.1" data-path="aula12.html"><a href="aula12.html#maximizing-a-likelihood-algebraically"><i class="fa fa-check"></i><b>16.1</b> Maximizing a likelihood algebraically</a></li>
<li class="chapter" data-level="16.2" data-path="aula12.html"><a href="aula12.html#numerically-maximizing-a-likelihood"><i class="fa fa-check"></i><b>16.2</b> Numerically Maximizing a likelihood</a></li>
<li class="chapter" data-level="16.3" data-path="aula12.html"><a href="aula12.html#the-case-of-a-gaussian"><i class="fa fa-check"></i><b>16.3</b> The case of a Gaussian</a></li>
<li class="chapter" data-level="16.4" data-path="aula12.html"><a href="aula12.html#the-case-of-a-linear-model"><i class="fa fa-check"></i><b>16.4</b> The case of a linear model</a></li>
<li class="chapter" data-level="16.5" data-path="aula12.html"><a href="aula12.html#the-really-interesting-case"><i class="fa fa-check"></i><b>16.5</b> The really interesting case</a></li>
<li class="chapter" data-level="16.6" data-path="aula12.html"><a href="aula12.html#likelihood-above-and-beyond"><i class="fa fa-check"></i><b>16.6</b> Likelihood, above and beyond</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="aula14.html"><a href="aula14.html"><i class="fa fa-check"></i><b>17</b> Class 14: 11 11 2020 GLMs</a>
<ul>
<li class="chapter" data-level="17.1" data-path="aula14.html"><a href="aula14.html#what-are-glms"><i class="fa fa-check"></i><b>17.1</b> What are GLMs</a></li>
<li class="chapter" data-level="17.2" data-path="aula14.html"><a href="aula14.html#the-link-function"><i class="fa fa-check"></i><b>17.2</b> The link function</a></li>
<li class="chapter" data-level="17.3" data-path="aula14.html"><a href="aula14.html#most-useful-glm-families"><i class="fa fa-check"></i><b>17.3</b> Most useful GLM Families</a></li>
<li class="chapter" data-level="17.4" data-path="aula14.html"><a href="aula14.html#an-example-analysis"><i class="fa fa-check"></i><b>17.4</b> An example analysis</a></li>
<li class="chapter" data-level="17.5" data-path="aula14.html"><a href="aula14.html#an-example-of-a-glm-as-a-detail-within-a-conceptualization-framework"><i class="fa fa-check"></i><b>17.5</b> An example of a GLM as a detail within a conceptualization framework</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="aula15.html"><a href="aula15.html"><i class="fa fa-check"></i><b>18</b> Class 15: 17 11 2020</a></li>
<li class="chapter" data-level="19" data-path="example-1---deviance.html"><a href="example-1---deviance.html"><i class="fa fa-check"></i><b>19</b> Example 1 - deviance</a></li>
<li class="chapter" data-level="20" data-path="example-2---lagartyos-glm.html"><a href="example-2---lagartyos-glm.html"><i class="fa fa-check"></i><b>20</b> Example 2 - lagartyos GLM</a>
<ul>
<li class="chapter" data-level="20.1" data-path="example-2---lagartyos-glm.html"><a href="example-2---lagartyos-glm.html#example-2"><i class="fa fa-check"></i><b>20.1</b> Example 2</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="aula16.html"><a href="aula16.html"><i class="fa fa-check"></i><b>21</b> Class 16: 18 11 2020</a>
<ul>
<li class="chapter" data-level="21.1" data-path="aula16.html"><a href="aula16.html#a-logistic-regression-example"><i class="fa fa-check"></i><b>21.1</b> A logistic regression example</a></li>
<li class="chapter" data-level="21.2" data-path="aula16.html"><a href="aula16.html#titanic-example"><i class="fa fa-check"></i><b>21.2</b> Titanic example</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="aula16.html"><a href="aula16.html#análise-exploratoria-de-dados"><i class="fa fa-check"></i><b>21.2.1</b> Análise Exploratoria de Dados</a></li>
<li class="chapter" data-level="21.2.2" data-path="aula16.html"><a href="aula16.html#modelação"><i class="fa fa-check"></i><b>21.2.2</b> Modelação</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="aula16.html"><a href="aula16.html#about-multicollinearity"><i class="fa fa-check"></i><b>21.3</b> About multicollinearity</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="aula17.html"><a href="aula17.html"><i class="fa fa-check"></i><b>22</b> Random effects and mixed Models</a></li>
<li class="chapter" data-level="23" data-path="aula18.html"><a href="aula18.html"><i class="fa fa-check"></i><b>23</b> Class 18: 25 11 2020</a>
<ul>
<li class="chapter" data-level="23.1" data-path="aula18.html"><a href="aula18.html#presence-of-bats"><i class="fa fa-check"></i><b>23.1</b> Presence of bats</a></li>
<li class="chapter" data-level="23.2" data-path="aula18.html"><a href="aula18.html#sponges"><i class="fa fa-check"></i><b>23.2</b> Sponges</a>
<ul>
<li class="chapter" data-level="23.2.1" data-path="aula18.html"><a href="aula18.html#reading-data-in"><i class="fa fa-check"></i><b>23.2.1</b> Reading data in</a></li>
<li class="chapter" data-level="23.2.2" data-path="aula18.html"><a href="aula18.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>23.2.2</b> Exploratory Data Analysis</a></li>
<li class="chapter" data-level="23.2.3" data-path="aula18.html"><a href="aula18.html#modelling"><i class="fa fa-check"></i><b>23.2.3</b> Modelling</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="aula18.html"><a href="aula18.html#extra-glm-stuff"><i class="fa fa-check"></i><b>23.3</b> Extra GLM stuff</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="aula19.html"><a href="aula19.html"><i class="fa fa-check"></i><b>24</b> Class 19: 02 12 2020</a></li>
<li class="chapter" data-level="25" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>25</b> Final Words</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes for Ecological Modelling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="aula7" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapter 9</span> Two tasks to further understand regression<a href="aula7.html#aula7" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this class we continue exploring regression models, but we are going to increase their complexity. We are no longer just thinking about the simple linear model <code>a+bx</code>, but we add more explanatory variables. In particular, we will also add a factor covariate. And then we look under the hood to understand what that means in practice and how to interpret the regression coefficients.</p>
<p>We do this based on a couple of tasks. Implementing the tasks allows the students to see hands on what is behind the regression model.</p>
<div id="task-1" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Task 1<a href="aula7.html#task-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The first task the students were faced was to use some code to explore, by simulation, the impact of having variables in the model that are not relevant to explain the response. In particular, we wanted to identify when there would be no errors, or when there would be type I (a variable not relevant to explain the response is found relevant) and type II (a relevant variable to explain the response is not considered relevant) errors.</p>
<p>For the sake of this example we consider a significance level of 5%, but remember there is nothing sacred about <span class="math inline">\(\alpha=0.05\)</span>. The significance level should be chosen by a researcher given proper consideration of the implications of a type I error in the considered setting.</p>
<p>The guidelines provided were: “Using the code below, and while changing the <code>seed</code> (<code>******</code> to begin with, so the code does not run as is!), explore how changing the parameters and the error leads to different amounts of type I and type II errors.”</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="aula7.html#cb67-1" tabindex="-1"></a><span class="co"># xs1 and xs2 wrong - type II error, xs3 and xs4 ok</span></span>
<span id="cb67-2"><a href="aula7.html#cb67-2" tabindex="-1"></a>seed<span class="ot">&lt;-</span><span class="er">******</span></span>
<span id="cb67-3"><a href="aula7.html#cb67-3" tabindex="-1"></a><span class="fu">set.seed</span>(seed)</span>
<span id="cb67-4"><a href="aula7.html#cb67-4" tabindex="-1"></a><span class="co">#define parameters</span></span>
<span id="cb67-5"><a href="aula7.html#cb67-5" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">50</span>;b0<span class="ot">&lt;-</span><span class="dv">5</span>;b1<span class="ot">&lt;-</span><span class="dv">3</span>;b2<span class="ot">&lt;-</span><span class="sc">-</span><span class="dv">2</span>;error <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb67-6"><a href="aula7.html#cb67-6" tabindex="-1"></a><span class="co">#simulate potential explanatory variables</span></span>
<span id="cb67-7"><a href="aula7.html#cb67-7" tabindex="-1"></a>xs1<span class="ot">=</span><span class="fu">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb67-8"><a href="aula7.html#cb67-8" tabindex="-1"></a>xs2<span class="ot">=</span><span class="fu">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb67-9"><a href="aula7.html#cb67-9" tabindex="-1"></a>xs3<span class="ot">=</span><span class="fu">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb67-10"><a href="aula7.html#cb67-10" tabindex="-1"></a>xs4<span class="ot">=</span><span class="fu">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb67-11"><a href="aula7.html#cb67-11" tabindex="-1"></a><span class="co">#simulate response</span></span>
<span id="cb67-12"><a href="aula7.html#cb67-12" tabindex="-1"></a>ys<span class="ot">=</span>b0<span class="sc">+</span>b1<span class="sc">*</span>xs1<span class="sc">-</span>b2<span class="sc">*</span>xs2<span class="sc">+</span><span class="fu">rnorm</span>(n,<span class="at">sd=</span>error)</span>
<span id="cb67-13"><a href="aula7.html#cb67-13" tabindex="-1"></a><span class="co">#plot data</span></span>
<span id="cb67-14"><a href="aula7.html#cb67-14" tabindex="-1"></a><span class="fu">plot</span>(xs1,ys)</span>
<span id="cb67-15"><a href="aula7.html#cb67-15" tabindex="-1"></a><span class="co">#a model missing a variable, xs2</span></span>
<span id="cb67-16"><a href="aula7.html#cb67-16" tabindex="-1"></a><span class="co">#summary(lm(ys~xs1))</span></span>
<span id="cb67-17"><a href="aula7.html#cb67-17" tabindex="-1"></a><span class="co">#the true model</span></span>
<span id="cb67-18"><a href="aula7.html#cb67-18" tabindex="-1"></a><span class="co">#summary(lm(ys~xs1+xs2))</span></span>
<span id="cb67-19"><a href="aula7.html#cb67-19" tabindex="-1"></a><span class="co">#a model including irrelevant variables</span></span>
<span id="cb67-20"><a href="aula7.html#cb67-20" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(ys<span class="sc">~</span>xs1<span class="sc">+</span>xs2<span class="sc">+</span>xs3<span class="sc">+</span>xs4))</span></code></pre></div>
<p>The first thing to notice is that the model we simulate from only includes <code>xs1</code> and <code>xs2</code>. So, <code>xs3</code> and <code>xs4</code> do not have any impact on the response <code>y</code>. In other words, if we find that <code>xs3</code> and/or <code>xs4</code> are relevant to explain the response we have a type I error, as we have identified an effect where there was none. On the other hand, if we do not find <code>xs1</code> and <code>xs2</code> to be relevant to explain the response, we have a type II error, as we failed to identify a real effect.</p>
<p>So we try different values for the seed and check what happens. Let’s just try <code>seed&lt;-1</code></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="aula7.html#cb68-1" tabindex="-1"></a>seed<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb68-2"><a href="aula7.html#cb68-2" tabindex="-1"></a><span class="fu">set.seed</span>(seed)</span>
<span id="cb68-3"><a href="aula7.html#cb68-3" tabindex="-1"></a><span class="co">#define parameters</span></span>
<span id="cb68-4"><a href="aula7.html#cb68-4" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">50</span>;b0<span class="ot">&lt;-</span><span class="dv">5</span>;b1<span class="ot">&lt;-</span><span class="dv">3</span>;b2<span class="ot">&lt;-</span><span class="sc">-</span><span class="dv">2</span>;error <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb68-5"><a href="aula7.html#cb68-5" tabindex="-1"></a><span class="co">#simulate potential explanatory variables</span></span>
<span id="cb68-6"><a href="aula7.html#cb68-6" tabindex="-1"></a>xs1<span class="ot">=</span><span class="fu">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb68-7"><a href="aula7.html#cb68-7" tabindex="-1"></a>xs2<span class="ot">=</span><span class="fu">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb68-8"><a href="aula7.html#cb68-8" tabindex="-1"></a>xs3<span class="ot">=</span><span class="fu">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb68-9"><a href="aula7.html#cb68-9" tabindex="-1"></a>xs4<span class="ot">=</span><span class="fu">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb68-10"><a href="aula7.html#cb68-10" tabindex="-1"></a><span class="co">#simulate response</span></span>
<span id="cb68-11"><a href="aula7.html#cb68-11" tabindex="-1"></a>ys<span class="ot">=</span>b0<span class="sc">+</span>b1<span class="sc">*</span>xs1<span class="sc">-</span>b2<span class="sc">*</span>xs2<span class="sc">+</span><span class="fu">rnorm</span>(n,<span class="at">sd=</span>error)</span>
<span id="cb68-12"><a href="aula7.html#cb68-12" tabindex="-1"></a><span class="co">#plot data</span></span>
<span id="cb68-13"><a href="aula7.html#cb68-13" tabindex="-1"></a><span class="fu">plot</span>(xs1,ys)</span>
<span id="cb68-14"><a href="aula7.html#cb68-14" tabindex="-1"></a><span class="co">#look at model summary</span></span>
<span id="cb68-15"><a href="aula7.html#cb68-15" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(ys<span class="sc">~</span>xs1<span class="sc">+</span>xs2<span class="sc">+</span>xs3<span class="sc">+</span>xs4))</span></code></pre></div>
<p>All good, no errors. That is, <code>xs1</code> and <code>xs2</code> are considered statistically significant at th 5% level and <code>xs3</code> and <code>xs4</code> are not found relevant to explain the response. Now, we keep changing <code>seed</code></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="aula7.html#cb69-1" tabindex="-1"></a>seed<span class="ot">&lt;-</span><span class="dv">4</span></span>
<span id="cb69-2"><a href="aula7.html#cb69-2" tabindex="-1"></a><span class="fu">set.seed</span>(seed)</span>
<span id="cb69-3"><a href="aula7.html#cb69-3" tabindex="-1"></a><span class="co">#define parameters</span></span>
<span id="cb69-4"><a href="aula7.html#cb69-4" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">50</span>;b0<span class="ot">&lt;-</span><span class="dv">5</span>;b1<span class="ot">&lt;-</span><span class="dv">3</span>;b2<span class="ot">&lt;-</span><span class="sc">-</span><span class="dv">2</span>;error <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb69-5"><a href="aula7.html#cb69-5" tabindex="-1"></a><span class="co">#simulate potential explanatory variables</span></span>
<span id="cb69-6"><a href="aula7.html#cb69-6" tabindex="-1"></a>xs1<span class="ot">=</span><span class="fu">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb69-7"><a href="aula7.html#cb69-7" tabindex="-1"></a>xs2<span class="ot">=</span><span class="fu">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb69-8"><a href="aula7.html#cb69-8" tabindex="-1"></a>xs3<span class="ot">=</span><span class="fu">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb69-9"><a href="aula7.html#cb69-9" tabindex="-1"></a>xs4<span class="ot">=</span><span class="fu">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb69-10"><a href="aula7.html#cb69-10" tabindex="-1"></a><span class="co">#simulate response</span></span>
<span id="cb69-11"><a href="aula7.html#cb69-11" tabindex="-1"></a>ys<span class="ot">=</span>b0<span class="sc">+</span>b1<span class="sc">*</span>xs1<span class="sc">-</span>b2<span class="sc">*</span>xs2<span class="sc">+</span><span class="fu">rnorm</span>(n,<span class="at">sd=</span>error)</span>
<span id="cb69-12"><a href="aula7.html#cb69-12" tabindex="-1"></a><span class="co">#plot data</span></span>
<span id="cb69-13"><a href="aula7.html#cb69-13" tabindex="-1"></a><span class="fu">plot</span>(xs1,ys)</span>
<span id="cb69-14"><a href="aula7.html#cb69-14" tabindex="-1"></a><span class="co">#look at model summary</span></span>
<span id="cb69-15"><a href="aula7.html#cb69-15" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(ys<span class="sc">~</span>xs1<span class="sc">+</span>xs2<span class="sc">+</span>xs3<span class="sc">+</span>xs4))</span></code></pre></div>
<p>We find our first type I error, <code>xs4</code> is found statistically significant, but we know it has no effect on the response. The same happens with <code>seed</code> being e.g. 9, 10. When we try <code>seed &lt;- 11</code> we get another type I error, this time on <code>xs4</code></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="aula7.html#cb70-1" tabindex="-1"></a>seed<span class="ot">&lt;-</span><span class="dv">11</span></span>
<span id="cb70-2"><a href="aula7.html#cb70-2" tabindex="-1"></a><span class="fu">set.seed</span>(seed)</span>
<span id="cb70-3"><a href="aula7.html#cb70-3" tabindex="-1"></a><span class="co">#define parameters</span></span>
<span id="cb70-4"><a href="aula7.html#cb70-4" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">50</span>;b0<span class="ot">&lt;-</span><span class="dv">5</span>;b1<span class="ot">&lt;-</span><span class="dv">3</span>;b2<span class="ot">&lt;-</span><span class="sc">-</span><span class="dv">2</span>;error <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb70-5"><a href="aula7.html#cb70-5" tabindex="-1"></a><span class="co">#simulate potential explanatory variables</span></span>
<span id="cb70-6"><a href="aula7.html#cb70-6" tabindex="-1"></a>xs1<span class="ot">=</span><span class="fu">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb70-7"><a href="aula7.html#cb70-7" tabindex="-1"></a>xs2<span class="ot">=</span><span class="fu">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb70-8"><a href="aula7.html#cb70-8" tabindex="-1"></a>xs3<span class="ot">=</span><span class="fu">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb70-9"><a href="aula7.html#cb70-9" tabindex="-1"></a>xs4<span class="ot">=</span><span class="fu">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb70-10"><a href="aula7.html#cb70-10" tabindex="-1"></a><span class="co">#simulate response</span></span>
<span id="cb70-11"><a href="aula7.html#cb70-11" tabindex="-1"></a>ys<span class="ot">=</span>b0<span class="sc">+</span>b1<span class="sc">*</span>xs1<span class="sc">-</span>b2<span class="sc">*</span>xs2<span class="sc">+</span><span class="fu">rnorm</span>(n,<span class="at">sd=</span>error)</span>
<span id="cb70-12"><a href="aula7.html#cb70-12" tabindex="-1"></a><span class="co">#plot data</span></span>
<span id="cb70-13"><a href="aula7.html#cb70-13" tabindex="-1"></a><span class="fu">plot</span>(xs1,ys)</span></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a7.4-1.png" width="672" /></p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="aula7.html#cb71-1" tabindex="-1"></a><span class="co">#look at model summary</span></span>
<span id="cb71-2"><a href="aula7.html#cb71-2" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(ys<span class="sc">~</span>xs1<span class="sc">+</span>xs2<span class="sc">+</span>xs3<span class="sc">+</span>xs4))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ys ~ xs1 + xs2 + xs3 + xs4)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.3076  -2.7316   0.3072   2.2102   7.9088 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 16.44303    7.42710   2.214   0.0319 *  
## xs1          2.87327    0.21665  13.262  &lt; 2e-16 ***
## xs2          1.93313    0.25274   7.649 1.12e-09 ***
## xs3         -0.47689    0.22325  -2.136   0.0381 *  
## xs4         -0.08922    0.20937  -0.426   0.6720    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.074 on 45 degrees of freedom
## Multiple R-squared:  0.8484, Adjusted R-squared:  0.8349 
## F-statistic: 62.94 on 4 and 45 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>However, even after several runs, we never make a type II error. That must mean this setting has a large power, i.e. the ability to detect a true effect when one exists. Well, there are many ways to decrease power, like having a smaller sample size, increase the error or lower the true effect. Let’s try to increase the error, instead of the 4 used above, let’s pump it up10 fold to 40</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="aula7.html#cb73-1" tabindex="-1"></a>seed<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb73-2"><a href="aula7.html#cb73-2" tabindex="-1"></a><span class="fu">set.seed</span>(seed)</span>
<span id="cb73-3"><a href="aula7.html#cb73-3" tabindex="-1"></a><span class="co">#define parameters</span></span>
<span id="cb73-4"><a href="aula7.html#cb73-4" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">50</span>;b0<span class="ot">&lt;-</span><span class="dv">5</span>;b1<span class="ot">&lt;-</span><span class="dv">3</span>;b2<span class="ot">&lt;-</span><span class="sc">-</span><span class="dv">2</span>;error <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb73-5"><a href="aula7.html#cb73-5" tabindex="-1"></a><span class="co">#simulate potential explanatory variables</span></span>
<span id="cb73-6"><a href="aula7.html#cb73-6" tabindex="-1"></a>xs1<span class="ot">=</span><span class="fu">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb73-7"><a href="aula7.html#cb73-7" tabindex="-1"></a>xs2<span class="ot">=</span><span class="fu">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb73-8"><a href="aula7.html#cb73-8" tabindex="-1"></a>xs3<span class="ot">=</span><span class="fu">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb73-9"><a href="aula7.html#cb73-9" tabindex="-1"></a>xs4<span class="ot">=</span><span class="fu">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb73-10"><a href="aula7.html#cb73-10" tabindex="-1"></a><span class="co">#simulate response</span></span>
<span id="cb73-11"><a href="aula7.html#cb73-11" tabindex="-1"></a>ys<span class="ot">=</span>b0<span class="sc">+</span>b1<span class="sc">*</span>xs1<span class="sc">-</span>b2<span class="sc">*</span>xs2<span class="sc">+</span><span class="fu">rnorm</span>(n,<span class="at">sd=</span>error)</span>
<span id="cb73-12"><a href="aula7.html#cb73-12" tabindex="-1"></a><span class="co">#plot data</span></span>
<span id="cb73-13"><a href="aula7.html#cb73-13" tabindex="-1"></a><span class="fu">plot</span>(xs1,ys)</span></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a7.5-1.png" width="672" /></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="aula7.html#cb74-1" tabindex="-1"></a><span class="co">#look at model summary</span></span>
<span id="cb74-2"><a href="aula7.html#cb74-2" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(ys<span class="sc">~</span>xs1<span class="sc">+</span>xs2<span class="sc">+</span>xs3<span class="sc">+</span>xs4))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ys ~ xs1 + xs2 + xs3 + xs4)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -73.25 -17.86  -6.76  21.25  68.42 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)  22.8661    41.3133   0.553    0.583
## xs1           1.6034     1.8564   0.864    0.392
## xs2           0.9163     1.8092   0.506    0.615
## xs3           1.9650     1.6038   1.225    0.227
## xs4          -0.8544     1.7449  -0.490    0.627
## 
## Residual standard error: 32.4 on 45 degrees of freedom
## Multiple R-squared:  0.06896,    Adjusted R-squared:  -0.0138 
## F-statistic: 0.8333 on 4 and 45 DF,  p-value: 0.5112</code></pre>
<p>That was an overkill, now there is so much noise must seeds we use do not allow us to find an effect, let’s cut that in half to 20</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="aula7.html#cb76-1" tabindex="-1"></a>seed<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb76-2"><a href="aula7.html#cb76-2" tabindex="-1"></a><span class="fu">set.seed</span>(seed)</span>
<span id="cb76-3"><a href="aula7.html#cb76-3" tabindex="-1"></a><span class="co">#define parameters</span></span>
<span id="cb76-4"><a href="aula7.html#cb76-4" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">50</span>;b0<span class="ot">&lt;-</span><span class="dv">5</span>;b1<span class="ot">&lt;-</span><span class="dv">3</span>;b2<span class="ot">&lt;-</span><span class="sc">-</span><span class="dv">2</span>;error <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb76-5"><a href="aula7.html#cb76-5" tabindex="-1"></a><span class="co">#simulate potential explanatory variables</span></span>
<span id="cb76-6"><a href="aula7.html#cb76-6" tabindex="-1"></a>xs1<span class="ot">=</span><span class="fu">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb76-7"><a href="aula7.html#cb76-7" tabindex="-1"></a>xs2<span class="ot">=</span><span class="fu">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb76-8"><a href="aula7.html#cb76-8" tabindex="-1"></a>xs3<span class="ot">=</span><span class="fu">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb76-9"><a href="aula7.html#cb76-9" tabindex="-1"></a>xs4<span class="ot">=</span><span class="fu">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb76-10"><a href="aula7.html#cb76-10" tabindex="-1"></a><span class="co">#simulate response</span></span>
<span id="cb76-11"><a href="aula7.html#cb76-11" tabindex="-1"></a>ys<span class="ot">=</span>b0<span class="sc">+</span>b1<span class="sc">*</span>xs1<span class="sc">-</span>b2<span class="sc">*</span>xs2<span class="sc">+</span><span class="fu">rnorm</span>(n,<span class="at">sd=</span>error)</span>
<span id="cb76-12"><a href="aula7.html#cb76-12" tabindex="-1"></a><span class="co">#plot data</span></span>
<span id="cb76-13"><a href="aula7.html#cb76-13" tabindex="-1"></a><span class="fu">plot</span>(xs1,ys)</span></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a7.6-1.png" width="672" /></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="aula7.html#cb77-1" tabindex="-1"></a><span class="co">#look at model summary</span></span>
<span id="cb77-2"><a href="aula7.html#cb77-2" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(ys<span class="sc">~</span>xs1<span class="sc">+</span>xs2<span class="sc">+</span>xs3<span class="sc">+</span>xs4))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ys ~ xs1 + xs2 + xs3 + xs4)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -36.624  -8.927  -3.380  10.623  34.211 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  13.9330    20.6566   0.675    0.503  
## xs1           2.3017     0.9282   2.480    0.017 *
## xs2           1.4582     0.9046   1.612    0.114  
## xs3           0.9825     0.8019   1.225    0.227  
## xs4          -0.4272     0.8724  -0.490    0.627  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 16.2 on 45 degrees of freedom
## Multiple R-squared:  0.2262, Adjusted R-squared:  0.1574 
## F-statistic: 3.288 on 4 and 45 DF,  p-value: 0.01901</code></pre>
<p>back to all correct. Now, let’s change seed again</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="aula7.html#cb79-1" tabindex="-1"></a>seed<span class="ot">&lt;-</span><span class="dv">103</span></span>
<span id="cb79-2"><a href="aula7.html#cb79-2" tabindex="-1"></a><span class="fu">set.seed</span>(seed)</span>
<span id="cb79-3"><a href="aula7.html#cb79-3" tabindex="-1"></a><span class="co">#define parameters</span></span>
<span id="cb79-4"><a href="aula7.html#cb79-4" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">50</span>;b0<span class="ot">&lt;-</span><span class="dv">5</span>;b1<span class="ot">&lt;-</span><span class="dv">3</span>;b2<span class="ot">&lt;-</span><span class="sc">-</span><span class="dv">2</span>;error <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb79-5"><a href="aula7.html#cb79-5" tabindex="-1"></a><span class="co">#simulate potential explanatory variables</span></span>
<span id="cb79-6"><a href="aula7.html#cb79-6" tabindex="-1"></a>xs1<span class="ot">=</span><span class="fu">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb79-7"><a href="aula7.html#cb79-7" tabindex="-1"></a>xs2<span class="ot">=</span><span class="fu">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb79-8"><a href="aula7.html#cb79-8" tabindex="-1"></a>xs3<span class="ot">=</span><span class="fu">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb79-9"><a href="aula7.html#cb79-9" tabindex="-1"></a>xs4<span class="ot">=</span><span class="fu">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb79-10"><a href="aula7.html#cb79-10" tabindex="-1"></a><span class="co">#simulate response</span></span>
<span id="cb79-11"><a href="aula7.html#cb79-11" tabindex="-1"></a>ys<span class="ot">=</span>b0<span class="sc">+</span>b1<span class="sc">*</span>xs1<span class="sc">-</span>b2<span class="sc">*</span>xs2<span class="sc">+</span><span class="fu">rnorm</span>(n,<span class="at">sd=</span>error)</span>
<span id="cb79-12"><a href="aula7.html#cb79-12" tabindex="-1"></a><span class="co">#plot data</span></span>
<span id="cb79-13"><a href="aula7.html#cb79-13" tabindex="-1"></a><span class="fu">plot</span>(xs1,ys)</span></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a7.7-1.png" width="672" /></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="aula7.html#cb80-1" tabindex="-1"></a><span class="co">#look at model summary</span></span>
<span id="cb80-2"><a href="aula7.html#cb80-2" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(ys<span class="sc">~</span>xs1<span class="sc">+</span>xs2<span class="sc">+</span>xs3<span class="sc">+</span>xs4))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ys ~ xs1 + xs2 + xs3 + xs4)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -36.079 -10.686  -0.148  16.413  33.845 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  9.70575   33.83339   0.287   0.7755  
## xs1          2.32559    0.93980   2.475   0.0172 *
## xs2          1.97688    1.20464   1.641   0.1078  
## xs3          0.69013    1.02110   0.676   0.5026  
## xs4          0.08031    0.97427   0.082   0.9347  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 19.6 on 45 degrees of freedom
## Multiple R-squared:  0.1524, Adjusted R-squared:  0.07706 
## F-statistic: 2.023 on 4 and 45 DF,  p-value: 0.1073</code></pre>
<p>Bang on, a type II error, as <code>xs2</code> is no longer considered statistically significant. I am sure you can now play with the relevant model parameters, <code>b1</code>, <code>b2</code>, to incleare and decreese the actual effect, and with sample size <code>n</code> or as above with the <code>error</code> and explore the consequences of changing the balance in effect size, error and sample size on the ability of incurring in errors when doing regression. But remmeber the key, the reason we are able to see if an error is made or not is because we simulated reality. In this case, as it is never the case in an ecological dataset, we know the true model, which was</p>
<p><span class="math display">\[y=\beta_0+\beta_1 xs_1+\beta_2 xs2\]</span></p>
<p>That is the luxury of simulation, allowing you to test scenarios where “reality” is known, hence evaluating methods performance.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="aula7.html#cb82-1" tabindex="-1"></a>folder<span class="ot">&lt;-</span><span class="st">&quot;extfiles/&quot;</span></span>
<span id="cb82-2"><a href="aula7.html#cb82-2" tabindex="-1"></a><span class="co">#folder&lt;-&quot;../Aula7 14 10 2020/&quot;</span></span>
<span id="cb82-3"><a href="aula7.html#cb82-3" tabindex="-1"></a>d4l <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file=</span><span class="fu">paste0</span>(folder,<span class="st">&quot;data4lines.csv&quot;</span>))</span>
<span id="cb82-4"><a href="aula7.html#cb82-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(d4l)</span></code></pre></div>
</div>
<div id="task-2" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Task 2<a href="aula7.html#task-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The second task the students were faced was to create some regression data and the explore fitting models to it.</p>
<p><img src="extfiles/Aula7Task7.JPG" /></p>
<p>The data was simulated via this website: <a href="https://drawdata.xyz/" class="uri">https://drawdata.xyz/</a> and was named <code>data4lines.csv</code>. Each student had its own dataset, here I work with my example.</p>
<p>We begin by reading the data in and plot it</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="aula7.html#cb83-1" tabindex="-1"></a><span class="co">#read the data</span></span>
<span id="cb83-2"><a href="aula7.html#cb83-2" tabindex="-1"></a>folder<span class="ot">&lt;-</span><span class="st">&quot;extfiles/&quot;</span></span>
<span id="cb83-3"><a href="aula7.html#cb83-3" tabindex="-1"></a>data4lines <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file=</span><span class="fu">paste0</span>(folder,<span class="st">&quot;data4lines.csv&quot;</span>))</span>
<span id="cb83-4"><a href="aula7.html#cb83-4" tabindex="-1"></a><span class="co">#plot all the data</span></span>
<span id="cb83-5"><a href="aula7.html#cb83-5" tabindex="-1"></a><span class="fu">plot</span>(y<span class="sc">~</span>x,<span class="at">data=</span>data4lines)</span></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a7.9-1.png" width="672" /></p>
<p>Now, to turn this a bit more interesting, we come up with a narrative.</p>
<p>These correspond to observations from weights and lengths of a sample of animals, fish from the species <em>Fishus inventadicus</em>. We could fit a regression line to this data and see if we can predict weight from length</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="aula7.html#cb84-1" tabindex="-1"></a><span class="co">#plot all the data</span></span>
<span id="cb84-2"><a href="aula7.html#cb84-2" tabindex="-1"></a><span class="fu">plot</span>(y<span class="sc">~</span>x,<span class="at">data=</span>data4lines)</span>
<span id="cb84-3"><a href="aula7.html#cb84-3" tabindex="-1"></a><span class="co">#fit model to pooled data</span></span>
<span id="cb84-4"><a href="aula7.html#cb84-4" tabindex="-1"></a>lmlinesG<span class="ot">&lt;-</span><span class="fu">lm</span>(y<span class="sc">~</span>x,<span class="at">data=</span>data4lines)</span>
<span id="cb84-5"><a href="aula7.html#cb84-5" tabindex="-1"></a><span class="fu">abline</span>(lmlinesG,<span class="at">lwd=</span><span class="dv">3</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a7.10-1.png" width="672" /></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="aula7.html#cb85-1" tabindex="-1"></a><span class="fu">summary</span>(lmlinesG)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x, data = data4lines)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -134.304  -44.188   -1.995   29.432  148.202 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 107.17590   14.03069   7.639 3.51e-12 ***
## x             0.35513    0.03553   9.995  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 61.78 on 136 degrees of freedom
## Multiple R-squared:  0.4235, Adjusted R-squared:  0.4193 
## F-statistic: 99.91 on 1 and 136 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>and it looks like we can indeed predict the weight of the species from its length. The length is highly statistically significant. Not surprisingly, the longer the fish the heavier it is.</p>
<p>Now, the plot thickens. These animals actually came from 4 different museums, and are assumed to be the same species. However, a scientist decides to look at whether there are differences in the data from the 4 museums. So he colors the data by museum</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="aula7.html#cb87-1" tabindex="-1"></a><span class="co">#plot all the data</span></span>
<span id="cb87-2"><a href="aula7.html#cb87-2" tabindex="-1"></a><span class="fu">plot</span>(y<span class="sc">~</span>x,<span class="at">col=</span><span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(z)),<span class="at">data=</span>data4lines,<span class="at">pch=</span><span class="dv">1</span>)</span>
<span id="cb87-3"><a href="aula7.html#cb87-3" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="at">inset=</span><span class="fl">0.05</span>,<span class="at">legend=</span>letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">pch=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a7.11-1.png" width="672" /></p>
<p>We see a pattern in the data, the data from the different museums tend to cluster. He decides to investigate. Note folks providing names to museum in this country are a bit boring, and the museums are called “a”, “b”, “c” and “d”.</p>
<p>Our smart researcher says: “well, it seems like the relationship might be different in each museum”. Then, maybe I should fit a model that includes museum as a covariate <code>weight~length+museum</code>.</p>
<p><span class="math display">\[y=\beta_0+\beta_1 \times length +\beta_2 \times museum\]</span></p>
<p>And so he does and plots it</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="aula7.html#cb88-1" tabindex="-1"></a><span class="co">#fit model per group</span></span>
<span id="cb88-2"><a href="aula7.html#cb88-2" tabindex="-1"></a>lmlines<span class="ot">&lt;-</span><span class="fu">lm</span>(y<span class="sc">~</span>x<span class="sc">+</span>z,<span class="at">data=</span>data4lines)</span>
<span id="cb88-3"><a href="aula7.html#cb88-3" tabindex="-1"></a><span class="fu">summary</span>(lmlines)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + z, data = data4lines)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -90.01 -35.01   2.54  35.51 108.10 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  45.51813   13.83069   3.291  0.00128 ** 
## x             0.39657    0.02516  15.763  &lt; 2e-16 ***
## zb           54.92376   12.11597   4.533 1.28e-05 ***
## zc          128.20339   11.72572  10.934  &lt; 2e-16 ***
## zd           22.82412   10.26509   2.223  0.02787 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 42.5 on 133 degrees of freedom
## Multiple R-squared:  0.7332, Adjusted R-squared:  0.7252 
## F-statistic: 91.38 on 4 and 133 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The output shows that the length is relevant, but the museum is relevant too. The relationship might be different per museum! In the output we see the <code>x</code>, the length, but not the <code>z</code>, it has been transformed into <code>zb</code>, <code>zc</code> and <code>zd</code>. Why is that? That is a mystery that we shall unfold now!</p>
<p>While the model we are fitting might be represented by <code>weight~length+museum</code>, the design matrix being fitted replaces the <code>museum</code> (a factor with 4 levels) with 3 dummy variables (a factor with k levels required k-1 dummy variables). So the real model being fitted is really</p>
<p><span class="math display">\[y=\beta_0+\beta_1 \times length + \beta_{2b} \times zb + \beta_{2c} \times zc + \beta_{2d} \times zd\]</span></p>
<p>Wait, but where is the level <code>a</code>? It is in the intercept, and if I had an euro for each time that confused a student, I would not be here but in a beach in the Bahamas having a piña colada :)</p>
<p>But let’s unfold the mistery, shall we? By default, R takes 1 level of (each/a) factor and uses it as the intercept. Here it used <code>a</code> (the choice is in this case by alphabetical ored, but one can change that, which might be useful if e.g. you want to have as the intercept a control level, say; look e.g. into function <code>factor</code> help to see how you can change the baseline <code>level</code> of a factor).</p>
<p>Hence, the intercept for museum <code>a</code> is 45.5181335. What about the intercep of the othe rmuseums? They are always reported with <code>a</code> as the reference. Look at the equation above, what happens when say zc is 1 and zd and zb are 0, it becomes</p>
<p><span class="math display">\[y=\beta_0+\beta_1 \times length + \beta_{2c} \times zc \]</span>
<span class="math display">\[y=(\beta_0+\beta_{2c})+\beta_1 \times length = intercep + slope \times length\]</span></p>
<p>and so, from the above output, that equates to <code>y=lmlines$coefficients[1]+lmlines$coefficients[4],lmlines$coefficients[2]</code> or 173.7215247+0.3965715 <span class="math inline">\(\times\)</span> <code>length</code>.</p>
<p>So now we can add all these estimated regression lines to the plot</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="aula7.html#cb90-1" tabindex="-1"></a><span class="co">#plot all</span></span>
<span id="cb90-2"><a href="aula7.html#cb90-2" tabindex="-1"></a><span class="fu">plot</span>(y<span class="sc">~</span>x,<span class="at">col=</span><span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(z)),<span class="at">data=</span>data4lines)</span>
<span id="cb90-3"><a href="aula7.html#cb90-3" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="at">inset=</span><span class="fl">0.05</span>,<span class="at">legend=</span><span class="fu">c</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],<span class="st">&quot;all&quot;</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">1</span>),<span class="at">lty=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">4</span>),<span class="dv">2</span>),<span class="at">lwd=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">4</span>),<span class="dv">3</span>))</span>
<span id="cb90-4"><a href="aula7.html#cb90-4" tabindex="-1"></a><span class="co">#these are the wrong lines... why?</span></span>
<span id="cb90-5"><a href="aula7.html#cb90-5" tabindex="-1"></a><span class="fu">abline</span>(lmlinesG,<span class="at">lwd=</span><span class="dv">3</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb90-6"><a href="aula7.html#cb90-6" tabindex="-1"></a><span class="fu">abline</span>(lmlines<span class="sc">$</span>coefficients[<span class="dv">1</span>],lmlines<span class="sc">$</span>coefficients[<span class="dv">2</span>],<span class="at">col=</span><span class="dv">1</span>)</span>
<span id="cb90-7"><a href="aula7.html#cb90-7" tabindex="-1"></a><span class="fu">abline</span>(lmlines<span class="sc">$</span>coefficients[<span class="dv">1</span>]<span class="sc">+</span>lmlines<span class="sc">$</span>coefficients[<span class="dv">3</span>],lmlines<span class="sc">$</span>coefficients[<span class="dv">2</span>],<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb90-8"><a href="aula7.html#cb90-8" tabindex="-1"></a><span class="fu">abline</span>(lmlines<span class="sc">$</span>coefficients[<span class="dv">1</span>]<span class="sc">+</span>lmlines<span class="sc">$</span>coefficients[<span class="dv">4</span>],lmlines<span class="sc">$</span>coefficients[<span class="dv">2</span>],<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb90-9"><a href="aula7.html#cb90-9" tabindex="-1"></a><span class="fu">abline</span>(lmlines<span class="sc">$</span>coefficients[<span class="dv">1</span>]<span class="sc">+</span>lmlines<span class="sc">$</span>coefficients[<span class="dv">5</span>],lmlines<span class="sc">$</span>coefficients[<span class="dv">2</span>],<span class="at">col=</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a7.13-1.png" width="672" /></p>
<p>note that, not surprisingly, all these lines have the same slope. Or in other words, the model we considered assumes that the slope of the model is the same across museums (which, remember, we know if not true!). We can easily check that the intercepts (i.e. where the lines cross when length=x=0) of all lines are indeed easy to get from the model’s output</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="aula7.html#cb91-1" tabindex="-1"></a><span class="co">#plot all</span></span>
<span id="cb91-2"><a href="aula7.html#cb91-2" tabindex="-1"></a><span class="fu">plot</span>(y<span class="sc">~</span>x,<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">700</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">450</span>),<span class="at">col=</span><span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(z)),<span class="at">data=</span>data4lines)</span>
<span id="cb91-3"><a href="aula7.html#cb91-3" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="at">inset=</span><span class="fl">0.05</span>,<span class="at">legend=</span><span class="fu">c</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],<span class="st">&quot;all&quot;</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">1</span>),<span class="at">lty=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">4</span>),<span class="dv">2</span>),<span class="at">lwd=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">4</span>),<span class="dv">3</span>))</span>
<span id="cb91-4"><a href="aula7.html#cb91-4" tabindex="-1"></a><span class="co">#these are the wrong lines... why?</span></span>
<span id="cb91-5"><a href="aula7.html#cb91-5" tabindex="-1"></a><span class="fu">abline</span>(lmlinesG,<span class="at">lwd=</span><span class="dv">3</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb91-6"><a href="aula7.html#cb91-6" tabindex="-1"></a><span class="fu">abline</span>(lmlines<span class="sc">$</span>coefficients[<span class="dv">1</span>],lmlines<span class="sc">$</span>coefficients[<span class="dv">2</span>],<span class="at">col=</span><span class="dv">1</span>)</span>
<span id="cb91-7"><a href="aula7.html#cb91-7" tabindex="-1"></a><span class="fu">abline</span>(lmlines<span class="sc">$</span>coefficients[<span class="dv">1</span>]<span class="sc">+</span>lmlines<span class="sc">$</span>coefficients[<span class="dv">3</span>],lmlines<span class="sc">$</span>coefficients[<span class="dv">2</span>],<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb91-8"><a href="aula7.html#cb91-8" tabindex="-1"></a><span class="fu">abline</span>(lmlines<span class="sc">$</span>coefficients[<span class="dv">1</span>]<span class="sc">+</span>lmlines<span class="sc">$</span>coefficients[<span class="dv">4</span>],lmlines<span class="sc">$</span>coefficients[<span class="dv">2</span>],<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb91-9"><a href="aula7.html#cb91-9" tabindex="-1"></a><span class="fu">abline</span>(lmlines<span class="sc">$</span>coefficients[<span class="dv">1</span>]<span class="sc">+</span>lmlines<span class="sc">$</span>coefficients[<span class="dv">5</span>],lmlines<span class="sc">$</span>coefficients[<span class="dv">2</span>],<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb91-10"><a href="aula7.html#cb91-10" tabindex="-1"></a></span>
<span id="cb91-11"><a href="aula7.html#cb91-11" tabindex="-1"></a></span>
<span id="cb91-12"><a href="aula7.html#cb91-12" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb91-13"><a href="aula7.html#cb91-13" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">45.51813</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">1</span>)</span>
<span id="cb91-14"><a href="aula7.html#cb91-14" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">45.51813+54.92376</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb91-15"><a href="aula7.html#cb91-15" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">45.51813+128.20339</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb91-16"><a href="aula7.html#cb91-16" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">45.51813+22.82412</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a7.14-1.png" width="672" /></p>
<p>Now, the smart biologist then says that he could also fit a separate line to each museum’s data. And so he does, and that looks like this:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="aula7.html#cb92-1" tabindex="-1"></a><span class="co">#plot all the data</span></span>
<span id="cb92-2"><a href="aula7.html#cb92-2" tabindex="-1"></a><span class="fu">plot</span>(y<span class="sc">~</span>x,<span class="at">col=</span><span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(z)),<span class="at">data=</span>data4lines,<span class="at">pch=</span><span class="dv">1</span>)</span>
<span id="cb92-3"><a href="aula7.html#cb92-3" tabindex="-1"></a><span class="co">#completely independet regression lines</span></span>
<span id="cb92-4"><a href="aula7.html#cb92-4" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y<span class="sc">~</span>x,<span class="at">data=</span>data4lines[data4lines<span class="sc">$</span>z<span class="sc">==</span><span class="st">&quot;a&quot;</span>,]),<span class="at">col=</span><span class="dv">1</span>,<span class="at">lty=</span><span class="dv">4</span>)</span>
<span id="cb92-5"><a href="aula7.html#cb92-5" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y<span class="sc">~</span>x,<span class="at">data=</span>data4lines[data4lines<span class="sc">$</span>z<span class="sc">==</span><span class="st">&quot;b&quot;</span>,]),<span class="at">col=</span><span class="dv">2</span>,<span class="at">lty=</span><span class="dv">4</span>)</span>
<span id="cb92-6"><a href="aula7.html#cb92-6" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y<span class="sc">~</span>x,<span class="at">data=</span>data4lines[data4lines<span class="sc">$</span>z<span class="sc">==</span><span class="st">&quot;c&quot;</span>,]),<span class="at">col=</span><span class="dv">3</span>,<span class="at">lty=</span><span class="dv">4</span>)</span>
<span id="cb92-7"><a href="aula7.html#cb92-7" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y<span class="sc">~</span>x,<span class="at">data=</span>data4lines[data4lines<span class="sc">$</span>z<span class="sc">==</span><span class="st">&quot;d&quot;</span>,]),<span class="at">col=</span><span class="dv">4</span>,<span class="at">lty=</span><span class="dv">4</span>)</span>
<span id="cb92-8"><a href="aula7.html#cb92-8" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="at">inset=</span><span class="fl">0.05</span>,<span class="at">legend=</span>letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">pch=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a7.15-1.png" width="672" /></p>
<p>Naturally, now the lines do not have the same slope, and we can compare all these in a single plot. This plot is really messy, as it includes the pooled regression (the thick black line), the regressions fitted to independent data sets, one for each museum (the solid lines), and the regressions resulting from the model with museum as a factor covariate (dotted-dashed lines).</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="aula7.html#cb93-1" tabindex="-1"></a><span class="co">#plot all the data</span></span>
<span id="cb93-2"><a href="aula7.html#cb93-2" tabindex="-1"></a><span class="fu">plot</span>(y<span class="sc">~</span>x,<span class="at">col=</span><span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(z)),<span class="at">data=</span>data4lines,<span class="at">pch=</span><span class="dv">1</span>)</span>
<span id="cb93-3"><a href="aula7.html#cb93-3" tabindex="-1"></a><span class="co">#completely independet regression lines</span></span>
<span id="cb93-4"><a href="aula7.html#cb93-4" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y<span class="sc">~</span>x,<span class="at">data=</span>data4lines[data4lines<span class="sc">$</span>z<span class="sc">==</span><span class="st">&quot;a&quot;</span>,]),<span class="at">col=</span><span class="dv">1</span>,<span class="at">lty=</span><span class="dv">4</span>)</span>
<span id="cb93-5"><a href="aula7.html#cb93-5" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y<span class="sc">~</span>x,<span class="at">data=</span>data4lines[data4lines<span class="sc">$</span>z<span class="sc">==</span><span class="st">&quot;b&quot;</span>,]),<span class="at">col=</span><span class="dv">2</span>,<span class="at">lty=</span><span class="dv">4</span>)</span>
<span id="cb93-6"><a href="aula7.html#cb93-6" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y<span class="sc">~</span>x,<span class="at">data=</span>data4lines[data4lines<span class="sc">$</span>z<span class="sc">==</span><span class="st">&quot;c&quot;</span>,]),<span class="at">col=</span><span class="dv">3</span>,<span class="at">lty=</span><span class="dv">4</span>)</span>
<span id="cb93-7"><a href="aula7.html#cb93-7" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y<span class="sc">~</span>x,<span class="at">data=</span>data4lines[data4lines<span class="sc">$</span>z<span class="sc">==</span><span class="st">&quot;d&quot;</span>,]),<span class="at">col=</span><span class="dv">4</span>,<span class="at">lty=</span><span class="dv">4</span>)</span>
<span id="cb93-8"><a href="aula7.html#cb93-8" tabindex="-1"></a><span class="co">#these are the wrong lines... why?</span></span>
<span id="cb93-9"><a href="aula7.html#cb93-9" tabindex="-1"></a><span class="fu">abline</span>(lmlinesG,<span class="at">lwd=</span><span class="dv">3</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb93-10"><a href="aula7.html#cb93-10" tabindex="-1"></a><span class="fu">abline</span>(lmlines<span class="sc">$</span>coefficients[<span class="dv">1</span>],lmlines<span class="sc">$</span>coefficients[<span class="dv">2</span>],<span class="at">col=</span><span class="dv">1</span>)</span>
<span id="cb93-11"><a href="aula7.html#cb93-11" tabindex="-1"></a><span class="fu">abline</span>(lmlines<span class="sc">$</span>coefficients[<span class="dv">1</span>]<span class="sc">+</span>lmlines<span class="sc">$</span>coefficients[<span class="dv">3</span>],lmlines<span class="sc">$</span>coefficients[<span class="dv">2</span>],<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb93-12"><a href="aula7.html#cb93-12" tabindex="-1"></a><span class="fu">abline</span>(lmlines<span class="sc">$</span>coefficients[<span class="dv">1</span>]<span class="sc">+</span>lmlines<span class="sc">$</span>coefficients[<span class="dv">4</span>],lmlines<span class="sc">$</span>coefficients[<span class="dv">2</span>],<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb93-13"><a href="aula7.html#cb93-13" tabindex="-1"></a><span class="fu">abline</span>(lmlines<span class="sc">$</span>coefficients[<span class="dv">1</span>]<span class="sc">+</span>lmlines<span class="sc">$</span>coefficients[<span class="dv">5</span>],lmlines<span class="sc">$</span>coefficients[<span class="dv">2</span>],<span class="at">col=</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a7.16-1.png" width="672" /></p>
<p>But what is the best model to describe the data? That is a mistery that will remain to unfold. For that we will need and additional complication in a regression model: interactions.</p>
<p>But note 1 thing to begin with. The pooled model uses just 2 parameters, one slope and one intercept. The independent lines use 8 parameters, 4 slopes and 4 intercepts, one line for each museum. And the single model with <code>lenght</code> and <code>museum</code> uses 5 parameters, the intercept, the slope for <code>length</code>, and 3 parameters associated with the <span class="math inline">\(k-1=3\)</span> levels of <code>museum</code> (remember, one level of each factor is absorbed by the regression intercept).</p>
<p>So the choice of what is best might be not straightforward. While we created the data by hand, we do not know the true model! Choosing the best model requires choosing between models with different complexity, i.e. different number of parameters. We will need a parsimonious model, one that describes the data well, but with a number of parameters that is not too high for the available data. That will also require selection criteria.</p>
<p>Stay tuned for the next episodes on our regression saga!</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="RIO.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="aula8.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ECOMODbook.pdf", "ECOMODbook.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
