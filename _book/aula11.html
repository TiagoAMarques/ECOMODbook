<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Class 11: 03 11 2020 ANCOVA with different slopes: interactions | Notes for Ecological Modelling</title>
  <meta name="description" content="This is based on Yihui Xie’s a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Class 11: 03 11 2020 ANCOVA with different slopes: interactions | Notes for Ecological Modelling" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is based on Yihui Xie’s a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Class 11: 03 11 2020 ANCOVA with different slopes: interactions | Notes for Ecological Modelling" />
  
  <meta name="twitter:description" content="This is based on Yihui Xie’s a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Tiago A. Marques" />


<meta name="date" content="2020-11-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="aula10.html"/>
<link rel="next" href="aula13.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="about-regression.html"><a href="about-regression.html"><i class="fa fa-check"></i><b>2</b> About regression</a><ul>
<li class="chapter" data-level="2.1" data-path="about-regression.html"><a href="about-regression.html#what-is-a-regression"><i class="fa fa-check"></i><b>2.1</b> What is a regression?</a></li>
<li class="chapter" data-level="2.2" data-path="about-regression.html"><a href="about-regression.html#the-general-linear-model"><i class="fa fa-check"></i><b>2.2</b> The general linear model</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="handson.html"><a href="handson.html"><i class="fa fa-check"></i><b>3</b> Hands On Regression</a><ul>
<li class="chapter" data-level="3.1" data-path="handson.html"><a href="handson.html#the-assumptions-are-on-the-residuals-not-the-data"><i class="fa fa-check"></i><b>3.1</b> The assumptions are on the residuals, not the data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="aula6.html"><a href="aula6.html"><i class="fa fa-check"></i><b>4</b> Class 6 13 10 2020</a><ul>
<li class="chapter" data-level="4.1" data-path="aula6.html"><a href="aula6.html#implementing-a-regression"><i class="fa fa-check"></i><b>4.1</b> Implementing a regression</a></li>
<li class="chapter" data-level="4.2" data-path="aula6.html"><a href="aula6.html#simulating-regression-data"><i class="fa fa-check"></i><b>4.2</b> Simulating regression data</a><ul>
<li class="chapter" data-level="4.2.1" data-path="aula6.html"><a href="aula6.html#what-is-the-effect-of-increasing-the-error-a-simulation-experiment"><i class="fa fa-check"></i><b>4.2.1</b> What is the effect of increasing the error: a simulation experiment</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="aula7.html"><a href="aula7.html"><i class="fa fa-check"></i><b>5</b> Class 7 14 10 2020</a><ul>
<li class="chapter" data-level="5.1" data-path="aula7.html"><a href="aula7.html#task-1"><i class="fa fa-check"></i><b>5.1</b> Task 1</a></li>
<li class="chapter" data-level="5.2" data-path="aula7.html"><a href="aula7.html#task-2"><i class="fa fa-check"></i><b>5.2</b> Task 2</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="aula8.html"><a href="aula8.html"><i class="fa fa-check"></i><b>6</b> Class 8 20 10 2020 - t-test and ANOVA are just linear models</a><ul>
<li class="chapter" data-level="6.1" data-path="aula8.html"><a href="aula8.html#the-t-test"><i class="fa fa-check"></i><b>6.1</b> The t-test</a></li>
<li class="chapter" data-level="6.2" data-path="aula8.html"><a href="aula8.html#anova"><i class="fa fa-check"></i><b>6.2</b> ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="aula9.html"><a href="aula9.html"><i class="fa fa-check"></i><b>7</b> Class 9: 21 10 2020 - ANCOVA is (also) just a linear model</a><ul>
<li class="chapter" data-level="7.1" data-path="aula9.html"><a href="aula9.html#common-slope-different-intercepts-per-treatment"><i class="fa fa-check"></i><b>7.1</b> Common slope, different intercepts per treatment</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="aula10.html"><a href="aula10.html"><i class="fa fa-check"></i><b>8</b> Class 10: 27 10 2020</a><ul>
<li class="chapter" data-level="8.1" data-path="aula10.html"><a href="aula10.html#same-story-another-spin"><i class="fa fa-check"></i><b>8.1</b> Same story, another spin</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="aula11.html"><a href="aula11.html"><i class="fa fa-check"></i><b>9</b> Class 11: 03 11 2020 ANCOVA with different slopes: interactions</a><ul>
<li class="chapter" data-level="9.1" data-path="aula11.html"><a href="aula11.html#about-interactions"><i class="fa fa-check"></i><b>9.1</b> About interactions</a></li>
<li class="chapter" data-level="9.2" data-path="aula11.html"><a href="aula11.html#task-1-implementing-the-ancova-with-different-slopes"><i class="fa fa-check"></i><b>9.2</b> Task 1 Implementing the ANCOVA with different slopes</a></li>
<li class="chapter" data-level="9.3" data-path="aula11.html"><a href="aula11.html#task-2-modeling-a-data-set"><i class="fa fa-check"></i><b>9.3</b> Task 2 Modeling a data set</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="aula13.html"><a href="aula13.html"><i class="fa fa-check"></i><b>10</b> Class 12: 04 11 2020 Interactions between continous covariates</a></li>
<li class="chapter" data-level="11" data-path="conlusion-on-linear-regression.html"><a href="conlusion-on-linear-regression.html"><i class="fa fa-check"></i><b>11</b> Conlusion on linear regression</a><ul>
<li class="chapter" data-level="11.1" data-path="conlusion-on-linear-regression.html"><a href="conlusion-on-linear-regression.html#conclusion"><i class="fa fa-check"></i><b>11.1</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="aula12.html"><a href="aula12.html"><i class="fa fa-check"></i><b>12</b> Class 12: 04 11 2020 Maximum likelihood and all that</a></li>
<li class="chapter" data-level="13" data-path="aula13a.html"><a href="aula13a.html"><i class="fa fa-check"></i><b>13</b> Class 13a: 4 11 2020 Maximum likelihood and all that</a></li>
<li class="chapter" data-level="14" data-path="aula14.html"><a href="aula14.html"><i class="fa fa-check"></i><b>14</b> Class 14: 10 10 2020</a></li>
<li class="chapter" data-level="15" data-path="aula15.html"><a href="aula15.html"><i class="fa fa-check"></i><b>15</b> Class 15: 11 11 2020</a></li>
<li class="chapter" data-level="16" data-path="aula16.html"><a href="aula16.html"><i class="fa fa-check"></i><b>16</b> Class 16: 17 11 2020</a></li>
<li class="chapter" data-level="17" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>17</b> Final Words</a></li>
<li class="chapter" data-level="18" data-path="aknowledgments.html"><a href="aknowledgments.html"><i class="fa fa-check"></i><b>18</b> Aknowledgments</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes for Ecological Modelling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="aula11" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> Class 11: 03 11 2020 ANCOVA with different slopes: interactions</h1>
<div id="about-interactions" class="section level2">
<h2><span class="header-section-number">9.1</span> About interactions</h2>
<p>Interactions are useful when the influence of a covariate on the response variable depends on the level of a second covariate. As an example, consider two different diets that we are trying to assess the efficacy on terms of weight gain. We record weight gains for both sexes.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb220-1" title="1"><span class="co">#--------------------------------------------------------</span></a>
<a class="sourceLine" id="cb220-2" title="2"><span class="co">#Interactions</span></a>
<a class="sourceLine" id="cb220-3" title="3"><span class="co">#### with factor covariates</span></a>
<a class="sourceLine" id="cb220-4" title="4"><span class="co">#--------------------------------------------------------</span></a>
<a class="sourceLine" id="cb220-5" title="5"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb220-6" title="6">n=<span class="dv">100</span></a>
<a class="sourceLine" id="cb220-7" title="7">sexo=<span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;M&quot;</span>,<span class="st">&quot;F&quot;</span>),<span class="dt">each=</span>n)</a>
<a class="sourceLine" id="cb220-8" title="8">dieta=<span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;Controlo&quot;</span>,<span class="st">&quot;Nova&quot;</span>),<span class="dt">times=</span>n)</a>
<a class="sourceLine" id="cb220-9" title="9">ys=<span class="dv">10</span><span class="op">+</span><span class="dv">3</span><span class="op">*</span>(sexo<span class="op">==</span><span class="st">&quot;M&quot;</span>)<span class="op">+</span><span class="dv">2</span><span class="op">*</span>(dieta<span class="op">==</span><span class="st">&quot;Nova&quot;</span>)<span class="op">-</span><span class="dv">4</span><span class="op">*</span>(sexo<span class="op">==</span><span class="st">&quot;M&quot;</span>)<span class="op">*</span>(dieta<span class="op">==</span><span class="st">&quot;Nova&quot;</span>)<span class="op">+</span><span class="kw">rnorm</span>(<span class="dv">2</span><span class="op">*</span>n,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb220-10" title="10"><span class="kw">plot</span>(ys<span class="op">~</span><span class="kw">as.factor</span>(<span class="kw">paste0</span>(sexo,dieta)))</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-119-1.png" width="672" /></p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb221-1" title="1">lmSDi=<span class="kw">lm</span>(ys<span class="op">~</span>sexo<span class="op">*</span>dieta)</a>
<a class="sourceLine" id="cb221-2" title="2"><span class="kw">summary</span>(lmSDi)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ys ~ sexo * dieta)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.7590 -1.2968 -0.1798  1.1942  6.7145 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       9.8022     0.2673  36.675  &lt; 2e-16 ***
## sexoM             3.4188     0.3780   9.045  &lt; 2e-16 ***
## dietaNova         1.9653     0.3780   5.200 5.00e-07 ***
## sexoM:dietaNova  -4.0457     0.5345  -7.569 1.44e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.89 on 196 degrees of freedom
## Multiple R-squared:  0.3015,	Adjusted R-squared:  0.2908 
## F-statistic:  28.2 on 3 and 196 DF,  p-value: 3.326e-15</code></pre>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb223-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>))</a>
<a class="sourceLine" id="cb223-2" title="2"><span class="kw">interaction.plot</span>(<span class="dt">x.factor=</span>sexo, <span class="dt">trace.factor=</span>dieta, <span class="dt">response=</span>ys)</a>
<a class="sourceLine" id="cb223-3" title="3"><span class="kw">interaction.plot</span>(<span class="dt">x.factor=</span>dieta, <span class="dt">trace.factor=</span>sexo, <span class="dt">response=</span>ys)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-119-2.png" width="672" /></p>
<p>We can see what these interaction plots might look like for different realities.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb224-1" title="1"><span class="co">#interaction plots</span></a>
<a class="sourceLine" id="cb224-2" title="2"><span class="kw">set.seed</span>(<span class="dv">121</span>)</a>
<a class="sourceLine" id="cb224-3" title="3"><span class="co"># different interactions and abcense of interaction</span></a>
<a class="sourceLine" id="cb224-4" title="4"><span class="kw">par</span>(<span class="dt">mfcol=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">4</span>),<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>))</a>
<a class="sourceLine" id="cb224-5" title="5"><span class="co">#large negative interaction</span></a>
<a class="sourceLine" id="cb224-6" title="6">ys=<span class="dv">10</span><span class="op">+</span><span class="dv">3</span><span class="op">*</span>(sexo<span class="op">==</span><span class="st">&quot;M&quot;</span>)<span class="op">+</span><span class="dv">2</span><span class="op">*</span>(dieta<span class="op">==</span><span class="st">&quot;Nova&quot;</span>)<span class="op">-</span><span class="dv">4</span><span class="op">*</span>(sexo<span class="op">==</span><span class="st">&quot;M&quot;</span>)<span class="op">*</span>(dieta<span class="op">==</span><span class="st">&quot;Nova&quot;</span>)<span class="op">+</span><span class="kw">rnorm</span>(<span class="dv">2</span><span class="op">*</span>n,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb224-7" title="7"><span class="kw">interaction.plot</span>(<span class="dt">x.factor=</span>sexo, <span class="dt">trace.factor=</span>dieta, <span class="dt">response=</span>ys)</a>
<a class="sourceLine" id="cb224-8" title="8"><span class="kw">interaction.plot</span>(<span class="dt">x.factor=</span>dieta, <span class="dt">trace.factor=</span>sexo, <span class="dt">response=</span>ys)</a>
<a class="sourceLine" id="cb224-9" title="9"><span class="co">#positive interaction</span></a>
<a class="sourceLine" id="cb224-10" title="10">ys=<span class="dv">10</span><span class="op">+</span><span class="dv">3</span><span class="op">*</span>(sexo<span class="op">==</span><span class="st">&quot;M&quot;</span>)<span class="op">+</span><span class="dv">2</span><span class="op">*</span>(dieta<span class="op">==</span><span class="st">&quot;Nova&quot;</span>)<span class="op">+</span><span class="dv">4</span><span class="op">*</span>(sexo<span class="op">==</span><span class="st">&quot;M&quot;</span>)<span class="op">*</span>(dieta<span class="op">==</span><span class="st">&quot;Nova&quot;</span>)<span class="op">+</span><span class="kw">rnorm</span>(<span class="dv">2</span><span class="op">*</span>n,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb224-11" title="11"><span class="kw">interaction.plot</span>(<span class="dt">x.factor=</span>sexo, <span class="dt">trace.factor=</span>dieta, <span class="dt">response=</span>ys)</a>
<a class="sourceLine" id="cb224-12" title="12"><span class="kw">interaction.plot</span>(<span class="dt">x.factor=</span>dieta, <span class="dt">trace.factor=</span>sexo, <span class="dt">response=</span>ys)</a>
<a class="sourceLine" id="cb224-13" title="13"><span class="co">#no interaction</span></a>
<a class="sourceLine" id="cb224-14" title="14">ys=<span class="dv">10</span><span class="op">+</span><span class="dv">3</span><span class="op">*</span>(sexo<span class="op">==</span><span class="st">&quot;M&quot;</span>)<span class="op">+</span><span class="dv">2</span><span class="op">*</span>(dieta<span class="op">==</span><span class="st">&quot;Nova&quot;</span>)<span class="op">+</span><span class="kw">rnorm</span>(<span class="dv">2</span><span class="op">*</span>n,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb224-15" title="15"><span class="kw">interaction.plot</span>(<span class="dt">x.factor=</span>sexo, <span class="dt">trace.factor=</span>dieta, <span class="dt">response=</span>ys)</a>
<a class="sourceLine" id="cb224-16" title="16"><span class="kw">interaction.plot</span>(<span class="dt">x.factor=</span>dieta, <span class="dt">trace.factor=</span>sexo, <span class="dt">response=</span>ys)</a>
<a class="sourceLine" id="cb224-17" title="17"><span class="co">#small negative interaction</span></a>
<a class="sourceLine" id="cb224-18" title="18">ys=<span class="dv">10</span><span class="op">+</span><span class="dv">3</span><span class="op">*</span>(sexo<span class="op">==</span><span class="st">&quot;M&quot;</span>)<span class="op">+</span><span class="dv">2</span><span class="op">*</span>(dieta<span class="op">==</span><span class="st">&quot;Nova&quot;</span>)<span class="op">-</span><span class="dv">2</span><span class="op">*</span>(sexo<span class="op">==</span><span class="st">&quot;M&quot;</span>)<span class="op">*</span>(dieta<span class="op">==</span><span class="st">&quot;Nova&quot;</span>)<span class="op">+</span><span class="kw">rnorm</span>(<span class="dv">2</span><span class="op">*</span>n,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb224-19" title="19"><span class="kw">interaction.plot</span>(<span class="dt">x.factor=</span>sexo, <span class="dt">trace.factor=</span>dieta, <span class="dt">response=</span>ys)</a>
<a class="sourceLine" id="cb224-20" title="20"><span class="kw">interaction.plot</span>(<span class="dt">x.factor=</span>dieta, <span class="dt">trace.factor=</span>sexo, <span class="dt">response=</span>ys)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-120-1.png" width="672" /></p>
</div>
<div id="task-1-implementing-the-ancova-with-different-slopes" class="section level2">
<h2><span class="header-section-number">9.2</span> Task 1 Implementing the ANCOVA with different slopes</h2>
<p>The previous model, explored in Chapters <a href="aula9.html#aula9">7</a> and <a href="aula10.html#aula10">8</a>, assumed that the slopes were the same across the different groups. But that might not be the case in many scenarios.</p>
<p>What would change if they were different? We extend the previous case to the scenario where the slope of the relationship is also different per treatment.</p>
<p>We simulate treatments and data, just in the same way as before, but this gives us the option to change things later in this chapter only, and do it separately if we want.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb225-1" title="1"><span class="co">#----------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb225-2" title="2"><span class="co">#all slopes different</span></a>
<a class="sourceLine" id="cb225-3" title="3"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb225-4" title="4">xs &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">200</span>,<span class="dv">10</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb225-5" title="5">tr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>)</a>
<a class="sourceLine" id="cb225-6" title="6">type &lt;-<span class="st"> </span><span class="kw">rep</span>(tr,<span class="dt">each=</span><span class="dv">50</span>)</a>
<a class="sourceLine" id="cb225-7" title="7">cores &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dt">each=</span><span class="dv">50</span>)</a></code></pre></div>
<p>Now we simulate the response</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb226-1" title="1">ys=<span class="dv">3</span><span class="op">+</span></a>
<a class="sourceLine" id="cb226-2" title="2"><span class="kw">ifelse</span>(type<span class="op">==</span><span class="st">&quot;a&quot;</span>,<span class="dv">5</span>,<span class="kw">ifelse</span>(type<span class="op">==</span><span class="st">&quot;b&quot;</span>,<span class="dv">8</span>,<span class="kw">ifelse</span>(type<span class="op">==</span><span class="st">&quot;c&quot;</span>,<span class="dv">10</span>,<span class="dv">12</span>)))<span class="op">+</span></a>
<a class="sourceLine" id="cb226-3" title="3"><span class="dv">4</span><span class="op">*</span>xs<span class="op">+</span><span class="kw">ifelse</span>(type<span class="op">==</span><span class="st">&quot;a&quot;</span>,<span class="fl">0.2</span>,<span class="kw">ifelse</span>(type<span class="op">==</span><span class="st">&quot;b&quot;</span>,<span class="fl">0.5</span>,<span class="kw">ifelse</span>(type<span class="op">==</span><span class="st">&quot;c&quot;</span>,<span class="dv">1</span>,<span class="dv">2</span>)))<span class="op">*</span>xs<span class="op">+</span></a>
<a class="sourceLine" id="cb226-4" title="4"><span class="kw">rnorm</span>(<span class="dv">200</span>,<span class="dv">0</span>,<span class="dv">4</span>)</a></code></pre></div>
<p>If the above code is opaque, we present a different implementation below. Note the code that follows is just the same as the code above, but it might be simpler to understand that the setting implies that we have both different intercepts and slopes per treatment.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb227-1" title="1"><span class="co">#same as</span></a>
<a class="sourceLine" id="cb227-2" title="2">intercept=<span class="dv">3</span><span class="op">+</span><span class="kw">ifelse</span>(type<span class="op">==</span><span class="st">&quot;a&quot;</span>,<span class="dv">5</span>,<span class="kw">ifelse</span>(type<span class="op">==</span><span class="st">&quot;b&quot;</span>,<span class="dv">8</span>,<span class="kw">ifelse</span>(type<span class="op">==</span><span class="st">&quot;c&quot;</span>,<span class="dv">10</span>,<span class="dv">12</span>)))</a>
<a class="sourceLine" id="cb227-3" title="3">slope=xs<span class="op">*</span>(<span class="dv">4</span><span class="op">+</span><span class="kw">ifelse</span>(type<span class="op">==</span><span class="st">&quot;a&quot;</span>,<span class="fl">0.2</span>,<span class="kw">ifelse</span>(type<span class="op">==</span><span class="st">&quot;b&quot;</span>,<span class="fl">0.5</span>,<span class="kw">ifelse</span>(type<span class="op">==</span><span class="st">&quot;c&quot;</span>,<span class="dv">1</span>,<span class="dv">2</span>))))</a>
<a class="sourceLine" id="cb227-4" title="4">ys=slope<span class="op">+</span>intercept<span class="op">+</span><span class="kw">rnorm</span>(<span class="dv">200</span>,<span class="dv">0</span>,<span class="dv">4</span>)</a></code></pre></div>
<p>We can look at the resulting data, as well as the real model that generated the data (as usual, data is the sistematic component induced by the assumed model to which we add some random error)</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb228-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>))</a>
<a class="sourceLine" id="cb228-2" title="2"><span class="kw">plot</span>(xs,ys,<span class="dt">col=</span>cores)</a>
<a class="sourceLine" id="cb228-3" title="3"><span class="kw">abline</span>(<span class="dv">3</span><span class="op">+</span><span class="dv">5</span>,<span class="dv">4</span><span class="fl">+0.2</span>,<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">col=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb228-4" title="4"><span class="kw">abline</span>(<span class="dv">3</span><span class="op">+</span><span class="dv">8</span>,<span class="dv">4</span><span class="fl">+0.5</span>,<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">col=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb228-5" title="5"><span class="kw">abline</span>(<span class="dv">3</span><span class="op">+</span><span class="dv">10</span>,<span class="dv">4</span><span class="op">+</span><span class="dv">1</span>,<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">col=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb228-6" title="6"><span class="kw">abline</span>(<span class="dv">3</span><span class="op">+</span><span class="dv">12</span>,<span class="dv">4</span><span class="op">+</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">col=</span><span class="dv">4</span>)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-124-1.png" width="672" /></p>
<p>As before, it is actually not that easy to confirm the slopes and intercepts are different, as the intercept is not shown in the above plot. We can zoom out the plot to show us the intercepts (Figure <a href="aula11.html#fig:FCR">9.1</a>), which are by definition, where the lines cross the vertical dashed line, i.e., when x=0 in the Cartesian referential.</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb229-1" title="1"><span class="kw">plot</span>(xs,ys,<span class="dt">col=</span>cores,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">20</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">150</span>))</a>
<a class="sourceLine" id="cb229-2" title="2"><span class="kw">abline</span>(<span class="dv">3</span><span class="op">+</span><span class="dv">5</span>,<span class="dv">4</span><span class="fl">+0.2</span>,<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">col=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb229-3" title="3"><span class="kw">abline</span>(<span class="dv">3</span><span class="op">+</span><span class="dv">8</span>,<span class="dv">4</span><span class="fl">+0.5</span>,<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">col=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb229-4" title="4"><span class="kw">abline</span>(<span class="dv">3</span><span class="op">+</span><span class="dv">10</span>,<span class="dv">4</span><span class="op">+</span><span class="dv">1</span>,<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">col=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb229-5" title="5"><span class="kw">abline</span>(<span class="dv">3</span><span class="op">+</span><span class="dv">12</span>,<span class="dv">4</span><span class="op">+</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">col=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb229-6" title="6"><span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">c</span>(<span class="dv">3</span><span class="op">+</span><span class="dv">5</span>,<span class="dv">3</span><span class="op">+</span><span class="dv">8</span>,<span class="dv">3</span><span class="op">+</span><span class="dv">10</span>,<span class="dv">3</span><span class="op">+</span><span class="dv">12</span>),<span class="dt">v=</span><span class="dv">0</span>,<span class="dt">col=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>),<span class="dt">lty=</span><span class="dv">2</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:FCR"></span>
<img src="ECOMODbook_files/figure-html/FCR-1.png" alt="Zooming out on the data so that the (fifferent) intercepts are visible" width="80%" />
<p class="caption">
Figure 9.1: Zooming out on the data so that the (fifferent) intercepts are visible
</p>
</div>
<p>Now, we implement the ANCOVA linear model, but with an <em>interaction</em> term between the <code>type</code> and <code>xs</code>. An interaction between two variables, say <code>A</code> and <code>B</code>, is defined in R syntax as <code>A*B</code>, and so for the corresponding linear model we specify</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb230-1" title="1">lm.ancova2=<span class="kw">lm</span>(ys<span class="op">~</span>xs<span class="op">+</span>type<span class="op">+</span>xs<span class="op">*</span>type)</a>
<a class="sourceLine" id="cb230-2" title="2">sum.lm.ancova2=<span class="kw">summary</span>(lm.ancova2)</a></code></pre></div>
<p>We can look at the output of the model</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb231-1" title="1">sum.lm.ancova2</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ys ~ xs + type + xs * type)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -14.5511  -2.7070   0.2239   2.2766  11.3763 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   7.9570     3.1985   2.488 0.013707 *  
## xs            4.2084     0.2143  19.638  &lt; 2e-16 ***
## typeb        10.6830     4.2375   2.521 0.012513 *  
## typec         2.8307     4.3047   0.658 0.511588    
## typed         7.5008     4.4644   1.680 0.094556 .  
## xs:typeb     -0.2342     0.2889  -0.811 0.418617    
## xs:typec      0.9924     0.2836   3.500 0.000579 ***
## xs:typed      1.7875     0.2927   6.106 5.54e-09 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.958 on 192 degrees of freedom
## Multiple R-squared:  0.965,	Adjusted R-squared:  0.9637 
## F-statistic: 755.2 on 7 and 192 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>This is an output similar to the corresponding ANOVA table (implemented via <code>aov</code>, the R function that produces ANOVA tables from expressions akin to linear models). The difference is that in such a case the outputs come in terms of the variables, not their levels. This would be</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb233-1" title="1"><span class="kw">summary</span>(<span class="kw">aov</span>(ys<span class="op">~</span>xs<span class="op">+</span>type<span class="op">+</span>xs<span class="op">*</span>type))</a></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## xs            1  49119   49119 3134.87  &lt; 2e-16 ***
## type          3  32682   10894  695.28  &lt; 2e-16 ***
## xs:type       3   1034     345   21.99 2.77e-12 ***
## Residuals   192   3008      16                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Note that the overall F statistic from the regression model has an F-statistic of
755.2, with
7 and
192 degrees of freedom. That corresponds to the composite test with the null hypothesis “are all parameters equal to 0”, which in the ANOVA table, is separated in 3 testes, one for each parameter, with 1, 3 and 3 degrees of freedom each. The residual degrees of freedom are naturally the same in all these tests.</p>
<p>Naturally, we can now evaluate the values of the estimated coefficients, and in particular we can use them to estimate the corresponding regression lines per group. For type <code>a</code> we have this</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb235-1" title="1"><span class="co">#type a</span></a>
<a class="sourceLine" id="cb235-2" title="2">lm.ancova2<span class="op">$</span>coefficients[<span class="dv">1</span>];lm.ancova2<span class="op">$</span>coefficients[<span class="dv">2</span>]</a></code></pre></div>
<pre><code>## (Intercept) 
##    7.957025</code></pre>
<pre><code>##       xs 
## 4.208363</code></pre>
<p>in other words, <code>ys</code>=7.9570252+4.2083626 <span class="math inline">\(\times\)</span> <code>xs</code> , for type <code>b</code> we have this</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb238-1" title="1"><span class="co">#type b</span></a>
<a class="sourceLine" id="cb238-2" title="2">lm.ancova2<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lm.ancova2<span class="op">$</span>coefficients[<span class="dv">3</span>];lm.ancova2<span class="op">$</span>coefficients[<span class="dv">2</span>]<span class="op">+</span>lm.ancova2<span class="op">$</span>coefficients[<span class="dv">6</span>]</a></code></pre></div>
<pre><code>## (Intercept) 
##    18.64006</code></pre>
<pre><code>##       xs 
## 3.974212</code></pre>
<p>in other words, <code>ys</code>=18.640062+3.9742116 <span class="math inline">\(\times\)</span> <code>xs</code>, for type <code>c</code> we have this</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb241-1" title="1"><span class="co">#type c</span></a>
<a class="sourceLine" id="cb241-2" title="2">lm.ancova2<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lm.ancova2<span class="op">$</span>coefficients[<span class="dv">4</span>];lm.ancova2<span class="op">$</span>coefficients[<span class="dv">2</span>]<span class="op">+</span>lm.ancova2<span class="op">$</span>coefficients[<span class="dv">7</span>]</a></code></pre></div>
<pre><code>## (Intercept) 
##    10.78774</code></pre>
<pre><code>##       xs 
## 5.200757</code></pre>
<p>in other words, <code>ys</code>=10.7877404+5.2007572 <span class="math inline">\(\times\)</span> <code>xs</code>, and for type <code>d</code> we have this</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb244-1" title="1"><span class="co">#type d</span></a>
<a class="sourceLine" id="cb244-2" title="2">lm.ancova2<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lm.ancova2<span class="op">$</span>coefficients[<span class="dv">5</span>];lm.ancova2<span class="op">$</span>coefficients[<span class="dv">2</span>]<span class="op">+</span>lm.ancova2<span class="op">$</span>coefficients[<span class="dv">8</span>]</a></code></pre></div>
<pre><code>## (Intercept) 
##    15.45779</code></pre>
<pre><code>##       xs 
## 5.995865</code></pre>
<p>in other words, <code>ys</code>=15.4577929+5.995865 <span class="math inline">\(\times\)</span> <code>xs</code>.</p>
<p>we can now add these to the earlier plots, to see how well we have estimated the different lines per treatment</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb247-1" title="1"><span class="co">#real lines</span></a>
<a class="sourceLine" id="cb247-2" title="2"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>))</a>
<a class="sourceLine" id="cb247-3" title="3"><span class="kw">plot</span>(xs,ys,<span class="dt">col=</span>cores)</a>
<a class="sourceLine" id="cb247-4" title="4"><span class="kw">abline</span>(<span class="dv">3</span><span class="op">+</span><span class="dv">5</span>,<span class="dv">4</span><span class="fl">+0.2</span>,<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">col=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb247-5" title="5"><span class="kw">abline</span>(<span class="dv">3</span><span class="op">+</span><span class="dv">8</span>,<span class="dv">4</span><span class="fl">+0.5</span>,<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">col=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb247-6" title="6"><span class="kw">abline</span>(<span class="dv">3</span><span class="op">+</span><span class="dv">10</span>,<span class="dv">4</span><span class="op">+</span><span class="dv">1</span>,<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">col=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb247-7" title="7"><span class="kw">abline</span>(<span class="dv">3</span><span class="op">+</span><span class="dv">12</span>,<span class="dv">4</span><span class="op">+</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">col=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb247-8" title="8"><span class="co">#estimated lines</span></a>
<a class="sourceLine" id="cb247-9" title="9"><span class="co">#type a</span></a>
<a class="sourceLine" id="cb247-10" title="10"><span class="kw">abline</span>(lm.ancova2<span class="op">$</span>coefficients[<span class="dv">1</span>],lm.ancova2<span class="op">$</span>coefficients[<span class="dv">2</span>],<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">1</span>,<span class="dt">lwd=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb247-11" title="11"><span class="co">#type b</span></a>
<a class="sourceLine" id="cb247-12" title="12"><span class="kw">abline</span>(lm.ancova2<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lm.ancova2<span class="op">$</span>coefficients[<span class="dv">3</span>],</a>
<a class="sourceLine" id="cb247-13" title="13">lm.ancova2<span class="op">$</span>coefficients[<span class="dv">2</span>]<span class="op">+</span>lm.ancova2<span class="op">$</span>coefficients[<span class="dv">6</span>],<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb247-14" title="14"><span class="co">#type c</span></a>
<a class="sourceLine" id="cb247-15" title="15"><span class="kw">abline</span>(lm.ancova2<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lm.ancova2<span class="op">$</span>coefficients[<span class="dv">4</span>],</a>
<a class="sourceLine" id="cb247-16" title="16">lm.ancova2<span class="op">$</span>coefficients[<span class="dv">2</span>]<span class="op">+</span>lm.ancova2<span class="op">$</span>coefficients[<span class="dv">7</span>],<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">3</span>,<span class="dt">lwd=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb247-17" title="17"><span class="co">#type b</span></a>
<a class="sourceLine" id="cb247-18" title="18"><span class="kw">abline</span>(lm.ancova2<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lm.ancova2<span class="op">$</span>coefficients[<span class="dv">5</span>],</a>
<a class="sourceLine" id="cb247-19" title="19">lm.ancova2<span class="op">$</span>coefficients[<span class="dv">2</span>]<span class="op">+</span>lm.ancova2<span class="op">$</span>coefficients[<span class="dv">8</span>],<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">4</span>,<span class="dt">lwd=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb247-20" title="20"><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="dt">legend =</span> tr,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dt">inset=</span><span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb247-21" title="21"><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>,<span class="dt">legend =</span><span class="kw">paste</span>(<span class="st">&quot;Estimated&quot;</span>,tr),<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dt">inset=</span><span class="fl">0.05</span>)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-132-1.png" width="672" /></p>
<p>Remember, if this was a real analysis, you would not know the truth, so at best, you would be able to see the predicted lines, but not the real lines, just as in the plot below</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb248-1" title="1"><span class="co"># In real life, we only see this</span></a>
<a class="sourceLine" id="cb248-2" title="2"><span class="kw">plot</span>(xs,ys,<span class="dt">col=</span>cores)</a>
<a class="sourceLine" id="cb248-3" title="3"><span class="co">#plot the lines</span></a>
<a class="sourceLine" id="cb248-4" title="4"><span class="kw">abline</span>(lm.ancova2<span class="op">$</span>coefficients[<span class="dv">1</span>],lm.ancova2<span class="op">$</span>coefficients[<span class="dv">2</span>],<span class="dt">lwd=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="dv">1</span>,<span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb248-5" title="5"><span class="kw">abline</span>(lm.ancova2<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lm.ancova2<span class="op">$</span>coefficients[<span class="dv">3</span>],lm.ancova2<span class="op">$</span>coefficients[<span class="dv">2</span>]<span class="op">+</span>lm.ancova2<span class="op">$</span>coefficients[<span class="dv">6</span>],<span class="dt">lwd=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb248-6" title="6"><span class="kw">abline</span>(lm.ancova2<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lm.ancova2<span class="op">$</span>coefficients[<span class="dv">4</span>],lm.ancova2<span class="op">$</span>coefficients[<span class="dv">2</span>]<span class="op">+</span>lm.ancova2<span class="op">$</span>coefficients[<span class="dv">7</span>],<span class="dt">lwd=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="dv">3</span>,<span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb248-7" title="7"><span class="kw">abline</span>(lm.ancova2<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lm.ancova2<span class="op">$</span>coefficients[<span class="dv">5</span>],lm.ancova2<span class="op">$</span>coefficients[<span class="dv">2</span>]<span class="op">+</span>lm.ancova2<span class="op">$</span>coefficients[<span class="dv">8</span>],<span class="dt">lwd=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="dv">4</span>,<span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb248-8" title="8"><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>,<span class="dt">legend =</span><span class="kw">paste</span>(<span class="st">&quot;Estimated&quot;</span>,tr),<span class="dt">lwd=</span><span class="dv">1</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dt">inset=</span><span class="fl">0.05</span>)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-133-1.png" width="672" /></p>
<p>It is interesting to note that the slopes were in general closer to the true values than the intercepts.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb249-1" title="1"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb249-2" title="2"><span class="co">#true intercepts</span></a>
<a class="sourceLine" id="cb249-3" title="3">TI&lt;-<span class="kw">unique</span>(<span class="dv">3</span><span class="op">+</span><span class="kw">ifelse</span>(type<span class="op">==</span><span class="st">&quot;a&quot;</span>,<span class="dv">5</span>,<span class="kw">ifelse</span>(type<span class="op">==</span><span class="st">&quot;b&quot;</span>,<span class="dv">8</span>,<span class="kw">ifelse</span>(type<span class="op">==</span><span class="st">&quot;c&quot;</span>,<span class="dv">10</span>,<span class="dv">12</span>))))</a>
<a class="sourceLine" id="cb249-4" title="4"><span class="co">#true slopes</span></a>
<a class="sourceLine" id="cb249-5" title="5">TS&lt;-<span class="kw">unique</span>(<span class="dv">4</span><span class="op">+</span><span class="kw">ifelse</span>(type<span class="op">==</span><span class="st">&quot;a&quot;</span>,<span class="fl">0.2</span>,<span class="kw">ifelse</span>(type<span class="op">==</span><span class="st">&quot;b&quot;</span>,<span class="fl">0.5</span>,<span class="kw">ifelse</span>(type<span class="op">==</span><span class="st">&quot;c&quot;</span>,<span class="dv">1</span>,<span class="dv">2</span>))))</a>
<a class="sourceLine" id="cb249-6" title="6"><span class="co">#estimated intercepts</span></a>
<a class="sourceLine" id="cb249-7" title="7">EI&lt;-<span class="kw">round</span>(<span class="kw">c</span>(lm.ancova2<span class="op">$</span>coefficients[<span class="dv">1</span>],lm.ancova2<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lm.ancova2<span class="op">$</span>coefficients[<span class="dv">3</span>],lm.ancova2<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lm.ancova2<span class="op">$</span>coefficients[<span class="dv">4</span>],lm.ancova2<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lm.ancova2<span class="op">$</span>coefficients[<span class="dv">5</span>]),<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb249-8" title="8"><span class="co">#estimated slopes</span></a>
<a class="sourceLine" id="cb249-9" title="9">ES&lt;-<span class="kw">round</span>(<span class="kw">c</span>(lm.ancova2<span class="op">$</span>coefficients[<span class="dv">2</span>],lm.ancova2<span class="op">$</span>coefficients[<span class="dv">2</span>]<span class="op">+</span>lm.ancova2<span class="op">$</span>coefficients[<span class="dv">6</span>],lm.ancova2<span class="op">$</span>coefficients[<span class="dv">2</span>]<span class="op">+</span>lm.ancova2<span class="op">$</span>coefficients[<span class="dv">7</span>],lm.ancova2<span class="op">$</span>coefficients[<span class="dv">2</span>]<span class="op">+</span>lm.ancova2<span class="op">$</span>coefficients[<span class="dv">8</span>]),<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb249-10" title="10"><span class="co">#pooled table</span></a>
<a class="sourceLine" id="cb249-11" title="11"><span class="kw">kable</span>(<span class="kw">cbind</span>(<span class="kw">c</span>(<span class="st">&quot;Type&quot;</span>,<span class="st">&quot;Intercept (true)&quot;</span>,<span class="st">&quot;Intercept (estimated)&quot;</span>,<span class="st">&quot;Slope (true)&quot;</span>,<span class="st">&quot;Slope (estimated)&quot;</span>),<span class="kw">rbind</span>(<span class="kw">unique</span>(type),TI,EI,TS,ES)))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left"></th>
<th align="left">(Intercept)</th>
<th align="left">(Intercept)</th>
<th align="left">(Intercept)</th>
<th align="left">(Intercept)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"></td>
<td align="left">Type</td>
<td align="left">a</td>
<td align="left">b</td>
<td align="left">c</td>
<td align="left">d</td>
</tr>
<tr class="even">
<td align="left">TI</td>
<td align="left">Intercept (true)</td>
<td align="left">8</td>
<td align="left">11</td>
<td align="left">13</td>
<td align="left">15</td>
</tr>
<tr class="odd">
<td align="left">EI</td>
<td align="left">Intercept (estimated)</td>
<td align="left">8</td>
<td align="left">18.6</td>
<td align="left">10.8</td>
<td align="left">15.5</td>
</tr>
<tr class="even">
<td align="left">TS</td>
<td align="left">Slope (true)</td>
<td align="left">4.2</td>
<td align="left">4.5</td>
<td align="left">5</td>
<td align="left">6</td>
</tr>
<tr class="odd">
<td align="left">ES</td>
<td align="left">Slope (estimated)</td>
<td align="left">4.2</td>
<td align="left">4</td>
<td align="left">5.2</td>
<td align="left">6</td>
</tr>
</tbody>
</table>
<p>Can you think about an intuitive reason for that being the case? The answer lies in figure <a href="aula11.html#fig:FCR">9.1</a>. There is no data near the intercept, so there is actually more information abot the slope than about the intercept. Things could have been different if the data for the continous response was also available around the value 0.</p>
</div>
<div id="task-2-modeling-a-data-set" class="section level2">
<h2><span class="header-section-number">9.3</span> Task 2 Modeling a data set</h2>
<p>In a given dataset we might want to explain a continous variable as a function of a couple of explanatory variables, specifically a continous variable and a factor. As we have seen before, this could be attempted via an ANCOVA, with or without an interaction term.Therefore, a relevant question might be to know if the interaction is needed or not, or in other words, if the different lines expressing the relationship between the countinous covariate and the response might be have different slopes per level of the factor covariate, or if on the other hand, a comon slope might be possible, with different per level of the factor covariate. A third even simpler model is the one where the factor covariate is not relevant at all, or, in other words, single line would be the most parcimonious way to model the data.</p>
<p>We illustrate that with the data set <code>data4lines.csv</code> that we considered before in chapter <a href="aula7.html#aula7">5</a>, which was created using the website <a href="https://drawdata.xyz/" class="uri">https://drawdata.xyz/</a>. To make our story a bit more intersting we again come up with a narrative.</p>
<p>A biologist is interested in estimating what might have been the weight of a fish for which he found an operculum in the in the stomach of a dead otter (<em>Lutra lutra</em>). The operculum was 300 mm in diameter. He knows the fish was a barbel (genera: <em>Barbus</em>). We will call this biologist Carlos. His wife is called Conceição, and Conceição enjoys thinking about hard questions. Carlos found the dead otter in the margins of the Guadiana river in Portugal. It seems hard to believe that the otter might have eaten such a large fish. It might have been the largest fish ever eaten by a <em>Lutra lutra</em>, which the biologist would love to report in the next Ichtiology congress. To answer his question he visited the museum and he was able to find a sample of fish from the genus <em>Barbus</em>. Therefore he labouriosly weighed fish and measured opeculuns… The resulting data are our data!</p>
<p>Carlos reads the data in</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb250-1" title="1">folder&lt;-<span class="st">&quot;extfiles/&quot;</span></a>
<a class="sourceLine" id="cb250-2" title="2"><span class="co">#folder&lt;-&quot;../Aula7 14 10 2020/&quot;</span></a>
<a class="sourceLine" id="cb250-3" title="3">d4l &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file=</span><span class="kw">paste0</span>(folder,<span class="st">&quot;data4lines.csv&quot;</span>))</a>
<a class="sourceLine" id="cb250-4" title="4">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(d4l)</a></code></pre></div>
<p>He plots the data ad he sees a pattern that seems to be somewaht linear. He knows about linear regression and he fits a line to the data, and then shows the resulting plot with data, model and predictions to Conceição.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb251-1" title="1">lm0 &lt;-<span class="st"> </span><span class="kw">lm</span>(y<span class="op">~</span>x,<span class="dt">data=</span>d4l)</a></code></pre></div>
<p>Carlos is winning, claiming that unfortunately, he suspects that the fish was not the largest ever reported. A Spanish ictiologist reported an otter having eaten a fish with 220 grams. And with his model, he predicts the opperculum belonged to a fish with a weight of about 213.7 gr (<a href="aula11.html#fig:wod">9.2</a>).</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb252-1" title="1"><span class="co">#plot all the data</span></a>
<a class="sourceLine" id="cb252-2" title="2"><span class="kw">plot</span>(y<span class="op">~</span>x,<span class="dt">xlab=</span> <span class="st">&quot;Operculum diameters (mm)&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Fish length (gr)&quot;</span>,<span class="dt">data=</span>d4l)</a>
<a class="sourceLine" id="cb252-3" title="3"><span class="kw">abline</span>(lm0,<span class="dt">lty=</span><span class="dv">1</span>,<span class="dt">lwd=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb252-4" title="4"><span class="kw">abline</span>(<span class="dt">v=</span>sizeo,<span class="dt">h=</span>lm0<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lm0<span class="op">$</span>coefficients[<span class="dv">2</span>]<span class="op">*</span>sizeo,<span class="dt">lty=</span><span class="dv">2</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:wod"></span>
<img src="ECOMODbook_files/figure-html/wod-1.png" alt="Pooled model of fish weight as a function of operculum diameter. Dashed lines represent predictions for a fish with a 300 mm operculum." width="80%" />
<p class="caption">
Figure 9.2: Pooled model of fish weight as a function of operculum diameter. Dashed lines represent predictions for a fish with a 300 mm operculum.
</p>
</div>
<p>Conceição looks at the plots, wonders once again why she married Carlos, and asks: “What was the actual species of the operculun in your dead otter? And by the way, please, for the last time, can you put the dead otter in the garbage? It is the second time that I confuse it with a rabbit in the freezer…! One day you might have a bad surprise for dinner!”. Carlos thinks about this as says, it was <em>Barbus sclateri</em>. And Maria says: “Well, is the relationship between operculum diameter and fish length the same for all the species?”. Carlos - perhaps not the sharpest tool in the box as we by now have come to realize - nonetheless manages to realize what Conceição is asking about. He knows the animals in the museum were identified to the species level, and he redoes the plot coloring the points by species.</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb253-1" title="1"><span class="kw">plot</span>(y<span class="op">~</span>x,<span class="dt">col=</span><span class="kw">as.numeric</span>(<span class="kw">as.factor</span>(z)),<span class="dt">data=</span>d4l,<span class="dt">pch=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-138-1.png" width="672" /></p>
<p>And the question that now arises in Carlos mind is, what might the best model to represent this data set, where he has measurements of two numeric variables, <code>weight~diameter</code> across 4 groups of observations, defined by <code>species</code>.</p>
<p>Carlos decides he can fit a linear model with both <code>x</code> and <code>z</code> as independent variables, without an interaction. Note this is the conventional ANCOVA model, just as we did before.</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb254-1" title="1"><span class="co">#fit model per group</span></a>
<a class="sourceLine" id="cb254-2" title="2">lmANC&lt;-<span class="kw">lm</span>(y<span class="op">~</span>x<span class="op">+</span>z,<span class="dt">data=</span>d4l)</a>
<a class="sourceLine" id="cb254-3" title="3"><span class="kw">summary</span>(lmANC)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + z, data = d4l)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -90.01 -35.01   2.54  35.51 108.10 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  45.51813   13.83069   3.291  0.00128 ** 
## x             0.39657    0.02516  15.763  &lt; 2e-16 ***
## zb           54.92376   12.11597   4.533 1.28e-05 ***
## zc          128.20339   11.72572  10.934  &lt; 2e-16 ***
## zd           22.82412   10.26509   2.223  0.02787 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 42.5 on 133 degrees of freedom
## Multiple R-squared:  0.7332,	Adjusted R-squared:  0.7252 
## F-statistic: 91.38 on 4 and 133 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Maria reminds him again that life is more complicated than what he’d like to imagine: “Why don’t you try a model with an interaction term between opperculum diameter and species?”. And so he does.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb256-1" title="1"><span class="co">#fit model per group, with interaction</span></a>
<a class="sourceLine" id="cb256-2" title="2">lmlinesI&lt;-<span class="kw">lm</span>(y<span class="op">~</span>x<span class="op">+</span>z<span class="op">+</span>x<span class="op">:</span>z,<span class="dt">data=</span>d4l)</a>
<a class="sourceLine" id="cb256-3" title="3"><span class="kw">summary</span>(lmlinesI)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + z + x:z, data = d4l)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -77.569 -15.787   2.848  17.776  60.875 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -84.72064   19.98946  -4.238 4.24e-05 ***
## x             0.69346    0.04380  15.831  &lt; 2e-16 ***
## zb          109.96907   25.87243   4.250 4.04e-05 ***
## zc          187.01780   24.87546   7.518 8.03e-12 ***
## zd          223.27435   21.82006  10.233  &lt; 2e-16 ***
## x:zb         -0.08161    0.06222  -1.312    0.192    
## x:zc         -0.08902    0.05954  -1.495    0.137    
## x:zd         -0.49630    0.04926 -10.075  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 28.09 on 130 degrees of freedom
## Multiple R-squared:  0.8861,	Adjusted R-squared:   0.88 
## F-statistic: 144.5 on 7 and 130 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>It seems like, based on AIC, the model with the interaction is the most parsimonious (remember: most parcimonious model is the one with lowest AIC)!</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb258-1" title="1"><span class="kw">AIC</span>(lm0,lmANC,lmlinesI)</a></code></pre></div>
<pre><code>##          df      AIC
## lm0       3 1533.741
## lmANC     6 1433.414
## lmlinesI  9 1321.927</code></pre>
<p>Which if you ignore the story for a moment, makes total sence, since that indeed we had one line for one of the groups (<code>z</code>) that had a different slope! And that is the significant interaction term above, indicating it is different from the slope of group <code>a</code>.</p>
<p>Now lets go back to the data. Remember a plot we had on this dataset before?We noted the plot was messy, including the pooled regression (the thick black line), the regressions fitted to independent data sets, one for each species (museums before!) (the solid lines), and the regressions resulting from the model with species as a factor covariate (dotted-dashed lines).</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb260-1" title="1"><span class="co">#plot all the data</span></a>
<a class="sourceLine" id="cb260-2" title="2"><span class="kw">plot</span>(y<span class="op">~</span>x,<span class="dt">col=</span><span class="kw">as.numeric</span>(<span class="kw">as.factor</span>(z)),<span class="dt">data=</span>d4l,<span class="dt">pch=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb260-3" title="3"><span class="co">#completely independet regression lines</span></a>
<a class="sourceLine" id="cb260-4" title="4"><span class="kw">abline</span>(<span class="kw">lm</span>(y<span class="op">~</span>x,<span class="dt">data=</span>d4l[d4l<span class="op">$</span>z<span class="op">==</span><span class="st">&quot;a&quot;</span>,]),<span class="dt">col=</span><span class="dv">1</span>,<span class="dt">lty=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb260-5" title="5"><span class="kw">abline</span>(<span class="kw">lm</span>(y<span class="op">~</span>x,<span class="dt">data=</span>d4l[d4l<span class="op">$</span>z<span class="op">==</span><span class="st">&quot;b&quot;</span>,]),<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb260-6" title="6"><span class="kw">abline</span>(<span class="kw">lm</span>(y<span class="op">~</span>x,<span class="dt">data=</span>d4l[d4l<span class="op">$</span>z<span class="op">==</span><span class="st">&quot;c&quot;</span>,]),<span class="dt">col=</span><span class="dv">3</span>,<span class="dt">lty=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb260-7" title="7"><span class="kw">abline</span>(<span class="kw">lm</span>(y<span class="op">~</span>x,<span class="dt">data=</span>d4l[d4l<span class="op">$</span>z<span class="op">==</span><span class="st">&quot;d&quot;</span>,]),<span class="dt">col=</span><span class="dv">4</span>,<span class="dt">lty=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb260-8" title="8"><span class="co">#fit model to pooled data</span></a>
<a class="sourceLine" id="cb260-9" title="9">lmlinesG&lt;-<span class="kw">lm</span>(y<span class="op">~</span>x,<span class="dt">data=</span>d4l)</a>
<a class="sourceLine" id="cb260-10" title="10"><span class="co">#these are the wrong lines... why?</span></a>
<a class="sourceLine" id="cb260-11" title="11"><span class="kw">abline</span>(lmlinesG,<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb260-12" title="12"><span class="kw">abline</span>(lmANC<span class="op">$</span>coefficients[<span class="dv">1</span>],lmANC<span class="op">$</span>coefficients[<span class="dv">2</span>],<span class="dt">col=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb260-13" title="13"><span class="kw">abline</span>(lmANC<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lmANC<span class="op">$</span>coefficients[<span class="dv">3</span>],lmANC<span class="op">$</span>coefficients[<span class="dv">2</span>],<span class="dt">col=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb260-14" title="14"><span class="kw">abline</span>(lmANC<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lmANC<span class="op">$</span>coefficients[<span class="dv">4</span>],lmANC<span class="op">$</span>coefficients[<span class="dv">2</span>],<span class="dt">col=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb260-15" title="15"><span class="kw">abline</span>(lmANC<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lmANC<span class="op">$</span>coefficients[<span class="dv">5</span>],lmANC<span class="op">$</span>coefficients[<span class="dv">2</span>],<span class="dt">col=</span><span class="dv">4</span>)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-142-1.png" width="672" /></p>
<p>Now we can remove the independent lines (to clean it up a bit!) and just leave the no interaction model estimated values, then add the estimated lines from the interaction model below. Remember, AIC says its the ones from the interactioon model that are the best representation of the data.</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb261-1" title="1"><span class="co">#plot all the data</span></a>
<a class="sourceLine" id="cb261-2" title="2"><span class="kw">plot</span>(y<span class="op">~</span>x,<span class="dt">col=</span><span class="kw">as.numeric</span>(<span class="kw">as.factor</span>(z)),<span class="dt">data=</span>d4l,<span class="dt">pch=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb261-3" title="3"><span class="co"># #completely independent regression lines</span></a>
<a class="sourceLine" id="cb261-4" title="4"><span class="co"># abline(lm(y~x,data=d4l[d4l$z==&quot;a&quot;,]),col=1,lty=4)</span></a>
<a class="sourceLine" id="cb261-5" title="5"><span class="co"># abline(lm(y~x,data=d4l[d4l$z==&quot;b&quot;,]),col=2,lty=4)</span></a>
<a class="sourceLine" id="cb261-6" title="6"><span class="co"># abline(lm(y~x,data=d4l[d4l$z==&quot;c&quot;,]),col=3,lty=4)</span></a>
<a class="sourceLine" id="cb261-7" title="7"><span class="co"># abline(lm(y~x,data=d4l[d4l$z==&quot;d&quot;,]),col=4,lty=4)</span></a>
<a class="sourceLine" id="cb261-8" title="8"><span class="co"># no interaction lines</span></a>
<a class="sourceLine" id="cb261-9" title="9"><span class="kw">abline</span>(lmANC<span class="op">$</span>coefficients[<span class="dv">1</span>],lmANC<span class="op">$</span>coefficients[<span class="dv">2</span>],<span class="dt">col=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb261-10" title="10"><span class="kw">abline</span>(lmANC<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lmANC<span class="op">$</span>coefficients[<span class="dv">3</span>],lmANC<span class="op">$</span>coefficients[<span class="dv">2</span>],<span class="dt">col=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb261-11" title="11"><span class="kw">abline</span>(lmANC<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lmANC<span class="op">$</span>coefficients[<span class="dv">4</span>],lmANC<span class="op">$</span>coefficients[<span class="dv">2</span>],<span class="dt">col=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb261-12" title="12"><span class="kw">abline</span>(lmANC<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lmANC<span class="op">$</span>coefficients[<span class="dv">5</span>],lmANC<span class="op">$</span>coefficients[<span class="dv">2</span>],<span class="dt">col=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb261-13" title="13"><span class="co"># model with interaction lines</span></a>
<a class="sourceLine" id="cb261-14" title="14"><span class="kw">abline</span>(lmlinesI<span class="op">$</span>coefficients[<span class="dv">1</span>],lmlinesI<span class="op">$</span>coefficients[<span class="dv">2</span>],<span class="dt">col=</span><span class="dv">1</span>,<span class="dt">lty=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb261-15" title="15"><span class="kw">abline</span>(lmlinesI<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lmlinesI<span class="op">$</span>coefficients[<span class="dv">3</span>],lmlinesI<span class="op">$</span>coefficients[<span class="dv">2</span>]<span class="op">+</span>lmlinesI<span class="op">$</span>coefficients[<span class="dv">6</span>],<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb261-16" title="16"><span class="kw">abline</span>(lmlinesI<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lmlinesI<span class="op">$</span>coefficients[<span class="dv">4</span>],lmlinesI<span class="op">$</span>coefficients[<span class="dv">2</span>]<span class="op">+</span>lmlinesI<span class="op">$</span>coefficients[<span class="dv">7</span>],<span class="dt">col=</span><span class="dv">3</span>,<span class="dt">lty=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb261-17" title="17"><span class="kw">abline</span>(lmlinesI<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lmlinesI<span class="op">$</span>coefficients[<span class="dv">5</span>],lmlinesI<span class="op">$</span>coefficients[<span class="dv">2</span>]<span class="op">+</span>lmlinesI<span class="op">$</span>coefficients[<span class="dv">8</span>],<span class="dt">col=</span><span class="dv">4</span>,<span class="dt">lty=</span><span class="dv">5</span>)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-143-1.png" width="672" /></p>
<p>Likewise, we could compare the lines from independent lines to those of the interaction model.</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb262-1" title="1"><span class="co">#plot all the data</span></a>
<a class="sourceLine" id="cb262-2" title="2"><span class="kw">plot</span>(y<span class="op">~</span>x,<span class="dt">col=</span><span class="kw">as.numeric</span>(<span class="kw">as.factor</span>(z)),<span class="dt">data=</span>d4l,<span class="dt">pch=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb262-3" title="3"><span class="co">#completely independent regression lines</span></a>
<a class="sourceLine" id="cb262-4" title="4"><span class="kw">abline</span>(<span class="kw">lm</span>(y<span class="op">~</span>x,<span class="dt">data=</span>d4l[d4l<span class="op">$</span>z<span class="op">==</span><span class="st">&quot;a&quot;</span>,]),<span class="dt">col=</span><span class="dv">1</span>,<span class="dt">lty=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb262-5" title="5"><span class="kw">abline</span>(<span class="kw">lm</span>(y<span class="op">~</span>x,<span class="dt">data=</span>d4l[d4l<span class="op">$</span>z<span class="op">==</span><span class="st">&quot;b&quot;</span>,]),<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb262-6" title="6"><span class="kw">abline</span>(<span class="kw">lm</span>(y<span class="op">~</span>x,<span class="dt">data=</span>d4l[d4l<span class="op">$</span>z<span class="op">==</span><span class="st">&quot;c&quot;</span>,]),<span class="dt">col=</span><span class="dv">3</span>,<span class="dt">lty=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb262-7" title="7"><span class="kw">abline</span>(<span class="kw">lm</span>(y<span class="op">~</span>x,<span class="dt">data=</span>d4l[d4l<span class="op">$</span>z<span class="op">==</span><span class="st">&quot;d&quot;</span>,]),<span class="dt">col=</span><span class="dv">4</span>,<span class="dt">lty=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb262-8" title="8"><span class="co"># model with interaction lines</span></a>
<a class="sourceLine" id="cb262-9" title="9"><span class="kw">abline</span>(lmlinesI<span class="op">$</span>coefficients[<span class="dv">1</span>],lmlinesI<span class="op">$</span>coefficients[<span class="dv">2</span>],<span class="dt">col=</span><span class="dv">1</span>,<span class="dt">lty=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb262-10" title="10"><span class="kw">abline</span>(lmlinesI<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lmlinesI<span class="op">$</span>coefficients[<span class="dv">3</span>],lmlinesI<span class="op">$</span>coefficients[<span class="dv">2</span>]<span class="op">+</span>lmlinesI<span class="op">$</span>coefficients[<span class="dv">6</span>],<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb262-11" title="11"><span class="kw">abline</span>(lmlinesI<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lmlinesI<span class="op">$</span>coefficients[<span class="dv">4</span>],lmlinesI<span class="op">$</span>coefficients[<span class="dv">2</span>]<span class="op">+</span>lmlinesI<span class="op">$</span>coefficients[<span class="dv">7</span>],<span class="dt">col=</span><span class="dv">3</span>,<span class="dt">lty=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb262-12" title="12"><span class="kw">abline</span>(lmlinesI<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lmlinesI<span class="op">$</span>coefficients[<span class="dv">5</span>],lmlinesI<span class="op">$</span>coefficients[<span class="dv">2</span>]<span class="op">+</span>lmlinesI<span class="op">$</span>coefficients[<span class="dv">8</span>],<span class="dt">col=</span><span class="dv">4</span>,<span class="dt">lty=</span><span class="dv">5</span>)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-144-1.png" width="672" /></p>
<p>It is interesting to see that they are not very different, which is perhaps surprising but… actually… not surprising. Both use exaclty 8 parameters to describe the data… it’s the same thing!!! Linear models are cool :)</p>
<p>OK, I have completely forgoten about Carlos and Conceição… or maybe it’s too late and I am just sleepy. But if the right model for <em>Barbus sclatery</em>, which happens to correspond to the “green” species, is the one based on the interaction term, then… the fish weight might be 283.6, as shown below.</p>
<p>Carlos might have something to present at the congress after all! He goes to sleep, happy. As he is starting to dream with his “best talk” award he still manages to hear Conceição saying something in the distance like “… have you… considered… variability … prediction… maybe not realy larger than 220 gr…”. The last thought that goes through his mind before the dream turns into a nightmare where he is on that congress naked is… “Why did I married that woman”?</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb263-1" title="1"><span class="co">#plot all the data</span></a>
<a class="sourceLine" id="cb263-2" title="2"><span class="kw">plot</span>(y<span class="op">~</span>x,<span class="dt">col=</span><span class="kw">as.numeric</span>(<span class="kw">as.factor</span>(z)),<span class="dt">data=</span>d4l,<span class="dt">pch=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb263-3" title="3"><span class="co">#completely independent regression lines</span></a>
<a class="sourceLine" id="cb263-4" title="4"><span class="kw">abline</span>(lmlinesI<span class="op">$</span>coefficients[<span class="dv">1</span>],lmlinesI<span class="op">$</span>coefficients[<span class="dv">2</span>],<span class="dt">col=</span><span class="dv">1</span>,<span class="dt">lty=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb263-5" title="5"><span class="kw">abline</span>(lmlinesI<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lmlinesI<span class="op">$</span>coefficients[<span class="dv">3</span>],lmlinesI<span class="op">$</span>coefficients[<span class="dv">2</span>]<span class="op">+</span>lmlinesI<span class="op">$</span>coefficients[<span class="dv">6</span>],<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb263-6" title="6"><span class="kw">abline</span>(lmlinesI<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lmlinesI<span class="op">$</span>coefficients[<span class="dv">4</span>],lmlinesI<span class="op">$</span>coefficients[<span class="dv">2</span>]<span class="op">+</span>lmlinesI<span class="op">$</span>coefficients[<span class="dv">7</span>],<span class="dt">col=</span><span class="dv">3</span>,<span class="dt">lty=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb263-7" title="7"><span class="kw">abline</span>(lmlinesI<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lmlinesI<span class="op">$</span>coefficients[<span class="dv">5</span>],lmlinesI<span class="op">$</span>coefficients[<span class="dv">2</span>]<span class="op">+</span>lmlinesI<span class="op">$</span>coefficients[<span class="dv">8</span>],<span class="dt">col=</span><span class="dv">4</span>,<span class="dt">lty=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb263-8" title="8"><span class="kw">abline</span>(<span class="dt">v=</span><span class="dv">300</span>,<span class="dt">h=</span>lmlinesI<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span>lmlinesI<span class="op">$</span>coefficients[<span class="dv">4</span>]<span class="op">+</span>(lmlinesI<span class="op">$</span>coefficients[<span class="dv">2</span>]<span class="op">+</span>lmlinesI<span class="op">$</span>coefficients[<span class="dv">7</span>])<span class="op">*</span>sizeo,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-145-1.png" width="672" /></p>
<p>FFS !</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="aula10.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="aula13.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ECOMODbook.pdf", "ECOMODbook.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
