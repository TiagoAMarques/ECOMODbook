<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Class 6 13 10 2020 | Notes for Ecological Modelling</title>
  <meta name="description" content="This is based on Yihui Xie’s a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Class 6 13 10 2020 | Notes for Ecological Modelling" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is based on Yihui Xie’s a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Class 6 13 10 2020 | Notes for Ecological Modelling" />
  
  <meta name="twitter:description" content="This is based on Yihui Xie’s a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Tiago A. Marques" />


<meta name="date" content="2020-11-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="handson.html"/>
<link rel="next" href="aula7.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="mainintro.html"><a href="mainintro.html"><i class="fa fa-check"></i><b>2</b> Preamble</a></li>
<li class="chapter" data-level="3" data-path="aknowledgments.html"><a href="aknowledgments.html"><i class="fa fa-check"></i><b>3</b> Aknowledgments</a></li>
<li class="chapter" data-level="4" data-path="usingRintro.html"><a href="usingRintro.html"><i class="fa fa-check"></i><b>4</b> Using R</a></li>
<li class="chapter" data-level="5" data-path="about-regression.html"><a href="about-regression.html"><i class="fa fa-check"></i><b>5</b> About regression</a><ul>
<li class="chapter" data-level="5.1" data-path="about-regression.html"><a href="about-regression.html#what-is-a-regression"><i class="fa fa-check"></i><b>5.1</b> What is a regression?</a></li>
<li class="chapter" data-level="5.2" data-path="about-regression.html"><a href="about-regression.html#the-general-linear-model"><i class="fa fa-check"></i><b>5.2</b> The general linear model</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="handson.html"><a href="handson.html"><i class="fa fa-check"></i><b>6</b> Hands On Regression</a><ul>
<li class="chapter" data-level="6.1" data-path="handson.html"><a href="handson.html#the-assumptions-are-on-the-residuals-not-the-data"><i class="fa fa-check"></i><b>6.1</b> The assumptions are on the residuals, not the data</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="aula6.html"><a href="aula6.html"><i class="fa fa-check"></i><b>7</b> Class 6 13 10 2020</a><ul>
<li class="chapter" data-level="7.1" data-path="aula6.html"><a href="aula6.html#implementing-a-regression"><i class="fa fa-check"></i><b>7.1</b> Implementing a regression</a></li>
<li class="chapter" data-level="7.2" data-path="aula6.html"><a href="aula6.html#simulating-regression-data"><i class="fa fa-check"></i><b>7.2</b> Simulating regression data</a><ul>
<li class="chapter" data-level="7.2.1" data-path="aula6.html"><a href="aula6.html#what-is-the-effect-of-increasing-the-error-a-simulation-experiment"><i class="fa fa-check"></i><b>7.2.1</b> What is the effect of increasing the error: a simulation experiment</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="aula7.html"><a href="aula7.html"><i class="fa fa-check"></i><b>8</b> Class 7 14 10 2020</a><ul>
<li class="chapter" data-level="8.1" data-path="aula7.html"><a href="aula7.html#task-1"><i class="fa fa-check"></i><b>8.1</b> Task 1</a></li>
<li class="chapter" data-level="8.2" data-path="aula7.html"><a href="aula7.html#task-2"><i class="fa fa-check"></i><b>8.2</b> Task 2</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="aula8.html"><a href="aula8.html"><i class="fa fa-check"></i><b>9</b> Class 8 20 10 2020 - t-test and ANOVA are just linear models</a><ul>
<li class="chapter" data-level="9.1" data-path="aula8.html"><a href="aula8.html#the-t-test"><i class="fa fa-check"></i><b>9.1</b> The t-test</a></li>
<li class="chapter" data-level="9.2" data-path="aula8.html"><a href="aula8.html#anova"><i class="fa fa-check"></i><b>9.2</b> ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="aula9.html"><a href="aula9.html"><i class="fa fa-check"></i><b>10</b> Class 9: 21 10 2020 - ANCOVA is (also) just a linear model</a><ul>
<li class="chapter" data-level="10.1" data-path="aula9.html"><a href="aula9.html#common-slope-different-intercepts-per-treatment"><i class="fa fa-check"></i><b>10.1</b> Common slope, different intercepts per treatment</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="aula10.html"><a href="aula10.html"><i class="fa fa-check"></i><b>11</b> Class 10: 27 10 2020</a><ul>
<li class="chapter" data-level="11.1" data-path="aula10.html"><a href="aula10.html#same-story-another-spin"><i class="fa fa-check"></i><b>11.1</b> Same story, another spin</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="aula11.html"><a href="aula11.html"><i class="fa fa-check"></i><b>12</b> Class 11: 03 11 2020 ANCOVA with different slopes: interactions</a><ul>
<li class="chapter" data-level="12.1" data-path="aula11.html"><a href="aula11.html#about-interactions"><i class="fa fa-check"></i><b>12.1</b> About interactions</a></li>
<li class="chapter" data-level="12.2" data-path="aula11.html"><a href="aula11.html#task-1-implementing-the-ancova-with-different-slopes"><i class="fa fa-check"></i><b>12.2</b> Task 1 Implementing the ANCOVA with different slopes</a></li>
<li class="chapter" data-level="12.3" data-path="aula11.html"><a href="aula11.html#task-2-modeling-a-data-set"><i class="fa fa-check"></i><b>12.3</b> Task 2 Modeling a data set</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="aula13.html"><a href="aula13.html"><i class="fa fa-check"></i><b>13</b> Class 12: 04 11 2020 Interactions between continous covariates</a><ul>
<li class="chapter" data-level="13.1" data-path="aula13.html"><a href="aula13.html#larger-order-interactions"><i class="fa fa-check"></i><b>13.1</b> Larger order interactions</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="conlusion-on-linear-regression.html"><a href="conlusion-on-linear-regression.html"><i class="fa fa-check"></i><b>14</b> Conlusion on linear regression</a><ul>
<li class="chapter" data-level="14.1" data-path="conlusion-on-linear-regression.html"><a href="conlusion-on-linear-regression.html#conclusion"><i class="fa fa-check"></i><b>14.1</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="aula12.html"><a href="aula12.html"><i class="fa fa-check"></i><b>15</b> Class 13: 10 11 2020 Maximum likelihood and all that</a><ul>
<li class="chapter" data-level="15.1" data-path="aula12.html"><a href="aula12.html#maximizing-a-likelihood-algebraically"><i class="fa fa-check"></i><b>15.1</b> Maximizing a likelihood algebraically</a></li>
<li class="chapter" data-level="15.2" data-path="aula12.html"><a href="aula12.html#numerically-maximizing-a-likelihood"><i class="fa fa-check"></i><b>15.2</b> Numerically Maximizing a likelihood</a></li>
<li class="chapter" data-level="15.3" data-path="aula12.html"><a href="aula12.html#the-case-of-a-gaussian"><i class="fa fa-check"></i><b>15.3</b> The case of a Gaussian</a></li>
<li class="chapter" data-level="15.4" data-path="aula12.html"><a href="aula12.html#the-case-of-a-linear-model"><i class="fa fa-check"></i><b>15.4</b> The case of a linear model</a></li>
<li class="chapter" data-level="15.5" data-path="aula12.html"><a href="aula12.html#the-really-interesting-case"><i class="fa fa-check"></i><b>15.5</b> The really interesting case</a></li>
<li class="chapter" data-level="15.6" data-path="aula12.html"><a href="aula12.html#likelihood-above-and-beyond"><i class="fa fa-check"></i><b>15.6</b> Likelihood, above and beyond</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="aula14.html"><a href="aula14.html"><i class="fa fa-check"></i><b>16</b> Class 14: 10 10 2020 GLMs</a><ul>
<li class="chapter" data-level="16.1" data-path="aula14.html"><a href="aula14.html#what-are-glms"><i class="fa fa-check"></i><b>16.1</b> What are GLMs</a></li>
<li class="chapter" data-level="16.2" data-path="aula14.html"><a href="aula14.html#an-example-analysis"><i class="fa fa-check"></i><b>16.2</b> An example analysis</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="aula15.html"><a href="aula15.html"><i class="fa fa-check"></i><b>17</b> Class 15: 11 11 2020</a></li>
<li class="chapter" data-level="18" data-path="aula16.html"><a href="aula16.html"><i class="fa fa-check"></i><b>18</b> Class 16: 17 11 2020</a></li>
<li class="chapter" data-level="19" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>19</b> Final Words</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes for Ecological Modelling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="aula6" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Class 6 13 10 2020</h1>
<div id="implementing-a-regression" class="section level2">
<h2><span class="header-section-number">7.1</span> Implementing a regression</h2>
<p>We begin by reading the data in “lagartos.txt” and fitting a regression model to it.</p>
<p>Read the data in</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co">#folder&lt;-&quot;../Aula6 13 10 2020/&quot;</span></a>
<a class="sourceLine" id="cb11-2" title="2">folder&lt;-<span class="st">&quot;extfiles/&quot;</span></a>
<a class="sourceLine" id="cb11-3" title="3">lagartos &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file=</span><span class="kw">paste0</span>(folder,<span class="st">&quot;lagartos.txt&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb11-4" title="4">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(lagartos)</a></code></pre></div>
<p>We see that we have 97 observations.</p>
<p>Plot the data</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">with</span>(lagartos,<span class="kw">plot</span>(peso<span class="op">~</span>comp))</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a6.2-1.png" width="672" /></p>
<p>A linear model seems adequate. Lets fit a regression line to the data</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">lmlag &lt;-<span class="st"> </span><span class="kw">lm</span>(peso<span class="op">~</span>comp,<span class="dt">data=</span>lagartos)</a>
<a class="sourceLine" id="cb13-2" title="2"><span class="kw">summary</span>(lmlag)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = peso ~ comp, data = lagartos)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -6.5199 -1.6961  0.3495  1.7490  4.7127 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 11.72234    0.72299   16.21   &lt;2e-16 ***
## comp         1.20233    0.05402   22.26   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.415 on 95 degrees of freedom
## Multiple R-squared:  0.8391,	Adjusted R-squared:  0.8374 
## F-statistic: 495.3 on 1 and 95 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Remember that a linear model is just a special GLM:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">glmlag &lt;-<span class="st"> </span><span class="kw">glm</span>(peso<span class="op">~</span>comp,<span class="dt">data=</span>lagartos,<span class="dt">family=</span><span class="kw">gaussian</span>(<span class="dt">link=</span><span class="st">&quot;identity&quot;</span>))</a>
<a class="sourceLine" id="cb15-2" title="2"><span class="kw">summary</span>(glmlag)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = peso ~ comp, family = gaussian(link = &quot;identity&quot;), 
##     data = lagartos)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -6.5199  -1.6961   0.3495   1.7490   4.7127  
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 11.72234    0.72299   16.21   &lt;2e-16 ***
## comp         1.20233    0.05402   22.26   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for gaussian family taken to be 5.830492)
## 
##     Null deviance: 3441.8  on 96  degrees of freedom
## Residual deviance:  553.9  on 95  degrees of freedom
## AIC: 450.27
## 
## Number of Fisher Scoring iterations: 2</code></pre>
<p>as we can see the output looks a bit different (after all, <code>lm</code> and <code>glm</code> are different functions!), but the results are exactly the same. This does not prove it, but it illustrates by example that a lm is just a GLM with a Gaussian response and an <code>identity</code> link function.</p>
<p>Lets use the results from <code>lm</code>, while noting that everything else would be the same.</p>
<p>The estimated regression line is</p>
<p>peso =11.72 +1.2 <span class="math inline">\(\times\)</span> comp</p>
<p>and the estimated R-squared is 0.84. The standard error associated with the model is estimated to be 2.4146. Below we explain what each of these values correspond to.</p>
<p>The estimated standard error corresponds to the standard deviation of the residuals of the model, that is, the diference between the observations and the predicted values given the model.</p>
<p>The observation we have already, those are the <code>peso</code>. We can obtain the predicted <code>peso</code> for each observation with the function <code>predict</code>, but here we do it manually so that we see that the errors are just the observations minus the predictions.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="co">#get estimated values</span></a>
<a class="sourceLine" id="cb17-2" title="2">estimated&lt;-<span class="kw">with</span>(lagartos,<span class="kw">summary</span>(lmlag)<span class="op">$</span>coefficients[<span class="dv">1</span>]<span class="op">+</span><span class="kw">summary</span>(lmlag)<span class="op">$</span>coefficients[<span class="dv">2</span>]<span class="op">*</span>comp)</a>
<a class="sourceLine" id="cb17-3" title="3"><span class="co"># note this would be the same as</span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="co"># estimated&lt;-predict(lmlag)</span></a></code></pre></div>
<p>Now we can compute the residuals and their corresponding standard error</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="co">#get residuals</span></a>
<a class="sourceLine" id="cb18-2" title="2"><span class="co">#erros = observações - valores previstos</span></a>
<a class="sourceLine" id="cb18-3" title="3"><span class="co"># e= y- (a+bx)</span></a>
<a class="sourceLine" id="cb18-4" title="4"><span class="co"># y= (a+bx) + e</span></a>
<a class="sourceLine" id="cb18-5" title="5">resid&lt;-lagartos<span class="op">$</span>peso<span class="op">-</span>estimated</a>
<a class="sourceLine" id="cb18-6" title="6"><span class="kw">sd</span>(resid)</a></code></pre></div>
<pre><code>## [1] 2.402032</code></pre>
<p>Note as predict, we could use just the function <code>residuals</code> with the model object as argument to get us the residuals in a single line of code.</p>
<p>The reason the above standard error is not exactly the same as in the model output above has to do with the degrees of freedom, a concepth that is hard to explain in this applied context, but relates to the number of available independent bits of information available. So turst me when I say that we loose a degree of freedom for each parameter estimated in a model. The exact value of the standard deviation as estimated in the model must account for that loss of one extra degree of freedom (associated with estimating the slope of the line), and so the standard formula of the <code>sd</code> needs to be adjusted for the lost degree of freedom, like this:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="co">#Residual Standard error (Like Standard Deviation)</span></a>
<a class="sourceLine" id="cb20-2" title="2"><span class="co">#the right way</span></a>
<a class="sourceLine" id="cb20-3" title="3"><span class="co">#Subtract one to ignore intercept</span></a>
<a class="sourceLine" id="cb20-4" title="4">k=<span class="kw">length</span>(lmlag<span class="op">$</span>coefficients)<span class="op">-</span><span class="dv">1</span> </a>
<a class="sourceLine" id="cb20-5" title="5"><span class="co">#get the error sum of squares</span></a>
<a class="sourceLine" id="cb20-6" title="6">SSE=<span class="kw">sum</span>(lmlag<span class="op">$</span>residuals<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb20-7" title="7"><span class="co">#Residual Standard Error</span></a>
<a class="sourceLine" id="cb20-8" title="8"><span class="kw">sqrt</span>(SSE<span class="op">/</span>(n<span class="op">-</span>(<span class="dv">1</span><span class="op">+</span>k))) </a></code></pre></div>
<pre><code>## [1] 2.414641</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="co">#equivalently</span></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="kw">sqrt</span>(<span class="kw">var</span>(resid)<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>(n<span class="dv">-2</span>))</a></code></pre></div>
<pre><code>## [1] 2.414641</code></pre>
<p>Now we get the exact same value as above: 2.4146412.</p>
<p>The <code>summary</code> of the model above is very useful, but nothing like adding the estimated model to the plot with the data. We can easily add the line to the plot with function <code>abline</code> (tip: note the ab in <code>abline</code> correspond to the <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> in <span class="math inline">\(y=a+bx\)</span>, but the function abline is “smart” enough to take an object of class <code>lm</code> and extract the corresponding <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> for plotting)</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="co">#with(lagartos,plot(peso~comp))</span></a>
<a class="sourceLine" id="cb24-2" title="2"><span class="kw">plot</span>(peso<span class="op">~</span>comp,<span class="dt">data=</span>lagartos)</a>
<a class="sourceLine" id="cb24-3" title="3"><span class="co">#these next 3 lines are equivalent</span></a>
<a class="sourceLine" id="cb24-4" title="4"><span class="kw">abline</span>(lmlag,<span class="dt">col=</span><span class="st">&quot;orange&quot;</span>)</a>
<a class="sourceLine" id="cb24-5" title="5"><span class="kw">abline</span>(<span class="dt">a=</span><span class="fl">11.72234</span>,<span class="dt">b=</span><span class="fl">1.20233</span>,<span class="dt">col=</span><span class="st">&quot;pink&quot;</span>)</a>
<a class="sourceLine" id="cb24-6" title="6"><span class="co"># y = a + bx</span></a>
<a class="sourceLine" id="cb24-7" title="7"><span class="kw">abline</span>(<span class="dt">a=</span><span class="kw">summary</span>(lmlag)<span class="op">$</span>coefficients[<span class="dv">1</span>,<span class="dv">1</span>],<span class="dt">b=</span><span class="kw">summary</span>(lmlag)<span class="op">$</span>coefficients[<span class="dv">2</span>,<span class="dv">1</span>],<span class="dt">col=</span><span class="st">&quot;brown&quot;</span>)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a6.9-1.png" width="672" /></p>
<p>Note the last line works because the parameter estimates are hold in a component of the <code>summary</code> of the fitted model called <code>coefficients</code></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">summary</span>(lmlag)<span class="op">$</span>coefficients</a></code></pre></div>
<pre><code>##              Estimate Std. Error  t value     Pr(&gt;|t|)
## (Intercept) 11.722343 0.72299153 16.21367 4.135172e-29
## comp         1.202333 0.05402397 22.25555 1.839784e-39</code></pre>
<p>Additionally, we can also add the residuals in the plot (we use the very handy function <code>segments</code>, that adds segments to plots, to do so)</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="co"># get estimated/predicted values with function residuals</span></a>
<a class="sourceLine" id="cb27-2" title="2">estimated2&lt;-<span class="kw">predict</span>(lmlag)</a>
<a class="sourceLine" id="cb27-3" title="3"><span class="co">#plot the data</span></a>
<a class="sourceLine" id="cb27-4" title="4"><span class="kw">with</span>(lagartos,<span class="kw">plot</span>(peso<span class="op">~</span>comp,<span class="dt">pch=</span><span class="dv">21</span>,<span class="dt">bg=</span><span class="st">&quot;brown&quot;</span>,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>))</a>
<a class="sourceLine" id="cb27-5" title="5"><span class="kw">abline</span>(lmlag,<span class="dt">col=</span><span class="dv">3</span>,<span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb27-6" title="6"><span class="co">#add residuals</span></a>
<a class="sourceLine" id="cb27-7" title="7"><span class="kw">with</span>(lagartos,<span class="kw">segments</span>(<span class="dt">x0 =</span> comp,<span class="dt">y0 =</span> peso, <span class="dt">x1=</span> comp, <span class="dt">y1=</span>estimated,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>))</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a6.11-1.png" width="672" /></p>
<p>The regression line is the line that minimizes the sum of the red distances in the plot above. That is also why it is called a minimum squares estimate in the special case of a Gaussian model (in PT, é a reta dos mínimos quadrados).</p>
<p>The residuals should, if the model is reasonable - and here that should be the case - be well approximated by a Gaussian distribution. Note we can get the values of the residuals by the difference between the observations and the estimated values, as we did above. We can look at their histogram below</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="kw">hist</span>(resid,<span class="dt">main=</span><span class="st">&quot;Residuals by hand&quot;</span>,<span class="dt">freq=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb28-2" title="2"><span class="co">#adding the theorethical density of a Gaussian with mean 0 and the</span></a>
<a class="sourceLine" id="cb28-3" title="3"><span class="co">#correct standard error</span></a>
<a class="sourceLine" id="cb28-4" title="4"><span class="kw">lines</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">8</span>,<span class="dv">8</span>,<span class="dt">by=</span><span class="fl">0.1</span>),<span class="kw">dnorm</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">8</span>,<span class="dv">8</span>,<span class="dt">by=</span><span class="fl">0.1</span>),<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="kw">summary</span>(lmlag)<span class="op">$</span>sigma))</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a6.12-1.png" width="672" /></p>
<p>or alternatively we can use the bespoke function <code>residuals</code></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1">resid2&lt;-<span class="kw">residuals</span>(lmlag)</a>
<a class="sourceLine" id="cb29-2" title="2"><span class="kw">hist</span>(resid2,<span class="dt">main=</span><span class="st">&quot;Residuals by function residuals&quot;</span>)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a6.13-1.png" width="672" /></p>
<p>It is often said that the <span class="math inline">\(R^2\)</span> represents the amount of variation in the response that the regression explains. Why is that?</p>
<p>Because if you assume that all the variability in the response data, the <span class="math inline">\(y_i\)</span> the diference between the data points and a common mean</p>
<p><span class="math display">\[\sum_{i=1}^n (y_i- \bar y)^2\]</span></p>
<p>in an image, the sum of the square of these quantities</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="co">#plot</span></a>
<a class="sourceLine" id="cb30-2" title="2"><span class="kw">with</span>(lagartos,<span class="kw">plot</span>(peso<span class="op">~</span>comp))</a>
<a class="sourceLine" id="cb30-3" title="3"><span class="kw">abline</span>(lmlag,<span class="dt">col=</span><span class="dv">3</span>,<span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb30-4" title="4"><span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">mean</span>(lagartos<span class="op">$</span>peso))</a>
<a class="sourceLine" id="cb30-5" title="5"><span class="kw">with</span>(lagartos,<span class="kw">segments</span>(<span class="dt">x0 =</span> comp,<span class="dt">y0 =</span> peso, <span class="dt">x1=</span> comp, <span class="dt">y1=</span><span class="kw">mean</span>(peso),<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">2</span>))</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a6.14-1.png" width="672" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1">all.var&lt;-<span class="kw">sum</span>((lagartos<span class="op">$</span>peso<span class="op">-</span><span class="kw">mean</span>(lagartos<span class="op">$</span>peso))<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb31-2" title="2">all.var</a></code></pre></div>
<pre><code>## [1] 3441.795</code></pre>
<p>and the variability that is not explained is the one that remains in the errors (the corresponding plot was shown above)</p>
<p><span class="math display">\[\sum_{i=1}^n (y_i- \hat y_i)^2\]</span></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1">error.var&lt;-<span class="kw">sum</span>((lagartos<span class="op">$</span>peso<span class="op">-</span>estimated)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb33-2" title="2">error.var</a></code></pre></div>
<pre><code>## [1] 553.8968</code></pre>
<p>then the ratio of those two quantities is what is NOT explained by the regression model, and therefore, 1 minus that is what explained by the regression model.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="dv">1</span><span class="op">-</span>error.var<span class="op">/</span>all.var</a></code></pre></div>
<pre><code>## [1] 0.8390675</code></pre>
<p>And that… as noted above… is the <span class="math inline">\(R^2\)</span>=0.8391. This comes from the fact that all of the variability in the data (the <span class="math inline">\(y\)</span>, the response, here the <code>peso</code>) can be decomposed into the variability explained by the model, and the unexplained variability, that of the errors. In a formula</p>
<p><span class="math display">\[SS_{TOTAL}=SS_{REGRESSÃO}+SS_{ERRO}\]</span></p>
<p>Note naturally we could also represent in an image what is explained by the regression model, which is</p>
<p><span class="math display">\[\sum_{i=1}^n (\hat y_i- \bar y)^2\]</span></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="co">#plot</span></a>
<a class="sourceLine" id="cb37-2" title="2"><span class="kw">with</span>(lagartos,<span class="kw">plot</span>(peso<span class="op">~</span>comp))</a>
<a class="sourceLine" id="cb37-3" title="3"><span class="kw">abline</span>(lmlag,<span class="dt">col=</span><span class="dv">3</span>,<span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb37-4" title="4"><span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">mean</span>(lagartos<span class="op">$</span>peso))</a>
<a class="sourceLine" id="cb37-5" title="5"><span class="kw">with</span>(lagartos,<span class="kw">segments</span>(<span class="dt">x0 =</span> comp,<span class="dt">y0 =</span> estimated, <span class="dt">x1=</span> comp, <span class="dt">y1=</span><span class="kw">mean</span>(peso),<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">2</span>))</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a6.18-1.png" width="672" /></p>
<p>and that naturally is obtained as</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1">reg.var&lt;-<span class="kw">sum</span>((<span class="kw">mean</span>(lagartos<span class="op">$</span>peso)<span class="op">-</span>estimated)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb38-2" title="2">reg.var</a></code></pre></div>
<pre><code>## [1] 2887.898</code></pre>
<p>and hence the total variability is given by the sum <span class="math inline">\(SS_{REGRESSÃO}+SS_{ERRO}\)</span></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1">reg.var<span class="op">+</span>error.var</a></code></pre></div>
<pre><code>## [1] 3441.795</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">all.var</a></code></pre></div>
<pre><code>## [1] 3441.795</code></pre>
<p>So, always remember that</p>
<p><span class="math display">\[SS_{TOTAL}=SS_{REGRESSÃO}+SS_{ERRO}\]</span></p>
<p>This is also something that comes out often in books without a clear explanation of the reaon why that holds. While here I show it by example, it could be easily demonstrated algebraically if one wanted that</p>
<p><span class="math display">\[\sum_{i=1}^n (y_i- \bar y)^2=\sum_{i=1}^n (\hat y_i- \bar y)^2 + \sum_{i=1}^n (y_i- \hat y_i)^2\]</span></p>
<p>If you want that, this 28 minute video shows you the proof: <a href="https://www.youtube.com/watch?v=aQ32qTjqqJM" class="uri">https://www.youtube.com/watch?v=aQ32qTjqqJM</a>
I think it could take just 5 minutes ;) but many thanks to Dmitry Leiderman for having it out there! He does it in the context of ANOVA, but ANOVA is just a special case of regression, were you have a continous response and a single categorical explanatory variable. Therefore, have fun !</p>
</div>
<div id="simulating-regression-data" class="section level2">
<h2><span class="header-section-number">7.2</span> Simulating regression data</h2>
<p>Using the above, simulate data assuming that the TRUE relation between the weight and length of a lizzard was given by</p>
<p><span class="math display">\[ peso = 12 + 1.2 * comp \]</span></p>
<p>We consider that the usual length of a lizard can be between 5 and 20 cm, and the standard error is 4.</p>
<p>As in the data we will have 97 lizards</p>
<p>Then you were told to create the lengths:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="kw">set.seed</span>(<span class="dv">121</span>)</a>
<a class="sourceLine" id="cb44-2" title="2">n=<span class="dv">97</span></a>
<a class="sourceLine" id="cb44-3" title="3"><span class="co">#lengths</span></a>
<a class="sourceLine" id="cb44-4" title="4">xs=<span class="kw">runif</span>(n,<span class="dv">5</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb44-5" title="5"><span class="kw">hist</span>(xs,<span class="dt">main=</span><span class="st">&quot;Lenths (cm)&quot;</span>)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a6.21-1.png" width="672" /></p>
<p>and then to create weights of lizards</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1">a=<span class="dv">12</span></a>
<a class="sourceLine" id="cb45-2" title="2">b=<span class="fl">1.2</span></a>
<a class="sourceLine" id="cb45-3" title="3">ys=a<span class="op">+</span>b<span class="op">*</span>xs</a></code></pre></div>
<p>If we plot the data, all points are in a single line. Why, because there is no randomness.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1"><span class="kw">plot</span>(xs,ys)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a6.23-1.png" width="672" /></p>
<p>This means that if you try to run a model, it gives you a warning that the model might be unreliable</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"><span class="kw">summary</span>(<span class="kw">lm</span>(ys<span class="op">~</span>xs))</a></code></pre></div>
<pre><code>## Warning in summary.lm(lm(ys ~ xs)): essentially perfect fit: summary may be
## unreliable</code></pre>
<pre><code>## 
## Call:
## lm(formula = ys ~ xs)
## 
## Residuals:
##        Min         1Q     Median         3Q        Max 
## -5.595e-15 -2.460e-15 -1.878e-15 -1.422e-15  1.873e-13 
## 
## Coefficients:
##              Estimate Std. Error   t value Pr(&gt;|t|)    
## (Intercept) 1.200e+01  6.050e-15 1.983e+15   &lt;2e-16 ***
## xs          1.200e+00  4.611e-16 2.603e+15   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.934e-14 on 95 degrees of freedom
## Multiple R-squared:      1,	Adjusted R-squared:      1 
## F-statistic: 6.773e+30 on 1 and 95 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>So… , we add some variance, and plot the data:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1">ys=a<span class="op">+</span>b<span class="op">*</span>xs<span class="op">+</span><span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb50-2" title="2"><span class="kw">plot</span>(xs,ys)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a6.25-1.png" width="672" /></p>
<p>Using the code above, experiment with changing the standard deviation of the error, and see what happens to the estimated <span class="math inline">\(R^2\)</span>, to the parameter estimates, to the estimated error, and to how close the estimated regression mode is to the true model (note this is the amazing advantage of a simulation, which we do not have in real data, we know what reality is, and a true model exists!). This will give you a good feeling for what a regression model is and what is does, and what it can’t do. An example of what it can’t give you is reliable estimates when the error is large compared to the systematic part of the model.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1">n &lt;-<span class="st"> </span><span class="dv">97</span></a>
<a class="sourceLine" id="cb51-2" title="2"><span class="co">#simular comprimentos</span></a>
<a class="sourceLine" id="cb51-3" title="3">comp.sim &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="dv">5</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb51-4" title="4">a&lt;-<span class="dv">12</span></a>
<a class="sourceLine" id="cb51-5" title="5">b&lt;-<span class="fl">1.2</span></a>
<a class="sourceLine" id="cb51-6" title="6"><span class="co">#simular pesos</span></a>
<a class="sourceLine" id="cb51-7" title="7">peso.sim&lt;-a<span class="op">+</span>b<span class="op">*</span>comp.sim<span class="op">+</span><span class="kw">rnorm</span>(n,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb51-8" title="8">data.sim=<span class="kw">data.frame</span>(<span class="dt">csim=</span>comp.sim,<span class="dt">psim=</span>peso.sim)</a>
<a class="sourceLine" id="cb51-9" title="9"><span class="kw">plot</span>(psim<span class="op">~</span>csim,<span class="dt">data=</span>data.sim)</a>
<a class="sourceLine" id="cb51-10" title="10">mod.sim&lt;-<span class="kw">lm</span>(psim<span class="op">~</span>csim,<span class="dt">data=</span>data.sim)</a>
<a class="sourceLine" id="cb51-11" title="11"><span class="kw">abline</span>(mod.sim,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb51-12" title="12"><span class="kw">summary</span>(mod.sim)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = psim ~ csim, data = data.sim)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.3460 -1.1652  0.1329  1.5072  3.0036 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 11.70390    0.56783   20.61   &lt;2e-16 ***
## csim         1.20912    0.04325   27.96   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.822 on 95 degrees of freedom
## Multiple R-squared:  0.8916,	Adjusted R-squared:  0.8905 
## F-statistic: 781.6 on 1 and 95 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="kw">abline</span>(a,b,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</a>
<a class="sourceLine" id="cb53-2" title="2"><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;Estimated line&quot;</span>,<span class="st">&quot;True model&quot;</span>),<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;green&quot;</span>),<span class="dt">lty=</span><span class="dv">1</span>,<span class="dt">inset=</span><span class="fl">0.05</span>)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a6.26-1.png" width="672" /></p>
<div id="what-is-the-effect-of-increasing-the-error-a-simulation-experiment" class="section level3">
<h3><span class="header-section-number">7.2.1</span> What is the effect of increasing the error: a simulation experiment</h3>
<p>Now, let’s consider there’s more and less variance. We also add to each plot the real line (that with the true parameter values) and the one with the estimated parameter values.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb54-2" title="2">ys=a<span class="op">+</span>b<span class="op">*</span>xs<span class="op">+</span><span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb54-3" title="3"><span class="kw">plot</span>(xs,ys)</a>
<a class="sourceLine" id="cb54-4" title="4">mod1=<span class="kw">lm</span>(ys<span class="op">~</span>xs)</a>
<a class="sourceLine" id="cb54-5" title="5"><span class="kw">abline</span>(mod1,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb54-6" title="6"><span class="kw">abline</span>(a,b,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</a>
<a class="sourceLine" id="cb54-7" title="7">ys=a<span class="op">+</span>b<span class="op">*</span>xs<span class="op">+</span><span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb54-8" title="8"><span class="kw">plot</span>(xs,ys)</a>
<a class="sourceLine" id="cb54-9" title="9">mod2=<span class="kw">lm</span>(ys<span class="op">~</span>xs)</a>
<a class="sourceLine" id="cb54-10" title="10"><span class="kw">abline</span>(mod2,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb54-11" title="11"><span class="kw">abline</span>(a,b,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</a>
<a class="sourceLine" id="cb54-12" title="12">ys=a<span class="op">+</span>b<span class="op">*</span>xs<span class="op">+</span><span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb54-13" title="13"><span class="kw">plot</span>(xs,ys)</a>
<a class="sourceLine" id="cb54-14" title="14">mod4=<span class="kw">lm</span>(ys<span class="op">~</span>xs)</a>
<a class="sourceLine" id="cb54-15" title="15"><span class="kw">abline</span>(mod4,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb54-16" title="16"><span class="kw">abline</span>(a,b,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</a>
<a class="sourceLine" id="cb54-17" title="17">ys=a<span class="op">+</span>b<span class="op">*</span>xs<span class="op">+</span><span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb54-18" title="18"><span class="kw">plot</span>(xs,ys)</a>
<a class="sourceLine" id="cb54-19" title="19">mod10=<span class="kw">lm</span>(ys<span class="op">~</span>xs)</a>
<a class="sourceLine" id="cb54-20" title="20"><span class="kw">abline</span>(mod10,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb54-21" title="21"><span class="kw">abline</span>(a,b,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</a>
<a class="sourceLine" id="cb54-22" title="22">ys=a<span class="op">+</span>b<span class="op">*</span>xs<span class="op">+</span><span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb54-23" title="23"><span class="kw">plot</span>(xs,ys)</a>
<a class="sourceLine" id="cb54-24" title="24">mod20=<span class="kw">lm</span>(ys<span class="op">~</span>xs)</a>
<a class="sourceLine" id="cb54-25" title="25"><span class="kw">abline</span>(mod20,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb54-26" title="26"><span class="kw">abline</span>(a,b,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</a>
<a class="sourceLine" id="cb54-27" title="27">ys=a<span class="op">+</span>b<span class="op">*</span>xs<span class="op">+</span><span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb54-28" title="28"><span class="kw">plot</span>(xs,ys)</a>
<a class="sourceLine" id="cb54-29" title="29">mod100=<span class="kw">lm</span>(ys<span class="op">~</span>xs)</a>
<a class="sourceLine" id="cb54-30" title="30"><span class="kw">abline</span>(mod100,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb54-31" title="31"><span class="kw">abline</span>(a,b,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a6.27-1.png" width="672" /></p>
<p>Not surprisingly, as the variance increases, we get data that more and more looks like it is not coming from a real linear process.</p>
<p>You can also look at the model summaries, and there you can see that, in fact, the models become essentially useless as the variance increases! You can see that both from the correlation, but also by the predictions generated from the model (comparing to the truth), and also the significance of the coefficients associated with the regression parameters.</p>
<p>Make no mistake, the reality is always the same, in terms of the fixed part of the model, it’s just the variance that increases.</p>
<p>Also, don’t get confused, the different green lines might look different, but they are always exactly the same line! You can check that by forcing the y axis to span the same limits.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb55-2" title="2">ys=a<span class="op">+</span>b<span class="op">*</span>xs<span class="op">+</span><span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb55-3" title="3"><span class="kw">plot</span>(xs,ys,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">400</span>,<span class="dv">400</span>))</a>
<a class="sourceLine" id="cb55-4" title="4">mod1=<span class="kw">lm</span>(ys<span class="op">~</span>xs)</a>
<a class="sourceLine" id="cb55-5" title="5"><span class="kw">abline</span>(mod1,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb55-6" title="6"><span class="kw">abline</span>(a,b,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</a>
<a class="sourceLine" id="cb55-7" title="7">ys=a<span class="op">+</span>b<span class="op">*</span>xs<span class="op">+</span><span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb55-8" title="8"><span class="kw">plot</span>(xs,ys,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">400</span>,<span class="dv">400</span>))</a>
<a class="sourceLine" id="cb55-9" title="9">mod2=<span class="kw">lm</span>(ys<span class="op">~</span>xs)</a>
<a class="sourceLine" id="cb55-10" title="10"><span class="kw">abline</span>(mod2,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb55-11" title="11"><span class="kw">abline</span>(a,b,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</a>
<a class="sourceLine" id="cb55-12" title="12">ys=a<span class="op">+</span>b<span class="op">*</span>xs<span class="op">+</span><span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb55-13" title="13"><span class="kw">plot</span>(xs,ys,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">400</span>,<span class="dv">400</span>))</a>
<a class="sourceLine" id="cb55-14" title="14">mod4=<span class="kw">lm</span>(ys<span class="op">~</span>xs)</a>
<a class="sourceLine" id="cb55-15" title="15"><span class="kw">abline</span>(mod4,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb55-16" title="16"><span class="kw">abline</span>(a,b,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</a>
<a class="sourceLine" id="cb55-17" title="17">ys=a<span class="op">+</span>b<span class="op">*</span>xs<span class="op">+</span><span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb55-18" title="18"><span class="kw">plot</span>(xs,ys,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">400</span>,<span class="dv">400</span>))</a>
<a class="sourceLine" id="cb55-19" title="19">mod10=<span class="kw">lm</span>(ys<span class="op">~</span>xs)</a>
<a class="sourceLine" id="cb55-20" title="20"><span class="kw">abline</span>(mod10,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb55-21" title="21"><span class="kw">abline</span>(a,b,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</a>
<a class="sourceLine" id="cb55-22" title="22">ys=a<span class="op">+</span>b<span class="op">*</span>xs<span class="op">+</span><span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb55-23" title="23"><span class="kw">plot</span>(xs,ys,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">400</span>,<span class="dv">400</span>))</a>
<a class="sourceLine" id="cb55-24" title="24">mod20=<span class="kw">lm</span>(ys<span class="op">~</span>xs)</a>
<a class="sourceLine" id="cb55-25" title="25"><span class="kw">abline</span>(mod20,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb55-26" title="26"><span class="kw">abline</span>(a,b,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</a>
<a class="sourceLine" id="cb55-27" title="27">ys=a<span class="op">+</span>b<span class="op">*</span>xs<span class="op">+</span><span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb55-28" title="28"><span class="kw">plot</span>(xs,ys,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">400</span>,<span class="dv">400</span>))</a>
<a class="sourceLine" id="cb55-29" title="29">mod100=<span class="kw">lm</span>(ys<span class="op">~</span>xs)</a>
<a class="sourceLine" id="cb55-30" title="30"><span class="kw">abline</span>(mod100,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb55-31" title="31"><span class="kw">abline</span>(a,b,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a6.28-1.png" width="672" /></p>
<p>but since then you loose all the ability to look at the actual data in some of the plots, that is not really that useful!</p>
<p>Below I look at the summary of each model. Look at correlations, at the estimated values for the parameters, their corresponding variances and the <span class="math inline">\(R^2\)</span>.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="kw">summary</span>(mod1)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ys ~ xs)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.87715 -0.62444  0.03329  0.69103  2.47244 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 12.24930    0.33691   36.36   &lt;2e-16 ***
## xs           1.18596    0.02568   46.19   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.077 on 95 degrees of freedom
## Multiple R-squared:  0.9574,	Adjusted R-squared:  0.9569 
## F-statistic:  2133 on 1 and 95 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="kw">summary</span>(mod2)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ys ~ xs)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.7122 -1.5245 -0.0731  1.5830  4.5457 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 11.22718    0.66606   16.86   &lt;2e-16 ***
## xs           1.26028    0.05076   24.83   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.129 on 95 degrees of freedom
## Multiple R-squared:  0.8665,	Adjusted R-squared:  0.8651 
## F-statistic: 616.4 on 1 and 95 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="kw">summary</span>(mod4)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ys ~ xs)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.8201 -2.6923  0.0809  2.8841 11.1413 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 12.93903    1.26042   10.27   &lt;2e-16 ***
## xs           1.11757    0.09606   11.63   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.028 on 95 degrees of freedom
## Multiple R-squared:  0.5876,	Adjusted R-squared:  0.5833 
## F-statistic: 135.4 on 1 and 95 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1"><span class="kw">summary</span>(mod10)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ys ~ xs)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -23.236  -6.053  -2.186   7.375  25.314 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  12.1949     3.0136   4.047 0.000106 ***
## xs            1.2102     0.2297   5.269 8.54e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 9.632 on 95 degrees of freedom
## Multiple R-squared:  0.2262,	Adjusted R-squared:  0.218 
## F-statistic: 27.76 on 1 and 95 DF,  p-value: 8.541e-07</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1"><span class="kw">summary</span>(mod20)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ys ~ xs)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -48.932 -16.093   1.632  13.610  55.287 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   9.2412     6.4002   1.444 0.152058    
## xs            1.6652     0.4878   3.414 0.000943 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 20.46 on 95 degrees of freedom
## Multiple R-squared:  0.1093,	Adjusted R-squared:  0.09991 
## F-statistic: 11.66 on 1 and 95 DF,  p-value: 0.0009426</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1"><span class="kw">summary</span>(mod100)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ys ~ xs)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -214.028  -69.887    0.743   60.602  255.109 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)  41.6496    30.0996   1.384    0.170
## xs           -0.5455     2.2939  -0.238    0.813
## 
## Residual standard error: 96.2 on 95 degrees of freedom
## Multiple R-squared:  0.0005949,	Adjusted R-squared:  -0.009925 
## F-statistic: 0.05655 on 1 and 95 DF,  p-value: 0.8126</code></pre>
<p>As an example, we can plot the <span class="math inline">\(R^2\)</span> as a function of the variance</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1"><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">100</span>),<span class="kw">c</span>(<span class="kw">summary</span>(mod1)<span class="op">$</span>r.squared,<span class="kw">summary</span>(mod2)<span class="op">$</span>r.squared,<span class="kw">summary</span>(mod4)<span class="op">$</span>r.squared,<span class="kw">summary</span>(mod10)<span class="op">$</span>r.squared,<span class="kw">summary</span>(mod20)<span class="op">$</span>r.squared,<span class="kw">summary</span>(mod100)<span class="op">$</span>r.squared))</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a6.30-1.png" width="672" /></p>
<p>That is quite interesting actually… There seems to be a nonlinear relationship, but we only have a sample size of six (different standard deviatios, i.e., variances, as variance is standard deviation squared), so hard to tell…</p>
<p>Let’s show off in R…</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1">sds=<span class="kw">seq</span>(<span class="fl">0.5</span>,<span class="dv">100</span>,<span class="dt">by=</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb69-2" title="2">nsds=<span class="kw">length</span>(sds)</a>
<a class="sourceLine" id="cb69-3" title="3"><span class="co">#an object to hold the correlations</span></a>
<a class="sourceLine" id="cb69-4" title="4">Rsqs=<span class="kw">numeric</span>(nsds)</a>
<a class="sourceLine" id="cb69-5" title="5"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nsds){</a>
<a class="sourceLine" id="cb69-6" title="6">  <span class="co">#create data</span></a>
<a class="sourceLine" id="cb69-7" title="7">  ys=a<span class="op">+</span>b<span class="op">*</span>xs<span class="op">+</span><span class="kw">rnorm</span>(n,<span class="dv">0</span>,sds[i])</a>
<a class="sourceLine" id="cb69-8" title="8">  <span class="co">#estimate model</span></a>
<a class="sourceLine" id="cb69-9" title="9">  modi=<span class="kw">lm</span>(ys<span class="op">~</span>xs)</a>
<a class="sourceLine" id="cb69-10" title="10">  <span class="co">#get R-squared</span></a>
<a class="sourceLine" id="cb69-11" title="11">  Rsqs[i]=<span class="kw">summary</span>(modi)<span class="op">$</span>r.squared</a>
<a class="sourceLine" id="cb69-12" title="12">}</a>
<a class="sourceLine" id="cb69-13" title="13"><span class="co">#and at the end... plot results</span></a>
<a class="sourceLine" id="cb69-14" title="14"><span class="kw">plot</span>(sds,Rsqs)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a6.31-1.png" width="672" /></p>
<p>How cool is that!! Actually, this means we can model the <span class="math inline">\(R^2\)</span> as a function of the original variance! But we would not be able to model it using a linear model…</p>
<p>You are not supposed to know about this yet, but I’ll continue to show off. Let’s use a GAM</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="kw">library</span>(mgcv)</a></code></pre></div>
<pre><code>## Loading required package: nlme</code></pre>
<pre><code>## This is mgcv 1.8-31. For overview type &#39;help(&quot;mgcv-package&quot;)&#39;.</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1">gam1=<span class="kw">gam</span>(Rsqs<span class="op">~</span><span class="kw">s</span>(sds),<span class="dt">link=</span>log)</a>
<a class="sourceLine" id="cb73-2" title="2"><span class="co">#make predictions to plot the estimated GAM model</span></a>
<a class="sourceLine" id="cb73-3" title="3">predRsqs=<span class="kw">predict.gam</span>(gam1,<span class="dt">newdata =</span> <span class="kw">list</span>(<span class="dt">sds=</span>sds),<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb73-4" title="4"><span class="kw">plot</span>(sds,Rsqs)</a>
<a class="sourceLine" id="cb73-5" title="5"><span class="kw">lines</span>(sds,predRsqs,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a6.32-1.png" width="672" /></p>
<p>Aha… remember what we talked in class today? It seems like we have overfitted. Then, I constrain the GAM.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1"><span class="kw">library</span>(mgcv)</a>
<a class="sourceLine" id="cb74-2" title="2">gam1=<span class="kw">gam</span>(Rsqs<span class="op">~</span><span class="kw">s</span>(sds,<span class="dt">k=</span><span class="dv">3</span>),<span class="dt">link=</span>log)</a>
<a class="sourceLine" id="cb74-3" title="3"><span class="co">#make predictions to plot the estimated GAM model</span></a>
<a class="sourceLine" id="cb74-4" title="4">predRsqs=<span class="kw">predict.gam</span>(gam1,<span class="dt">newdata =</span> <span class="kw">list</span>(<span class="dt">sds=</span>sds),<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb74-5" title="5"><span class="kw">plot</span>(sds,Rsqs)</a>
<a class="sourceLine" id="cb74-6" title="6"><span class="kw">lines</span>(sds,predRsqs,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a6.33-1.png" width="672" /></p>
<p>That was too much…</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1"><span class="kw">library</span>(mgcv)</a>
<a class="sourceLine" id="cb75-2" title="2">gam1=<span class="kw">gam</span>(Rsqs<span class="op">~</span><span class="kw">s</span>(sds,<span class="dt">k=</span><span class="dv">6</span>),<span class="dt">link=</span>log)</a>
<a class="sourceLine" id="cb75-3" title="3"><span class="co">#make predictions to plot the estimated GAM model</span></a>
<a class="sourceLine" id="cb75-4" title="4">predRsqs=<span class="kw">predict.gam</span>(gam1,<span class="dt">newdata =</span> <span class="kw">list</span>(<span class="dt">sds=</span>sds),<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb75-5" title="5"><span class="kw">plot</span>(sds,Rsqs)</a>
<a class="sourceLine" id="cb75-6" title="6"><span class="kw">lines</span>(sds,predRsqs,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/a6.34-1.png" width="672" /></p>
<p>That is already overfitting… conclusion, the GAM is not the right tool here :)</p>
<p>What is…? Well, stay tuned and one day you’ll learn!</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="handson.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="aula7.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ECOMODbook.pdf", "ECOMODbook.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
