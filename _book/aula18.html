<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 21 Class 18: 25 11 2020 | Notes for Ecological Modelling</title>
  <meta name="description" content="This is based on Yihui Xie’s a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 21 Class 18: 25 11 2020 | Notes for Ecological Modelling" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is based on Yihui Xie’s a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 21 Class 18: 25 11 2020 | Notes for Ecological Modelling" />
  
  <meta name="twitter:description" content="This is based on Yihui Xie’s a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Tiago A. Marques" />


<meta name="date" content="2020-12-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="aula17.html"/>
<link rel="next" href="aula19.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="mainintro.html"><a href="mainintro.html"><i class="fa fa-check"></i><b>2</b> Preamble</a></li>
<li class="chapter" data-level="3" data-path="aknowledgments.html"><a href="aknowledgments.html"><i class="fa fa-check"></i><b>3</b> Aknowledgments</a></li>
<li class="chapter" data-level="4" data-path="usingRintro.html"><a href="usingRintro.html"><i class="fa fa-check"></i><b>4</b> Using R</a></li>
<li class="chapter" data-level="5" data-path="prelim.html"><a href="prelim.html"><i class="fa fa-check"></i><b>5</b> Preliminaries</a></li>
<li class="chapter" data-level="6" data-path="about-regression.html"><a href="about-regression.html"><i class="fa fa-check"></i><b>6</b> About regression</a><ul>
<li class="chapter" data-level="6.1" data-path="about-regression.html"><a href="about-regression.html#what-is-a-regression"><i class="fa fa-check"></i><b>6.1</b> What is a regression?</a></li>
<li class="chapter" data-level="6.2" data-path="about-regression.html"><a href="about-regression.html#the-general-linear-model"><i class="fa fa-check"></i><b>6.2</b> The general linear model</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="handson.html"><a href="handson.html"><i class="fa fa-check"></i><b>7</b> Hands On Regression</a><ul>
<li class="chapter" data-level="7.1" data-path="handson.html"><a href="handson.html#the-assumptions-are-on-the-residuals-not-the-data"><i class="fa fa-check"></i><b>7.1</b> The assumptions are on the residuals, not the data</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="aula6.html"><a href="aula6.html"><i class="fa fa-check"></i><b>8</b> Class 6 13 10 2020</a><ul>
<li class="chapter" data-level="8.1" data-path="aula6.html"><a href="aula6.html#implementing-a-regression"><i class="fa fa-check"></i><b>8.1</b> Implementing a regression</a></li>
<li class="chapter" data-level="8.2" data-path="aula6.html"><a href="aula6.html#simulating-regression-data"><i class="fa fa-check"></i><b>8.2</b> Simulating regression data</a><ul>
<li class="chapter" data-level="8.2.1" data-path="aula6.html"><a href="aula6.html#what-is-the-effect-of-increasing-the-error-a-simulation-experiment"><i class="fa fa-check"></i><b>8.2.1</b> What is the effect of increasing the error: a simulation experiment</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="aula7.html"><a href="aula7.html"><i class="fa fa-check"></i><b>9</b> Class 7 14 10 2020</a><ul>
<li class="chapter" data-level="9.1" data-path="aula7.html"><a href="aula7.html#task-1"><i class="fa fa-check"></i><b>9.1</b> Task 1</a></li>
<li class="chapter" data-level="9.2" data-path="aula7.html"><a href="aula7.html#task-2"><i class="fa fa-check"></i><b>9.2</b> Task 2</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="aula8.html"><a href="aula8.html"><i class="fa fa-check"></i><b>10</b> Class 8 20 10 2020 - t-test and ANOVA are just linear models</a><ul>
<li class="chapter" data-level="10.1" data-path="aula8.html"><a href="aula8.html#the-t-test"><i class="fa fa-check"></i><b>10.1</b> The t-test</a></li>
<li class="chapter" data-level="10.2" data-path="aula8.html"><a href="aula8.html#anova"><i class="fa fa-check"></i><b>10.2</b> ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="aula9.html"><a href="aula9.html"><i class="fa fa-check"></i><b>11</b> Class 9: 21 10 2020 - ANCOVA is (also) just a linear model</a><ul>
<li class="chapter" data-level="11.1" data-path="aula9.html"><a href="aula9.html#common-slope-different-intercepts-per-treatment"><i class="fa fa-check"></i><b>11.1</b> Common slope, different intercepts per treatment</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="aula10.html"><a href="aula10.html"><i class="fa fa-check"></i><b>12</b> Class 10: 27 10 2020</a><ul>
<li class="chapter" data-level="12.1" data-path="aula10.html"><a href="aula10.html#same-story-another-spin"><i class="fa fa-check"></i><b>12.1</b> Same story, another spin</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="aula11.html"><a href="aula11.html"><i class="fa fa-check"></i><b>13</b> Class 11: 03 11 2020 ANCOVA with different slopes: interactions</a><ul>
<li class="chapter" data-level="13.1" data-path="aula11.html"><a href="aula11.html#about-interactions"><i class="fa fa-check"></i><b>13.1</b> About interactions</a></li>
<li class="chapter" data-level="13.2" data-path="aula11.html"><a href="aula11.html#task-1-implementing-the-ancova-with-different-slopes"><i class="fa fa-check"></i><b>13.2</b> Task 1 Implementing the ANCOVA with different slopes</a></li>
<li class="chapter" data-level="13.3" data-path="aula11.html"><a href="aula11.html#task-2-modeling-a-data-set"><i class="fa fa-check"></i><b>13.3</b> Task 2 Modeling a data set</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="aula13.html"><a href="aula13.html"><i class="fa fa-check"></i><b>14</b> Class 12: 04 11 2020 Interactions between continous covariates</a><ul>
<li class="chapter" data-level="14.1" data-path="aula13.html"><a href="aula13.html#larger-order-interactions"><i class="fa fa-check"></i><b>14.1</b> Larger order interactions</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="conlusion-on-linear-regression.html"><a href="conlusion-on-linear-regression.html"><i class="fa fa-check"></i><b>15</b> Conlusion on linear regression</a><ul>
<li class="chapter" data-level="15.1" data-path="conlusion-on-linear-regression.html"><a href="conlusion-on-linear-regression.html#conclusion"><i class="fa fa-check"></i><b>15.1</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="aula12.html"><a href="aula12.html"><i class="fa fa-check"></i><b>16</b> Class 13: 10 11 2020 Maximum likelihood and all that</a><ul>
<li class="chapter" data-level="16.1" data-path="aula12.html"><a href="aula12.html#maximizing-a-likelihood-algebraically"><i class="fa fa-check"></i><b>16.1</b> Maximizing a likelihood algebraically</a></li>
<li class="chapter" data-level="16.2" data-path="aula12.html"><a href="aula12.html#numerically-maximizing-a-likelihood"><i class="fa fa-check"></i><b>16.2</b> Numerically Maximizing a likelihood</a></li>
<li class="chapter" data-level="16.3" data-path="aula12.html"><a href="aula12.html#the-case-of-a-gaussian"><i class="fa fa-check"></i><b>16.3</b> The case of a Gaussian</a></li>
<li class="chapter" data-level="16.4" data-path="aula12.html"><a href="aula12.html#the-case-of-a-linear-model"><i class="fa fa-check"></i><b>16.4</b> The case of a linear model</a></li>
<li class="chapter" data-level="16.5" data-path="aula12.html"><a href="aula12.html#the-really-interesting-case"><i class="fa fa-check"></i><b>16.5</b> The really interesting case</a></li>
<li class="chapter" data-level="16.6" data-path="aula12.html"><a href="aula12.html#likelihood-above-and-beyond"><i class="fa fa-check"></i><b>16.6</b> Likelihood, above and beyond</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="aula14.html"><a href="aula14.html"><i class="fa fa-check"></i><b>17</b> Class 14: 11 11 2020 GLMs</a><ul>
<li class="chapter" data-level="17.1" data-path="aula14.html"><a href="aula14.html#what-are-glms"><i class="fa fa-check"></i><b>17.1</b> What are GLMs</a></li>
<li class="chapter" data-level="17.2" data-path="aula14.html"><a href="aula14.html#the-link-function"><i class="fa fa-check"></i><b>17.2</b> The link function</a></li>
<li class="chapter" data-level="17.3" data-path="aula14.html"><a href="aula14.html#most-useful-glm-families"><i class="fa fa-check"></i><b>17.3</b> Most useful GLM Families</a></li>
<li class="chapter" data-level="17.4" data-path="aula14.html"><a href="aula14.html#an-example-analysis"><i class="fa fa-check"></i><b>17.4</b> An example analysis</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="aula15.html"><a href="aula15.html"><i class="fa fa-check"></i><b>18</b> Class 15: 17 11 2020</a><ul>
<li class="chapter" data-level="18.1" data-path="aula15.html"><a href="aula15.html#example-2"><i class="fa fa-check"></i><b>18.1</b> Example 2</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="aula16.html"><a href="aula16.html"><i class="fa fa-check"></i><b>19</b> Class 16: 18 11 2020</a><ul>
<li class="chapter" data-level="19.1" data-path="aula16.html"><a href="aula16.html#a-logistic-regression-example"><i class="fa fa-check"></i><b>19.1</b> A logistic regression example</a></li>
<li class="chapter" data-level="19.2" data-path="aula16.html"><a href="aula16.html#about-multicollinearity"><i class="fa fa-check"></i><b>19.2</b> About multicollinearity</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="aula17.html"><a href="aula17.html"><i class="fa fa-check"></i><b>20</b> Class 17: 24 11 2020</a></li>
<li class="chapter" data-level="21" data-path="aula18.html"><a href="aula18.html"><i class="fa fa-check"></i><b>21</b> Class 18: 25 11 2020</a><ul>
<li class="chapter" data-level="21.1" data-path="aula18.html"><a href="aula18.html#presence-of-bats"><i class="fa fa-check"></i><b>21.1</b> Presence of bats</a></li>
<li class="chapter" data-level="21.2" data-path="aula18.html"><a href="aula18.html#sponges"><i class="fa fa-check"></i><b>21.2</b> Sponges</a><ul>
<li class="chapter" data-level="21.2.1" data-path="aula18.html"><a href="aula18.html#reading-data-in"><i class="fa fa-check"></i><b>21.2.1</b> Reading data in</a></li>
<li class="chapter" data-level="21.2.2" data-path="aula18.html"><a href="aula18.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>21.2.2</b> Exploratory Data Analysis</a></li>
<li class="chapter" data-level="21.2.3" data-path="aula18.html"><a href="aula18.html#modelling"><i class="fa fa-check"></i><b>21.2.3</b> Modelling</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="aula18.html"><a href="aula18.html#extra-glm-stuff"><i class="fa fa-check"></i><b>21.3</b> Extra GLM stuff</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="aula19.html"><a href="aula19.html"><i class="fa fa-check"></i><b>22</b> Class 19: 02 12 2020</a></li>
<li class="chapter" data-level="23" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>23</b> Final Words</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes for Ecological Modelling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="aula18" class="section level1">
<h1><span class="header-section-number">Chapter 21</span> Class 18: 25 11 2020</h1>
<p>Special class: trabalho 2 presentation, continued</p>
<p>Hands on GLM</p>
<div id="presence-of-bats" class="section level2">
<h2><span class="header-section-number">21.1</span> Presence of bats</h2>
<p>Here we look at a dataset provided in</p>
</div>
<div id="sponges" class="section level2">
<h2><span class="header-section-number">21.2</span> Sponges</h2>
<p>In this chapter we model data on species sponge richness (SSR) as a gunction of environmental covariates. This data set is distributed with the paper Li et al. 2017 Application of random forest, generalised linear model and their hybrid methods with geostatistical techniques to count data: Predicting sponge species richness <em>Environmental Modelling &amp; Software</em> <strong>97</strong>: 112-129. The data set is in file “1-s2.0-S1364815217301615-mmc2.csv”. The reader is directed to the paper for additional details on data collection and the methods Li et al. 2017 used for analysis. Here we concentrate on GLMs to explore the main drivers of sponge species richness (SSR) across the area studied.</p>
<div id="reading-data-in" class="section level3">
<h3><span class="header-section-number">21.2.1</span> Reading data in</h3>
<p>We read the data in</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">sponges &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;extfiles/1-s2.0-S1364815217301615-mmc2.csv&quot;</span>)</a></code></pre></div>
<p>We briefly look at the data to make sure that all was read properly. We have sites with Sponge Species Richness (SSR) going from 1 to 39, with a mean of 10.48 and variance 110.78. In total we have 77 observations and 80 potential explanatory variables. We note upfront the potential practical issue that having more explanatory variables than observations raises.</p>
</div>
<div id="exploratory-data-analysis" class="section level3">
<h3><span class="header-section-number">21.2.2</span> Exploratory Data Analysis</h3>
<p>Since we have the geographic coordinates of all the samples, we can look at the data in space.</p>
<p>This lets us visualize that the data comes from 8 clusters of locations, in the actual paper referred as sites A to H.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">with</span>(sponges,<span class="kw">plot</span>(long.sample,lat.sample)) </a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">with</span>(sponges,<span class="kw">plot</span>(long.sample,lat.sample,<span class="dt">cex=</span><span class="dv">1</span><span class="op">+</span>species.richness<span class="op">/</span><span class="kw">max</span>(species.richness))) </a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-3-2.png" width="672" /></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">with</span>(sponges,<span class="kw">plot</span>(long.sample,lat.sample,<span class="dt">col=</span><span class="kw">ifelse</span>(<span class="dv">1</span><span class="op">+</span>species.richness<span class="op">/</span><span class="kw">max</span>(species.richness)<span class="op">&lt;</span><span class="fl">1.5</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;green&quot;</span>))) </a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-3-3.png" width="672" /></p>
<p>Note that cluster would have been an obvious covariate to use, namely as a random effect. While we are not interested in cluster per se, we know that sites are more alike within clusters just due to spatial auto-correlation, and hence that would have been sensible to include in the modelling.</p>
<p>Of course the other option might be to include latitude and longitude and explicitly consider to incorporate the spatiall auto-correlation structure. However, that is beyhond the objectives in this chapter, which are essentially to illustrate a GLM analysis over a real dataset.</p>
<p>We will now investigate the data set in a bit more detail. We begin by looking at whether there are large correlations between the explanatory variables and SSR</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">corsponges=<span class="kw">cor</span>(sponges)</a>
<a class="sourceLine" id="cb5-2" title="2">corWithSSR=corsponges[,<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb5-3" title="3"><span class="kw">hist</span>(corWithSSR[corWithSSR<span class="op">!=</span><span class="dv">1</span>],<span class="dt">main=</span><span class="st">&quot;Correlations between SSR and explanatory covariates&quot;</span>,<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dt">by=</span><span class="fl">0.05</span>))</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>The largest positive correlation of a variable with the response SSR is 0.31, while the largest negative correlation is -0.35. Nonetheless, that is no reason to despair. Hopefully, when considering multiple variables we will be able to model SSR in a reasonable way.</p>
<p>Since we have too many variables compared to observations any way, we can ask ourselves is if there are variables which are highly correlated, which could lead to unstable models and incorrect inferences about causality (which is, regardless, always hard in observational studies).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">corsponges=<span class="kw">cor</span>(sponges)</a>
<a class="sourceLine" id="cb6-2" title="2">covars=corsponges[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)]</a>
<a class="sourceLine" id="cb6-3" title="3">corcovars=<span class="kw">cor</span>(covars)</a>
<a class="sourceLine" id="cb6-4" title="4"><span class="kw">hist</span>(corcovars[corcovars<span class="op">!=</span><span class="dv">1</span>],<span class="dt">main=</span><span class="st">&quot;Correlations between explanatory covariates (lat,long excluded)&quot;</span>,<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dt">by=</span><span class="fl">0.05</span>))</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>As we can see, there is a wide range of correlations, but in particular there is a peak at the 0.95-1 range, which we suspected might be due to the fact that some variables are actually obtained as a function of others. After a closer read at the original paper we come to realize these are highly correlated just by constriction. These correspond to echoes of radar on different frequency bands, and hence it is not surprising that they present incredibly high correlations across. It is somewhat surprising that the authors did not note this fact upfront on their paper. These are associated with backscatter variables, with code <code>bs</code>so we can use the function <code>grep</code> to look at these</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">pairs</span>(sponges[,<span class="kw">grep</span>(<span class="dt">pattern=</span><span class="st">&quot;bs&quot;</span>, <span class="dt">x=</span><span class="kw">names</span>(sponges),<span class="dt">value =</span> <span class="ot">TRUE</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">14</span>]])</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">pairs</span>(sponges[,<span class="kw">grep</span>(<span class="dt">pattern=</span><span class="st">&quot;bs&quot;</span>, <span class="dt">x=</span><span class="kw">names</span>(sponges),<span class="dt">value =</span> <span class="ot">TRUE</span>)[<span class="dv">15</span><span class="op">:</span><span class="dv">28</span>]])</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-6-2.png" width="672" /></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">pairs</span>(sponges[,<span class="kw">grep</span>(<span class="dt">pattern=</span><span class="st">&quot;bs&quot;</span>, <span class="dt">x=</span><span class="kw">names</span>(sponges),<span class="dt">value =</span> <span class="ot">TRUE</span>)[<span class="dv">29</span><span class="op">:</span><span class="dv">35</span>]])</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-6-3.png" width="672" /></p>
<p>Including pairs of such highly correlated variables in the models could lead to problems nad makes interpretation harder, and hence we need to decide which to remove a priori. This should be driven by ecological knowledge, which in our case, for SSR, is close to inexistent!</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">sort</span>(<span class="kw">abs</span>(<span class="kw">round</span>(corWithSSR,<span class="dv">2</span>)))</a></code></pre></div>
<pre><code>##             bs22             bs23             bs24             bs29 
##             0.00             0.00             0.00             0.00 
##             bs35             bs_o       rugosity_o             bs25 
##             0.00             0.00             0.00             0.01 
##             bs26             bs27             bs28             bs33 
##             0.01             0.01             0.01             0.01 
##             bs34             bs36             bs21             bs30 
##             0.01             0.01             0.02             0.02 
##             bs31             bs32            tpi_o             bs20 
##             0.02             0.02             0.02             0.03 
##             var3             bs17             bs18             bs19 
##             0.03             0.04             0.04             0.04 
##          bathy_o        rugosity3       plan_curv5            bathy 
##             0.04             0.04             0.04             0.05 
##             bs10             bs11             bs12             bs13 
##             0.06             0.06             0.06             0.06 
##             bs16       bs_entro_o         bs_var_o             bs14 
##             0.06             0.06             0.06             0.07 
##             bs15       prof_cur_o            homo7       plan_cur_o 
##             0.07             0.07             0.07             0.08 
##            homo5             var7              mud             tpi7 
##             0.08             0.08             0.09             0.09 
##           entro5           entro7         bs_lmi_o         relief_o 
##             0.09             0.09             0.10             0.10 
##             var5          bs_lmi3          bs_lmi5          bs_lmi7 
##             0.10             0.10             0.10             0.10 
##        prof_cur3        rugosity5        bs_homo_o      bathy_lmi_o 
##             0.12             0.13             0.14             0.14 
##       bathy_lmi3       bathy_lmi5       bathy_lmi7       plan_curv7 
##             0.14             0.14             0.14             0.14 
##            homo3          slope_o        prof_cur5           entro3 
##             0.14             0.15             0.15             0.15 
##        rugosity7             tpi3        prof_cur7         relief_3 
##             0.16             0.16             0.17             0.18 
##           slope3             tpi5       plan_curv3           slope5 
##             0.19             0.20             0.22             0.23 
##           slope7         relief_5         relief_7      long.sample 
##             0.25             0.28             0.28             0.30 
##       lat.sample           gravel       dist.coast             sand 
##             0.30             0.30             0.31             0.35 
## species.richness 
##             1.00</code></pre>
<p>What does the response variable itself look like? That is the key question to answer, as it will determine the distribution we use to model it. We already saw that the variance is considerably larger than the mean, and therefore, the default go-to distribution for counts, a Poisson, will probably not be the best choice here.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">hist</span>(sponges<span class="op">$</span>species.richness,<span class="dt">xlab=</span><span class="st">&quot;Species Richness&quot;</span>,<span class="dt">main=</span><span class="st">&quot;&quot;</span>,<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">40</span>,<span class="dt">by=</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="kw">text</span>(<span class="dv">30</span>,<span class="dv">7</span>,<span class="kw">paste0</span>(<span class="st">&quot;Mean=&quot;</span>,<span class="kw">round</span>(<span class="kw">mean</span>(sponges<span class="op">$</span>species.richness),<span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb12-3" title="3"><span class="kw">text</span>(<span class="dv">30</span>,<span class="dv">5</span>,<span class="kw">paste0</span>(<span class="st">&quot;Variance=&quot;</span>,<span class="kw">round</span>(<span class="kw">var</span>(sponges<span class="op">$</span>species.richness),<span class="dv">1</span>)))</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>We can compare this with a poisson with the same mean, or a negative binomial with the same mean and variance. It should be obvious which provides a closer approximation, even before covariates get added to the mix.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>),<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>))</a>
<a class="sourceLine" id="cb13-2" title="2"><span class="kw">hist</span>(sponges<span class="op">$</span>species.richness,<span class="dt">xlab=</span><span class="st">&quot;Species Richness&quot;</span>,<span class="dt">main=</span><span class="st">&quot;&quot;</span>,<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">40</span>,<span class="dt">by=</span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb13-3" title="3"><span class="kw">text</span>(<span class="dv">30</span>,<span class="dv">20</span>,<span class="kw">paste0</span>(<span class="st">&quot;Mean=&quot;</span>,<span class="kw">round</span>(<span class="kw">mean</span>(sponges<span class="op">$</span>species.richness),<span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb13-4" title="4"><span class="kw">text</span>(<span class="dv">30</span>,<span class="dv">10</span>,<span class="kw">paste0</span>(<span class="st">&quot;Variance=&quot;</span>,<span class="kw">round</span>(<span class="kw">var</span>(sponges<span class="op">$</span>species.richness),<span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb13-5" title="5"><span class="co"># Poisson</span></a>
<a class="sourceLine" id="cb13-6" title="6">mean=<span class="dv">10</span></a>
<a class="sourceLine" id="cb13-7" title="7"><span class="kw">hist</span>(<span class="kw">rpois</span>(<span class="dv">10000</span>,mean),<span class="dt">main=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;Poisson, mean=10&quot;</span>,<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">40</span>,<span class="dt">by=</span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb13-8" title="8"><span class="co">#Neg Bin</span></a>
<a class="sourceLine" id="cb13-9" title="9">mean=<span class="dv">10</span></a>
<a class="sourceLine" id="cb13-10" title="10">var=<span class="dv">100</span></a>
<a class="sourceLine" id="cb13-11" title="11">dat=<span class="kw">rnbinom</span>(<span class="dv">10000</span>,<span class="dt">size=</span>mean<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(var<span class="op">-</span>mean),<span class="dt">mu=</span>mean)</a>
<a class="sourceLine" id="cb13-12" title="12"><span class="kw">hist</span>(dat[dat<span class="op">&lt;</span><span class="dv">40</span>],<span class="dt">main=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;Negative Binomial, mean=10, var=100&quot;</span>,<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">40</span>,<span class="dt">by=</span><span class="dv">5</span>))</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>While there is never too much Exploratory Data Analysis (EDA), here we move on to do some modelling.</p>
</div>
<div id="modelling" class="section level3">
<h3><span class="header-section-number">21.2.3</span> Modelling</h3>
<p>Just to begin, we take a peak at one of the variables that had a large positive correlation with SSR, in this case, <code>dist.coast</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="co">#testing a random variable!!</span></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="kw">with</span>(sponges,<span class="kw">plot</span>(dist.coast,species.richness))</a>
<a class="sourceLine" id="cb14-3" title="3">lm0&lt;-<span class="kw">lm</span>(species.richness<span class="op">~</span>dist.coast,<span class="dt">data=</span>sponges)</a>
<a class="sourceLine" id="cb14-4" title="4"><span class="kw">abline</span>(lm0)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">summary</span>(lm0)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = species.richness ~ dist.coast, data = sponges)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -14.016  -6.986  -4.938   4.103  27.174 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept) 5.705e+00  2.026e+00   2.816  0.00621 **
## dist.coast  4.785e-05  1.673e-05   2.859  0.00549 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 10.06 on 75 degrees of freedom
## Multiple R-squared:  0.09831,	Adjusted R-squared:  0.08628 
## F-statistic: 8.177 on 1 and 75 DF,  p-value: 0.005492</code></pre>
<p>Apparently there is information to explain the species richness, and while the correlation is low, we can see that from a classical perspective, the coeficient associated with the variable would be considered significant at the usual significance levels, considering a simple linear model. However, we now that we are modelling counts,a nd hence, the Gaussian distribution is unlikely to be reasonable assumption. So, we move on to GLMs.</p>
<p>Lets begin by comparing just how different the model using a Poisson or a NB becomes, in terms of AIC</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="co">#testing a random variable!!</span></a>
<a class="sourceLine" id="cb17-2" title="2">glmP1=<span class="kw">glm</span>(species.richness<span class="op">~</span>dist.coast,<span class="dt">family=</span><span class="kw">poisson</span>(<span class="dt">link=</span><span class="st">&quot;log&quot;</span>),<span class="dt">data=</span>sponges)</a>
<a class="sourceLine" id="cb17-3" title="3"><span class="kw">library</span>(MASS)</a>
<a class="sourceLine" id="cb17-4" title="4">glmNB1=<span class="kw">glm.nb</span>(species.richness<span class="op">~</span>dist.coast,<span class="dt">link=</span>log,<span class="dt">data=</span>sponges)</a>
<a class="sourceLine" id="cb17-5" title="5"><span class="kw">AIC</span>(glmP1,glmNB1)</a></code></pre></div>
<pre><code>##        df      AIC
## glmP1   2 975.7237
## glmNB1  3 522.3367</code></pre>
<p>There is absolutely no question about the fact that the NB is better here! Which does not necessarily mean it is the best model - remember AIC is a relative measure of fit.</p>
<p>We can compare with the quasi-poisson</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">glmQP1=<span class="kw">glm</span>(species.richness<span class="op">~</span>dist.coast,<span class="dt">family=</span>quasipoisson,<span class="dt">data=</span>sponges)</a></code></pre></div>
<p>and now we compare the two</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">summary</span>(glmP1)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = species.richness ~ dist.coast, family = poisson(link = &quot;log&quot;), 
##     data = sponges)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -4.4753  -3.0008  -1.7069   0.9003   6.4290  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) 1.894e+00  6.702e-02  28.258   &lt;2e-16 ***
## dist.coast  4.135e-06  4.703e-07   8.792   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 768.25  on 76  degrees of freedom
## Residual deviance: 694.62  on 75  degrees of freedom
## AIC: 975.72
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="kw">summary</span>(glmQP1)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = species.richness ~ dist.coast, family = quasipoisson, 
##     data = sponges)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -4.4753  -3.0008  -1.7069   0.9003   6.4290  
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 1.894e+00  2.152e-01   8.800 3.57e-13 ***
## dist.coast  4.135e-06  1.510e-06   2.738  0.00772 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for quasipoisson family taken to be 10.31074)
## 
##     Null deviance: 768.25  on 76  degrees of freedom
## Residual deviance: 694.62  on 75  degrees of freedom
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>as expected, the only difference is the increase of the standard errors associated with the parameters. Note also that in the Quasi-Poisson we get an estimate of the over-dispersion parameter, and, since we do not have a likelihood, we do not get an AIC. The parameter standard errors are bigger in the quasi case, given that the overdispersion parameter is larger than 1.</p>
<p>Just for comparison, we look at the output from the negative binomial model</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw">summary</span>(glmNB1)</a></code></pre></div>
<pre><code>## 
## Call:
## glm.nb(formula = species.richness ~ dist.coast, data = sponges, 
##     link = log, init.theta = 1.084393054)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.5856  -1.2639  -0.5590   0.2566   1.7763  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) 1.871e+00  2.052e-01   9.117  &lt; 2e-16 ***
## dist.coast  4.345e-06  1.669e-06   2.604  0.00923 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Negative Binomial(1.0844) family taken to be 1)
## 
##     Null deviance: 89.908  on 76  degrees of freedom
## Residual deviance: 83.032  on 75  degrees of freedom
## AIC: 522.34
## 
## Number of Fisher Scoring iterations: 1
## 
## 
##               Theta:  1.084 
##           Std. Err.:  0.184 
## 
##  2 x log-likelihood:  -516.337</code></pre>
<p>Note that in practice all models would lead us to find the <code>dist.coast</code> to be considered relevant to model species richness.</p>
<p>A bit on model selection, using <code>anova</code>, a Chi-squared test,</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">glmQP2=<span class="kw">glm</span>(species.richness<span class="op">~</span><span class="dv">1</span>,<span class="dt">family=</span>quasipoisson,<span class="dt">data=</span>sponges)</a>
<a class="sourceLine" id="cb26-2" title="2"><span class="kw">anova</span>(glmQP1,glmQP2, <span class="dt">test =</span> <span class="st">&quot;Chi&quot;</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: species.richness ~ dist.coast
## Model 2: species.richness ~ 1
##   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)   
## 1        75     694.62                        
## 2        76     768.25 -1  -73.628 0.007534 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>or using <code>drop1</code>, with an F-test</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="kw">drop1</span>(glmQP1,<span class="dt">test=</span><span class="st">&quot;F&quot;</span>)</a></code></pre></div>
<pre><code>## Single term deletions
## 
## Model:
## species.richness ~ dist.coast
##            Df Deviance F value   Pr(&gt;F)   
## &lt;none&gt;          694.62                    
## dist.coast  1   768.25  7.9498 0.006148 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>again, both tell us that <code>dist.coast</code> is a relevant covariate.</p>
<p>We could look at the residuals for both models. First the Poisson</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>))</a>
<a class="sourceLine" id="cb30-2" title="2"><span class="kw">plot</span>(glmP1)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>and then the negative binomial</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>))</a>
<a class="sourceLine" id="cb31-2" title="2"><span class="kw">plot</span>(glmNB1)</a></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>It is quite hard to choose between these based on the residuals, but remember that the AIC does not leave any room for doubts, the Negative Binomial is the most likely road to take here. So now it is time to investigate what might be the best model.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="kw">AIC</span>(lm0,glmP1,glmNB1)</a></code></pre></div>
<pre><code>##        df      AIC
## lm0     3 578.0226
## glmP1   2 975.7237
## glmNB1  3 522.3367</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">glmNB.<span class="fl">0.15</span>=<span class="kw">glm.nb</span>(species.richness<span class="op">~</span>slope_o<span class="op">+</span>prof_cur5<span class="op">+</span>entro3 </a>
<a class="sourceLine" id="cb34-2" title="2"><span class="op">+</span>rugosity7<span class="op">+</span>tpi3<span class="op">+</span>prof_cur7<span class="op">+</span>relief_<span class="dv">3</span> </a>
<a class="sourceLine" id="cb34-3" title="3"><span class="op">+</span>slope3<span class="op">+</span>tpi5<span class="op">+</span>plan_curv3<span class="op">+</span>slope5 </a>
<a class="sourceLine" id="cb34-4" title="4"><span class="op">+</span>slope7<span class="op">+</span>relief_<span class="dv">5</span><span class="op">+</span>relief_<span class="dv">7</span><span class="op">+</span>long.sample </a>
<a class="sourceLine" id="cb34-5" title="5"><span class="op">+</span>lat.sample<span class="op">+</span>gravel<span class="op">+</span>dist.coast<span class="op">+</span>sand,<span class="dt">link=</span>log,<span class="dt">data=</span>sponges)</a></code></pre></div>
</div>
</div>
<div id="extra-glm-stuff" class="section level2">
<h2><span class="header-section-number">21.3</span> Extra GLM stuff</h2>
<p>Zero inflated models and other similar stuff!</p>
<ul>
<li><span class="citation">Martin et al. (<a href="#ref-Martin2005" role="doc-biblioref">2005</a>)</span></li>
</ul>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Martin2005">
<p>Martin, Tara G., Brendan A. Wintle, Jonathan R. Rhodes, Petra M. Kuhnert, Scott A. Field, Samantha J. Low-Choy, Andrew J. Tyre, and Hugh P. Possingham. 2005. “Zero Tolerance Ecology: Improving Ecological Inference by Modelling the Source of Zero Observations.” <em>Ecology Letters</em> 8: 1235–46.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="aula17.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="aula19.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ECOMODbook.pdf", "ECOMODbook.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
