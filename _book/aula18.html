<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 23 Class 18: 25 11 2020 | Notes for Ecological Modelling</title>
  <meta name="description" content="This is based on Yihui Xie’s a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 23 Class 18: 25 11 2020 | Notes for Ecological Modelling" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is based on Yihui Xie’s a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 23 Class 18: 25 11 2020 | Notes for Ecological Modelling" />
  
  <meta name="twitter:description" content="This is based on Yihui Xie’s a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Tiago A. Marques" />


<meta name="date" content="2023-10-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="aula17.html"/>
<link rel="next" href="aula19.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="mainintro.html"><a href="mainintro.html"><i class="fa fa-check"></i><b>2</b> Preamble</a></li>
<li class="chapter" data-level="3" data-path="aknowledgments.html"><a href="aknowledgments.html"><i class="fa fa-check"></i><b>3</b> Aknowledgments</a></li>
<li class="chapter" data-level="4" data-path="usingRintro.html"><a href="usingRintro.html"><i class="fa fa-check"></i><b>4</b> Using R</a></li>
<li class="chapter" data-level="5" data-path="prelim.html"><a href="prelim.html"><i class="fa fa-check"></i><b>5</b> Preliminaries</a>
<ul>
<li class="chapter" data-level="5.1" data-path="prelim.html"><a href="prelim.html#lbtb"><i class="fa fa-check"></i><b>5.1</b> Learning by the book</a></li>
<li class="chapter" data-level="5.2" data-path="prelim.html"><a href="prelim.html#ftpt"><i class="fa fa-check"></i><b>5.2</b> Following the paper trail</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="about-regression.html"><a href="about-regression.html"><i class="fa fa-check"></i><b>6</b> About regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="about-regression.html"><a href="about-regression.html#what-is-a-regression"><i class="fa fa-check"></i><b>6.1</b> What is a regression?</a></li>
<li class="chapter" data-level="6.2" data-path="about-regression.html"><a href="about-regression.html#the-general-linear-model"><i class="fa fa-check"></i><b>6.2</b> The general linear model</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="handson.html"><a href="handson.html"><i class="fa fa-check"></i><b>7</b> Hands On Regression</a>
<ul>
<li class="chapter" data-level="7.1" data-path="handson.html"><a href="handson.html#the-assumptions-are-on-the-residuals-not-the-data"><i class="fa fa-check"></i><b>7.1</b> The assumptions are on the residuals, not the data</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="aula6.html"><a href="aula6.html"><i class="fa fa-check"></i><b>8</b> Regression inside out</a>
<ul>
<li class="chapter" data-level="8.1" data-path="aula6.html"><a href="aula6.html#implementing-a-regression"><i class="fa fa-check"></i><b>8.1</b> Implementing a regression</a></li>
<li class="chapter" data-level="8.2" data-path="aula6.html"><a href="aula6.html#simulating-regression-data"><i class="fa fa-check"></i><b>8.2</b> Simulating regression data</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="aula6.html"><a href="aula6.html#what-is-the-effect-of-increasing-the-error-a-simulation-experiment"><i class="fa fa-check"></i><b>8.2.1</b> What is the effect of increasing the error: a simulation experiment</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="aula7.html"><a href="aula7.html"><i class="fa fa-check"></i><b>9</b> Two tasks to further understand regression</a>
<ul>
<li class="chapter" data-level="9.1" data-path="aula7.html"><a href="aula7.html#task-1"><i class="fa fa-check"></i><b>9.1</b> Task 1</a></li>
<li class="chapter" data-level="9.2" data-path="aula7.html"><a href="aula7.html#task-2"><i class="fa fa-check"></i><b>9.2</b> Task 2</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="aula8.html"><a href="aula8.html"><i class="fa fa-check"></i><b>10</b> t-tests and ANOVAs are just linear models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="aula8.html"><a href="aula8.html#a-one-sample-t-test-is-the-simplest-possible-linear-model"><i class="fa fa-check"></i><b>10.1</b> A one sample t-test is the simplest possible linear model</a></li>
<li class="chapter" data-level="10.2" data-path="aula8.html"><a href="aula8.html#the-t-test"><i class="fa fa-check"></i><b>10.2</b> The t-test</a></li>
<li class="chapter" data-level="10.3" data-path="aula8.html"><a href="aula8.html#anova"><i class="fa fa-check"></i><b>10.3</b> ANOVA</a></li>
<li class="chapter" data-level="10.4" data-path="aula8.html"><a href="aula8.html#a-two-way-anova-and-beyhond-ex-task-do-it-yourself"><i class="fa fa-check"></i><b>10.4</b> A two way ANOVA, and beyhond (ex Task: do it yourself!)</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="aula9.html"><a href="aula9.html"><i class="fa fa-check"></i><b>11</b> Class 9: 21 10 2020 - ANCOVA is (also) just a linear model</a>
<ul>
<li class="chapter" data-level="11.1" data-path="aula9.html"><a href="aula9.html#common-slope-different-intercepts-per-treatment"><i class="fa fa-check"></i><b>11.1</b> Common slope, different intercepts per treatment</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="aula10.html"><a href="aula10.html"><i class="fa fa-check"></i><b>12</b> Class 10: 27 10 2020</a>
<ul>
<li class="chapter" data-level="12.1" data-path="aula10.html"><a href="aula10.html#same-story-another-spin"><i class="fa fa-check"></i><b>12.1</b> Same story, another spin</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="aula11.html"><a href="aula11.html"><i class="fa fa-check"></i><b>13</b> Class 11: 03 11 2020 ANCOVA with different slopes: interactions</a>
<ul>
<li class="chapter" data-level="13.1" data-path="aula11.html"><a href="aula11.html#about-interactions"><i class="fa fa-check"></i><b>13.1</b> About interactions</a></li>
<li class="chapter" data-level="13.2" data-path="aula11.html"><a href="aula11.html#task-1-implementing-the-ancova-with-different-slopes"><i class="fa fa-check"></i><b>13.2</b> Task 1 Implementing the ANCOVA with different slopes</a></li>
<li class="chapter" data-level="13.3" data-path="aula11.html"><a href="aula11.html#task-2-modeling-a-data-set"><i class="fa fa-check"></i><b>13.3</b> Task 2 Modeling a data set</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="aula13.html"><a href="aula13.html"><i class="fa fa-check"></i><b>14</b> Class 12: 04 11 2020 Interactions between continous covariates</a>
<ul>
<li class="chapter" data-level="14.1" data-path="aula13.html"><a href="aula13.html#larger-order-interactions"><i class="fa fa-check"></i><b>14.1</b> Larger order interactions</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="conclusion-on-linear-regression.html"><a href="conclusion-on-linear-regression.html"><i class="fa fa-check"></i><b>15</b> Conclusion on linear regression</a>
<ul>
<li class="chapter" data-level="15.1" data-path="conclusion-on-linear-regression.html"><a href="conclusion-on-linear-regression.html#conclusion"><i class="fa fa-check"></i><b>15.1</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="aula12.html"><a href="aula12.html"><i class="fa fa-check"></i><b>16</b> Class 13: 10 11 2020 Maximum likelihood and all that</a>
<ul>
<li class="chapter" data-level="16.1" data-path="aula12.html"><a href="aula12.html#maximizing-a-likelihood-algebraically"><i class="fa fa-check"></i><b>16.1</b> Maximizing a likelihood algebraically</a></li>
<li class="chapter" data-level="16.2" data-path="aula12.html"><a href="aula12.html#numerically-maximizing-a-likelihood"><i class="fa fa-check"></i><b>16.2</b> Numerically Maximizing a likelihood</a></li>
<li class="chapter" data-level="16.3" data-path="aula12.html"><a href="aula12.html#the-case-of-a-gaussian"><i class="fa fa-check"></i><b>16.3</b> The case of a Gaussian</a></li>
<li class="chapter" data-level="16.4" data-path="aula12.html"><a href="aula12.html#the-case-of-a-linear-model"><i class="fa fa-check"></i><b>16.4</b> The case of a linear model</a></li>
<li class="chapter" data-level="16.5" data-path="aula12.html"><a href="aula12.html#the-really-interesting-case"><i class="fa fa-check"></i><b>16.5</b> The really interesting case</a></li>
<li class="chapter" data-level="16.6" data-path="aula12.html"><a href="aula12.html#likelihood-above-and-beyond"><i class="fa fa-check"></i><b>16.6</b> Likelihood, above and beyond</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="aula14.html"><a href="aula14.html"><i class="fa fa-check"></i><b>17</b> Class 14: 11 11 2020 GLMs</a>
<ul>
<li class="chapter" data-level="17.1" data-path="aula14.html"><a href="aula14.html#what-are-glms"><i class="fa fa-check"></i><b>17.1</b> What are GLMs</a></li>
<li class="chapter" data-level="17.2" data-path="aula14.html"><a href="aula14.html#the-link-function"><i class="fa fa-check"></i><b>17.2</b> The link function</a></li>
<li class="chapter" data-level="17.3" data-path="aula14.html"><a href="aula14.html#most-useful-glm-families"><i class="fa fa-check"></i><b>17.3</b> Most useful GLM Families</a></li>
<li class="chapter" data-level="17.4" data-path="aula14.html"><a href="aula14.html#an-example-analysis"><i class="fa fa-check"></i><b>17.4</b> An example analysis</a></li>
<li class="chapter" data-level="17.5" data-path="aula14.html"><a href="aula14.html#an-example-of-a-glm-as-a-detail-within-a-conceptualization-framework"><i class="fa fa-check"></i><b>17.5</b> An example of a GLM as a detail within a conceptualization framework</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="aula15.html"><a href="aula15.html"><i class="fa fa-check"></i><b>18</b> Class 15: 17 11 2020</a></li>
<li class="chapter" data-level="19" data-path="example-1---deviance.html"><a href="example-1---deviance.html"><i class="fa fa-check"></i><b>19</b> Example 1 - deviance</a></li>
<li class="chapter" data-level="20" data-path="example-2---lagartyos-glm.html"><a href="example-2---lagartyos-glm.html"><i class="fa fa-check"></i><b>20</b> Example 2 - lagartyos GLM</a>
<ul>
<li class="chapter" data-level="20.1" data-path="example-2---lagartyos-glm.html"><a href="example-2---lagartyos-glm.html#example-2"><i class="fa fa-check"></i><b>20.1</b> Example 2</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="aula16.html"><a href="aula16.html"><i class="fa fa-check"></i><b>21</b> Class 16: 18 11 2020</a>
<ul>
<li class="chapter" data-level="21.1" data-path="aula16.html"><a href="aula16.html#a-logistic-regression-example"><i class="fa fa-check"></i><b>21.1</b> A logistic regression example</a></li>
<li class="chapter" data-level="21.2" data-path="aula16.html"><a href="aula16.html#titanic-example"><i class="fa fa-check"></i><b>21.2</b> Titanic example</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="aula16.html"><a href="aula16.html#análise-exploratoria-de-dados"><i class="fa fa-check"></i><b>21.2.1</b> Análise Exploratoria de Dados</a></li>
<li class="chapter" data-level="21.2.2" data-path="aula16.html"><a href="aula16.html#modelação"><i class="fa fa-check"></i><b>21.2.2</b> Modelação</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="aula16.html"><a href="aula16.html#about-multicollinearity"><i class="fa fa-check"></i><b>21.3</b> About multicollinearity</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="aula17.html"><a href="aula17.html"><i class="fa fa-check"></i><b>22</b> Random effects and mixed Models</a></li>
<li class="chapter" data-level="23" data-path="aula18.html"><a href="aula18.html"><i class="fa fa-check"></i><b>23</b> Class 18: 25 11 2020</a>
<ul>
<li class="chapter" data-level="23.1" data-path="aula18.html"><a href="aula18.html#presence-of-bats"><i class="fa fa-check"></i><b>23.1</b> Presence of bats</a></li>
<li class="chapter" data-level="23.2" data-path="aula18.html"><a href="aula18.html#sponges"><i class="fa fa-check"></i><b>23.2</b> Sponges</a>
<ul>
<li class="chapter" data-level="23.2.1" data-path="aula18.html"><a href="aula18.html#reading-data-in"><i class="fa fa-check"></i><b>23.2.1</b> Reading data in</a></li>
<li class="chapter" data-level="23.2.2" data-path="aula18.html"><a href="aula18.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>23.2.2</b> Exploratory Data Analysis</a></li>
<li class="chapter" data-level="23.2.3" data-path="aula18.html"><a href="aula18.html#modelling"><i class="fa fa-check"></i><b>23.2.3</b> Modelling</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="aula18.html"><a href="aula18.html#extra-glm-stuff"><i class="fa fa-check"></i><b>23.3</b> Extra GLM stuff</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="aula19.html"><a href="aula19.html"><i class="fa fa-check"></i><b>24</b> Class 19: 02 12 2020</a></li>
<li class="chapter" data-level="25" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>25</b> Final Words</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes for Ecological Modelling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="aula18" class="section level1 hasAnchor" number="23">
<h1><span class="header-section-number">Chapter 23</span> Class 18: 25 11 2020<a href="aula18.html#aula18" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Special class: trabalho 2 presentation, continued</p>
<p>Hands on GLM</p>
<div id="presence-of-bats" class="section level2 hasAnchor" number="23.1">
<h2><span class="header-section-number">23.1</span> Presence of bats<a href="aula18.html#presence-of-bats" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here we look at a dataset provided in</p>
</div>
<div id="sponges" class="section level2 hasAnchor" number="23.2">
<h2><span class="header-section-number">23.2</span> Sponges<a href="aula18.html#sponges" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this chapter we model data on species sponge richness (SSR) as a gunction of environmental covariates. This data set is distributed with the paper Li et al. 2017 Application of random forest, generalised linear model and their hybrid methods with geostatistical techniques to count data: Predicting sponge species richness <em>Environmental Modelling &amp; Software</em> <strong>97</strong>: 112-129. The data set is in file “1-s2.0-S1364815217301615-mmc2.csv”. The reader is directed to the paper for additional details on data collection and the methods Li et al. 2017 used for analysis. Here we concentrate on GLMs to explore the main drivers of sponge species richness (SSR) across the area studied.</p>
<div id="reading-data-in" class="section level3 hasAnchor" number="23.2.1">
<h3><span class="header-section-number">23.2.1</span> Reading data in<a href="aula18.html#reading-data-in" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We read the data in</p>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="aula18.html#cb541-1" tabindex="-1"></a>sponges <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;extfiles/1-s2.0-S1364815217301615-mmc2.csv&quot;</span>)</span></code></pre></div>
<p>We briefly look at the data to make sure that all was read properly. We have sites with Sponge Species Richness (SSR) going from 1 to 39, with a mean of 10.48 and variance 110.78. In total we have 77 observations and 80 potential explanatory variables. We note upfront the potential practical issue that having more explanatory variables than observations raises.</p>
</div>
<div id="exploratory-data-analysis" class="section level3 hasAnchor" number="23.2.2">
<h3><span class="header-section-number">23.2.2</span> Exploratory Data Analysis<a href="aula18.html#exploratory-data-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Since we have the geographic coordinates of all the samples, we can look at the data in space.</p>
<p>This lets us visualize that the data comes from 8 clusters of locations, in the actual paper referred as sites A to H.</p>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="aula18.html#cb542-1" tabindex="-1"></a><span class="fu">with</span>(sponges,<span class="fu">plot</span>(long.sample,lat.sample)) </span></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-66-1.png" width="672" /></p>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="aula18.html#cb543-1" tabindex="-1"></a><span class="fu">with</span>(sponges,<span class="fu">plot</span>(long.sample,lat.sample,<span class="at">cex=</span><span class="dv">1</span><span class="sc">+</span>species.richness<span class="sc">/</span><span class="fu">max</span>(species.richness))) </span></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-66-2.png" width="672" /></p>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="aula18.html#cb544-1" tabindex="-1"></a><span class="fu">with</span>(sponges,<span class="fu">plot</span>(long.sample,lat.sample,<span class="at">col=</span><span class="fu">ifelse</span>(<span class="dv">1</span><span class="sc">+</span>species.richness<span class="sc">/</span><span class="fu">max</span>(species.richness)<span class="sc">&lt;</span><span class="fl">1.5</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;green&quot;</span>))) </span></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-66-3.png" width="672" /></p>
<p>Note that cluster would have been an obvious covariate to use, namely as a random effect. While we are not interested in cluster per se, we know that sites are more alike within clusters just due to spatial auto-correlation, and hence that would have been sensible to include in the modelling.</p>
<p>Of course the other option might be to include latitude and longitude and explicitly consider to incorporate the spatiall auto-correlation structure. However, that is beyhond the objectives in this chapter, which are essentially to illustrate a GLM analysis over a real dataset.</p>
<p>We will now investigate the data set in a bit more detail. We begin by looking at whether there are large correlations between the explanatory variables and SSR</p>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="aula18.html#cb545-1" tabindex="-1"></a>corsponges<span class="ot">=</span><span class="fu">cor</span>(sponges)</span>
<span id="cb545-2"><a href="aula18.html#cb545-2" tabindex="-1"></a>corWithSSR<span class="ot">=</span>corsponges[,<span class="dv">3</span>]</span>
<span id="cb545-3"><a href="aula18.html#cb545-3" tabindex="-1"></a><span class="fu">hist</span>(corWithSSR[corWithSSR<span class="sc">!=</span><span class="dv">1</span>],<span class="at">main=</span><span class="st">&quot;Correlations between SSR and explanatory covariates&quot;</span>,<span class="at">breaks=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.05</span>))</span></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-67-1.png" width="672" /></p>
<p>The largest positive correlation of a variable with the response SSR is 0.31, while the largest negative correlation is -0.35. Nonetheless, that is no reason to despair. Hopefully, when considering multiple variables we will be able to model SSR in a reasonable way.</p>
<p>Since we have too many variables compared to observations any way, we can ask ourselves is if there are variables which are highly correlated, which could lead to unstable models and incorrect inferences about causality (which is, regardless, always hard in observational studies).</p>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="aula18.html#cb546-1" tabindex="-1"></a>corsponges<span class="ot">=</span><span class="fu">cor</span>(sponges)</span>
<span id="cb546-2"><a href="aula18.html#cb546-2" tabindex="-1"></a>covars<span class="ot">=</span>corsponges[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)]</span>
<span id="cb546-3"><a href="aula18.html#cb546-3" tabindex="-1"></a>corcovars<span class="ot">=</span><span class="fu">cor</span>(covars)</span>
<span id="cb546-4"><a href="aula18.html#cb546-4" tabindex="-1"></a><span class="fu">hist</span>(corcovars[corcovars<span class="sc">!=</span><span class="dv">1</span>],<span class="at">main=</span><span class="st">&quot;Correlations between explanatory covariates (lat,long excluded)&quot;</span>,<span class="at">breaks=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.05</span>))</span></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
<p>As we can see, there is a wide range of correlations, but in particular there is a peak at the 0.95-1 range, which we suspected might be due to the fact that some variables are actually obtained as a function of others. After a closer read at the original paper we come to realize these are highly correlated just by constriction. These correspond to echoes of radar on different frequency bands, and hence it is not surprising that they present incredibly high correlations across. It is somewhat surprising that the authors did not note this fact upfront on their paper. These are associated with backscatter variables, with code <code>bs</code>so we can use the function <code>grep</code> to look at these (note even so we divide these into several <code>pairs</code> plots otherwise the plots are too small for being useful).</p>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="aula18.html#cb547-1" tabindex="-1"></a><span class="fu">pairs</span>(sponges[,<span class="fu">grep</span>(<span class="at">pattern=</span><span class="st">&quot;bs&quot;</span>, <span class="at">x=</span><span class="fu">names</span>(sponges),<span class="at">value =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>]])</span></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-69-1.png" width="672" /></p>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="aula18.html#cb548-1" tabindex="-1"></a><span class="fu">pairs</span>(sponges[,<span class="fu">grep</span>(<span class="at">pattern=</span><span class="st">&quot;bs&quot;</span>, <span class="at">x=</span><span class="fu">names</span>(sponges),<span class="at">value =</span> <span class="cn">TRUE</span>)[<span class="dv">15</span><span class="sc">:</span><span class="dv">28</span>]])</span></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-69-2.png" width="672" /></p>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="aula18.html#cb549-1" tabindex="-1"></a><span class="fu">pairs</span>(sponges[,<span class="fu">grep</span>(<span class="at">pattern=</span><span class="st">&quot;bs&quot;</span>, <span class="at">x=</span><span class="fu">names</span>(sponges),<span class="at">value =</span> <span class="cn">TRUE</span>)[<span class="dv">29</span><span class="sc">:</span><span class="dv">35</span>]])</span></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-69-3.png" width="672" /></p>
<p>Including pairs of such highly correlated variables in the models could lead to problems nad makes interpretation harder, and hence we need to decide which to remove a priori. This should be driven by ecological knowledge, which in our case, for SSR, is close to inexistent!</p>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="aula18.html#cb550-1" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">abs</span>(<span class="fu">round</span>(corWithSSR,<span class="dv">2</span>)))</span></code></pre></div>
<pre><code>##             bs22             bs23             bs24             bs29 
##             0.00             0.00             0.00             0.00 
##             bs35             bs_o       rugosity_o             bs25 
##             0.00             0.00             0.00             0.01 
##             bs26             bs27             bs28             bs33 
##             0.01             0.01             0.01             0.01 
##             bs34             bs36             bs21             bs30 
##             0.01             0.01             0.02             0.02 
##             bs31             bs32            tpi_o             bs20 
##             0.02             0.02             0.02             0.03 
##             var3             bs17             bs18             bs19 
##             0.03             0.04             0.04             0.04 
##          bathy_o        rugosity3       plan_curv5            bathy 
##             0.04             0.04             0.04             0.05 
##             bs10             bs11             bs12             bs13 
##             0.06             0.06             0.06             0.06 
##             bs16       bs_entro_o         bs_var_o             bs14 
##             0.06             0.06             0.06             0.07 
##             bs15       prof_cur_o            homo7       plan_cur_o 
##             0.07             0.07             0.07             0.08 
##            homo5             var7              mud             tpi7 
##             0.08             0.08             0.09             0.09 
##           entro5           entro7         bs_lmi_o         relief_o 
##             0.09             0.09             0.10             0.10 
##             var5          bs_lmi3          bs_lmi5          bs_lmi7 
##             0.10             0.10             0.10             0.10 
##        prof_cur3        rugosity5        bs_homo_o      bathy_lmi_o 
##             0.12             0.13             0.14             0.14 
##       bathy_lmi3       bathy_lmi5       bathy_lmi7       plan_curv7 
##             0.14             0.14             0.14             0.14 
##            homo3          slope_o        prof_cur5           entro3 
##             0.14             0.15             0.15             0.15 
##        rugosity7             tpi3        prof_cur7         relief_3 
##             0.16             0.16             0.17             0.18 
##           slope3             tpi5       plan_curv3           slope5 
##             0.19             0.20             0.22             0.23 
##           slope7         relief_5         relief_7      long.sample 
##             0.25             0.28             0.28             0.30 
##       lat.sample           gravel       dist.coast             sand 
##             0.30             0.30             0.31             0.35 
## species.richness 
##             1.00</code></pre>
<p>What does the response variable itself look like? That is the key question to answer, as it will determine the distribution we use to model it. We already saw that the variance is considerably larger than the mean, and therefore, the default go-to distribution for counts, a Poisson, will probably not be the best choice here.</p>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="aula18.html#cb552-1" tabindex="-1"></a><span class="fu">hist</span>(sponges<span class="sc">$</span>species.richness,<span class="at">xlab=</span><span class="st">&quot;Species Richness&quot;</span>,<span class="at">main=</span><span class="st">&quot;&quot;</span>,<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">40</span>,<span class="at">by=</span><span class="dv">1</span>))</span>
<span id="cb552-2"><a href="aula18.html#cb552-2" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">30</span>,<span class="dv">7</span>,<span class="fu">paste0</span>(<span class="st">&quot;Mean=&quot;</span>,<span class="fu">round</span>(<span class="fu">mean</span>(sponges<span class="sc">$</span>species.richness),<span class="dv">1</span>)))</span>
<span id="cb552-3"><a href="aula18.html#cb552-3" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">30</span>,<span class="dv">5</span>,<span class="fu">paste0</span>(<span class="st">&quot;Variance=&quot;</span>,<span class="fu">round</span>(<span class="fu">var</span>(sponges<span class="sc">$</span>species.richness),<span class="dv">1</span>)))</span></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-71-1.png" width="672" /></p>
<p>We can compare this with a poisson with the same mean, or a negative binomial with the same mean and variance. It should be obvious which provides a closer approximation, even before covariates get added to the mix.</p>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="aula18.html#cb553-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>),<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>))</span>
<span id="cb553-2"><a href="aula18.html#cb553-2" tabindex="-1"></a><span class="fu">hist</span>(sponges<span class="sc">$</span>species.richness,<span class="at">xlab=</span><span class="st">&quot;Species Richness&quot;</span>,<span class="at">main=</span><span class="st">&quot;&quot;</span>,<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">40</span>,<span class="at">by=</span><span class="dv">5</span>))</span>
<span id="cb553-3"><a href="aula18.html#cb553-3" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">30</span>,<span class="dv">20</span>,<span class="fu">paste0</span>(<span class="st">&quot;Mean=&quot;</span>,<span class="fu">round</span>(<span class="fu">mean</span>(sponges<span class="sc">$</span>species.richness),<span class="dv">1</span>)))</span>
<span id="cb553-4"><a href="aula18.html#cb553-4" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">30</span>,<span class="dv">10</span>,<span class="fu">paste0</span>(<span class="st">&quot;Variance=&quot;</span>,<span class="fu">round</span>(<span class="fu">var</span>(sponges<span class="sc">$</span>species.richness),<span class="dv">1</span>)))</span>
<span id="cb553-5"><a href="aula18.html#cb553-5" tabindex="-1"></a><span class="co"># Poisson</span></span>
<span id="cb553-6"><a href="aula18.html#cb553-6" tabindex="-1"></a>mean<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb553-7"><a href="aula18.html#cb553-7" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rpois</span>(<span class="dv">10000</span>,mean),<span class="at">main=</span><span class="st">&quot;&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Poisson, mean=10&quot;</span>,<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">40</span>,<span class="at">by=</span><span class="dv">5</span>))</span>
<span id="cb553-8"><a href="aula18.html#cb553-8" tabindex="-1"></a><span class="co">#Neg Bin</span></span>
<span id="cb553-9"><a href="aula18.html#cb553-9" tabindex="-1"></a>mean<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb553-10"><a href="aula18.html#cb553-10" tabindex="-1"></a>var<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb553-11"><a href="aula18.html#cb553-11" tabindex="-1"></a>dat<span class="ot">=</span><span class="fu">rnbinom</span>(<span class="dv">10000</span>,<span class="at">size=</span>mean<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(var<span class="sc">-</span>mean),<span class="at">mu=</span>mean)</span>
<span id="cb553-12"><a href="aula18.html#cb553-12" tabindex="-1"></a><span class="fu">hist</span>(dat[dat<span class="sc">&lt;</span><span class="dv">40</span>],<span class="at">main=</span><span class="st">&quot;&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Negative Binomial, mean=10, var=100&quot;</span>,<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">40</span>,<span class="at">by=</span><span class="dv">5</span>))</span></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-72-1.png" width="672" /></p>
<p>While there is never too much Exploratory Data Analysis (EDA), here we move on to do some modelling.</p>
</div>
<div id="modelling" class="section level3 hasAnchor" number="23.2.3">
<h3><span class="header-section-number">23.2.3</span> Modelling<a href="aula18.html#modelling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Just to begin, we take a peak at one of the variables that had a large positive correlation with SSR, in this case, <code>dist.coast</code>.</p>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="aula18.html#cb554-1" tabindex="-1"></a><span class="co">#testing a random variable!!</span></span>
<span id="cb554-2"><a href="aula18.html#cb554-2" tabindex="-1"></a><span class="fu">with</span>(sponges,<span class="fu">plot</span>(dist.coast,species.richness))</span>
<span id="cb554-3"><a href="aula18.html#cb554-3" tabindex="-1"></a>lm0<span class="ot">&lt;-</span><span class="fu">lm</span>(species.richness<span class="sc">~</span>dist.coast,<span class="at">data=</span>sponges)</span>
<span id="cb554-4"><a href="aula18.html#cb554-4" tabindex="-1"></a><span class="fu">abline</span>(lm0)</span></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-73-1.png" width="672" /></p>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="aula18.html#cb555-1" tabindex="-1"></a><span class="fu">summary</span>(lm0)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = species.richness ~ dist.coast, data = sponges)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -14.016  -6.986  -4.938   4.103  27.174 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept) 5.705e+00  2.026e+00   2.816  0.00621 **
## dist.coast  4.785e-05  1.673e-05   2.859  0.00549 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 10.06 on 75 degrees of freedom
## Multiple R-squared:  0.09831,    Adjusted R-squared:  0.08628 
## F-statistic: 8.177 on 1 and 75 DF,  p-value: 0.005492</code></pre>
<p>Apparently there is information to explain the species richness, and while the correlation is low, we can see that from a classical perspective, the coeficient associated with the variable would be considered significant at the usual significance levels, considering a simple linear model. However, we now that we are modelling counts,a nd hence, the Gaussian distribution is unlikely to be reasonable assumption. So, we move on to GLMs.</p>
<p>Lets begin by comparing just how different the model using a Poisson or a NB becomes, in terms of AIC</p>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="aula18.html#cb557-1" tabindex="-1"></a><span class="co">#testing a random variable!!</span></span>
<span id="cb557-2"><a href="aula18.html#cb557-2" tabindex="-1"></a>glmP1<span class="ot">=</span><span class="fu">glm</span>(species.richness<span class="sc">~</span>dist.coast,<span class="at">family=</span><span class="fu">poisson</span>(<span class="at">link=</span><span class="st">&quot;log&quot;</span>),<span class="at">data=</span>sponges)</span>
<span id="cb557-3"><a href="aula18.html#cb557-3" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb557-4"><a href="aula18.html#cb557-4" tabindex="-1"></a>glmNB1<span class="ot">=</span><span class="fu">glm.nb</span>(species.richness<span class="sc">~</span>dist.coast,<span class="at">link=</span>log,<span class="at">data=</span>sponges)</span>
<span id="cb557-5"><a href="aula18.html#cb557-5" tabindex="-1"></a><span class="fu">AIC</span>(glmP1,glmNB1)</span></code></pre></div>
<pre><code>##        df      AIC
## glmP1   2 975.7237
## glmNB1  3 522.3367</code></pre>
<p>There is absolutely no question about the fact that the NB is better here! Which does not necessarily mean it is the best model - remember AIC is a relative measure of fit.</p>
<p>We can compare with the quasi-poisson</p>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="aula18.html#cb559-1" tabindex="-1"></a>glmQP1<span class="ot">=</span><span class="fu">glm</span>(species.richness<span class="sc">~</span>dist.coast,<span class="at">family=</span>quasipoisson,<span class="at">data=</span>sponges)</span></code></pre></div>
<p>and now we compare the two</p>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="aula18.html#cb560-1" tabindex="-1"></a><span class="fu">summary</span>(glmP1)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = species.richness ~ dist.coast, family = poisson(link = &quot;log&quot;), 
##     data = sponges)
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) 1.894e+00  6.702e-02  28.258   &lt;2e-16 ***
## dist.coast  4.135e-06  4.703e-07   8.792   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 768.25  on 76  degrees of freedom
## Residual deviance: 694.62  on 75  degrees of freedom
## AIC: 975.72
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="aula18.html#cb562-1" tabindex="-1"></a><span class="fu">summary</span>(glmQP1)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = species.richness ~ dist.coast, family = quasipoisson, 
##     data = sponges)
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 1.894e+00  2.152e-01   8.800 3.57e-13 ***
## dist.coast  4.135e-06  1.510e-06   2.738  0.00772 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for quasipoisson family taken to be 10.31074)
## 
##     Null deviance: 768.25  on 76  degrees of freedom
## Residual deviance: 694.62  on 75  degrees of freedom
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>as expected, the only difference is the increase of the standard errors associated with the parameters. Note also that in the Quasi-Poisson we get an estimate of the over-dispersion parameter, and, since we do not have a likelihood, we do not get an AIC. The parameter standard errors are bigger in the quasi case, given that the overdispersion parameter is larger than 1.</p>
<p>Just for comparison, we look at the output from the negative binomial model</p>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="aula18.html#cb564-1" tabindex="-1"></a><span class="fu">summary</span>(glmNB1)</span></code></pre></div>
<pre><code>## 
## Call:
## glm.nb(formula = species.richness ~ dist.coast, data = sponges, 
##     link = log, init.theta = 1.084393054)
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) 1.871e+00  2.052e-01   9.117  &lt; 2e-16 ***
## dist.coast  4.345e-06  1.669e-06   2.604  0.00923 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Negative Binomial(1.0844) family taken to be 1)
## 
##     Null deviance: 89.908  on 76  degrees of freedom
## Residual deviance: 83.032  on 75  degrees of freedom
## AIC: 522.34
## 
## Number of Fisher Scoring iterations: 1
## 
## 
##               Theta:  1.084 
##           Std. Err.:  0.184 
## 
##  2 x log-likelihood:  -516.337</code></pre>
<p>Note that in practice all models would lead us to find the <code>dist.coast</code> to be considered relevant to model species richness.</p>
<p>A bit on model selection, using <code>anova</code>, a Chi-squared test,</p>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="aula18.html#cb566-1" tabindex="-1"></a>glmQP2<span class="ot">=</span><span class="fu">glm</span>(species.richness<span class="sc">~</span><span class="dv">1</span>,<span class="at">family=</span>quasipoisson,<span class="at">data=</span>sponges)</span>
<span id="cb566-2"><a href="aula18.html#cb566-2" tabindex="-1"></a><span class="fu">anova</span>(glmQP1,glmQP2, <span class="at">test =</span> <span class="st">&quot;Chi&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: species.richness ~ dist.coast
## Model 2: species.richness ~ 1
##   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)   
## 1        75     694.62                        
## 2        76     768.25 -1  -73.628 0.007534 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>or using <code>drop1</code>, with an F-test</p>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="aula18.html#cb568-1" tabindex="-1"></a><span class="fu">drop1</span>(glmQP1,<span class="at">test=</span><span class="st">&quot;F&quot;</span>)</span></code></pre></div>
<pre><code>## Single term deletions
## 
## Model:
## species.richness ~ dist.coast
##            Df Deviance F value   Pr(&gt;F)   
## &lt;none&gt;          694.62                    
## dist.coast  1   768.25  7.9498 0.006148 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>again, both tell us that <code>dist.coast</code> is a relevant covariate.</p>
<p>We could look at the residuals for both models. First the Poisson</p>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="aula18.html#cb570-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>))</span>
<span id="cb570-2"><a href="aula18.html#cb570-2" tabindex="-1"></a><span class="fu">plot</span>(glmP1)</span></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-80-1.png" width="672" /></p>
<p>and then the negative binomial</p>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb571-1"><a href="aula18.html#cb571-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>))</span>
<span id="cb571-2"><a href="aula18.html#cb571-2" tabindex="-1"></a><span class="fu">plot</span>(glmNB1)</span></code></pre></div>
<p><img src="ECOMODbook_files/figure-html/unnamed-chunk-81-1.png" width="672" /></p>
<p>It is quite hard to choose between these based on the residuals, but remember that the AIC does not leave any room for doubts, the Negative Binomial is the most likely road to take here. So now it is time to investigate what might be the best model.</p>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="aula18.html#cb572-1" tabindex="-1"></a><span class="fu">AIC</span>(lm0,glmP1,glmNB1)</span></code></pre></div>
<pre><code>##        df      AIC
## lm0     3 578.0226
## glmP1   2 975.7237
## glmNB1  3 522.3367</code></pre>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="aula18.html#cb574-1" tabindex="-1"></a>glmNB.<span class="fl">0.15</span><span class="ot">=</span><span class="fu">glm.nb</span>(species.richness<span class="sc">~</span>slope_o<span class="sc">+</span>prof_cur5<span class="sc">+</span>entro3 </span>
<span id="cb574-2"><a href="aula18.html#cb574-2" tabindex="-1"></a><span class="sc">+</span>rugosity7<span class="sc">+</span>tpi3<span class="sc">+</span>prof_cur7<span class="sc">+</span>relief_3 </span>
<span id="cb574-3"><a href="aula18.html#cb574-3" tabindex="-1"></a><span class="sc">+</span>slope3<span class="sc">+</span>tpi5<span class="sc">+</span>plan_curv3<span class="sc">+</span>slope5 </span>
<span id="cb574-4"><a href="aula18.html#cb574-4" tabindex="-1"></a><span class="sc">+</span>slope7<span class="sc">+</span>relief_5<span class="sc">+</span>relief_7<span class="sc">+</span>long.sample </span>
<span id="cb574-5"><a href="aula18.html#cb574-5" tabindex="-1"></a><span class="sc">+</span>lat.sample<span class="sc">+</span>gravel<span class="sc">+</span>dist.coast<span class="sc">+</span>sand,<span class="at">link=</span>log,<span class="at">data=</span>sponges)</span></code></pre></div>
</div>
</div>
<div id="extra-glm-stuff" class="section level2 hasAnchor" number="23.3">
<h2><span class="header-section-number">23.3</span> Extra GLM stuff<a href="aula18.html#extra-glm-stuff" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Zero inflated models and other similar stuff!</p>
<ul>
<li><span class="citation">Martin et al. (<a href="#ref-Martin2005">2005</a>)</span></li>
</ul>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Martin2005" class="csl-entry">
Martin, Tara G., Brendan A. Wintle, Jonathan R. Rhodes, Petra M. Kuhnert, Scott A. Field, Samantha J. Low-Choy, Andrew J. Tyre, and Hugh P. Possingham. 2005. <span>“Zero Tolerance Ecology: Improving Ecological Inference by Modelling the Source of Zero Observations.”</span> <em>Ecology Letters</em> 8: 1235–46.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="aula17.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="aula19.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ECOMODbook.pdf", "ECOMODbook.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
