[
["aula14.html", "Chapter 15 Class 14: 10 10 2020 GLMs 15.1 What are GLMs 15.2 An example analysis", " Chapter 15 Class 14: 10 10 2020 GLMs 15.1 What are GLMs Here we talk about link functions lp&lt;-function(a,b,x){ res&lt;-a+b*x return(res) } ilogi&lt;-function(lp){ res&lt;-1/(1+exp(lp)) return(res) } Illustrate how a link function can be used to ensure that a prediction only returns admissible values a&lt;-0.04 b&lt;-0.08 par(mfrow=c(2,2)) xs&lt;-seq(-30,20,by=0.01) plot(xs,ilogi(lp(a,b,xs)),ylim=c(0,1)) abline(h=0:1,lty=1) xs&lt;-seq(-30,20,by=0.01) plot(xs,ilogi(lp(0.9,12,xs)),ylim=c(0,1)) abline(h=0:1,lty=1) xs&lt;-seq(-3,2,by=0.01) plot(xs,ilogi(lp(0.9,12,xs)),ylim=c(0,1)) abline(h=0:1,lty=1) xs&lt;-seq(-1,1,by=0.01) plot(xs,ilogi(lp(0.9,12,xs)),ylim=c(0,1)) abline(h=0:1,lty=1) 15.2 An example analysis Here we talk about GLMs set.seed(121) #define sample size n&lt;-100 #get a predictor variable low&lt;-30 high&lt;-90 xs1&lt;-runif(n,low,high) #get a second potentially predictor xs2&lt;-rgamma(n,10,10) #define linear predictor lp1&lt;-0.01+0.05*xs1 #get the mean value Eys1&lt;-exp(lp1) #get actual data ys1&lt;-rpois(n,Eys1) We can plot the data par(mfrow=c(1,2)) plot(ys1~xs1) plot(ys1~xs2) Now, we can fit some models to data lm1A&lt;-lm(ys1~xs1) lm1B&lt;-glm(ys1~xs1) glmPoi&lt;-glm(ys1~xs1,family=poisson(link=&quot;log&quot;)) glmGau&lt;-glm(ys1~xs1,family=gaussian(link=&quot;log&quot;)) and we can show these overlayed on data - wtf is going onâ€¦? plot(ys1~xs1) xs&lt;-seq(low-5,high+5,by=0.5) novosdados&lt;-data.frame(xs1=xs) predslm1A&lt;-predict(lm1A,newdata=novosdados) predslm1B&lt;-predict(lm1B,newdata=novosdados) predsglmPoi&lt;-predict(glmPoi,newdata=novosdados,type=&quot;response&quot;) predsglmGau&lt;-predict(glmGau,newdata=novosdados,type=&quot;response&quot;) lines(xs,predslm1A,col=2,lty=2,lwd=3) lines(xs,predslm1B,col=3,lty=3,lwd=3) lines(xs,predsglmPoi,col=4,lwd=2) lines(xs,predsglmGau,col=5,lty=2,lwd=2) legend(&quot;topleft&quot;,legend=c(&quot;Linear model via lm&quot;,&quot;linear model via glm&quot;,&quot;Poisson GLM&quot;,&quot;Gaussian GLM&quot;),lwd==c(3,3,2,2),col=c(2,3,4,5),lty=c(2,3,1,2),inset=0.05) Just for fun AIC(lm1A,lm1B,glmGau,glmPoi) ## df AIC ## lm1A 3 718.4863 ## lm1B 3 718.4863 ## glmGau 3 586.4525 ## glmPoi 2 564.2675 Diagnostics par(mfrow=c(2,2),mar=c(4,4,0.5,0.5)) plot(glmGau) par(mfrow=c(2,2),mar=c(4,4,0.5,0.5)) plot(glmPoi) "]
]
